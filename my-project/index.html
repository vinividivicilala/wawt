
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Life Is What It Is Learn</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600&display=swap');

   body {
  margin: 0;
  background-color: #000;
  font-family: 'Plus Jakarta Sans', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh; /* ganti dari height */
  padding-top: 40px;
}


    .header {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      background-color: #000;
      color: white;
      margin-bottom: 40px;
      margin-right: 850px;
    }

    .logo {
      width: 70px;
      height: 70px;
      margin-right: 12px;
      border-radius: 8px;
      object-fit: cover;
    }

    .title {
      font-size: 29px;
      font-weight: 600;
      white-space: nowrap;
    }

    .line-box {
      width: 1630px;
      height: auto;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 30px;
      background: transparent;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 50px;
      padding: 40px;
	  margin-left: 150px;
    }

    /* Halaman 1 */
    .card {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 15px;
      cursor: pointer;
    }

    .card img {
      width: 400px;
      height: auto;
	   border-radius: 30px;
    }

    .card-title {
      margin-top: 20px;
      color: white;
      font-size: 30px;
      font-weight: 600;
      padding: 10px 30px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 30px;
      display: inline-block;
      margin-right: 300px;
    }

    .bottom-line {
      width: 100vw;
      border-top: 2px solid rgba(255, 255, 255, 0.2);
      margin-top: 90px;
      position: relative;
      left: 50%;
      right: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
    }

    .bottom-text {
      color: white;
      margin-top: 30px;
      font-size: 18px;
      text-align: left;
      line-height: 1.6;
      margin-right: 1000px;
      margin-bottom: 40px;
	  	  margin-left: 150px;

    }

    .bottom-text a {
      color: #fff;
      text-decoration: none;
    }

    .bottom-text a:hover {
      text-decoration: underline;
    }

    #page2 {
      display: none;
    }

    .page2-content {
      display: flex;
      gap: 50px;
      align-items: flex-start;
    }

    .page2-left {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    .page2-left img {
      width: 400px;
      height: auto;
	   border-radius: 30px;
    }

    .bab-cards {
      display: flex;
      flex-direction: column; /* ke bawah */
      gap: 20px;
    }

    /* Kalau mau bab-babnya memanjang ke samping dalam satu baris, ubah ke flex-direction: row; */

    .bab-card {
      display: flex;
      flex-direction: row;
      gap: 20px;
      align-items: flex-start;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      color: white;
    }

    .bab-title-box {
      font-size: 20px;
      font-weight: 600;
      padding: 8px 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      flex-shrink: 0;
    }

    .bab-desc-box {
      font-size: 16px;
      line-height: 1.5;
    }

    .page2-right {
      color: white;
      max-width: 500px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .title-box {
      font-size: 36px;
      padding: 10px 30px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      display: inline-block;
	   color: #fff;
    }

    .desc-box {
      font-size: 18px;
      line-height: 1.6;
      padding: 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
    }
	
	.nav-link {
  position: fixed;  /* atau absolute sesuai kebutuhan */
  bottom: 20px;     /* jarak dari bawah halaman */
  left: 20px;       /* jarak dari kiri halaman */
}

.nav-link a {
  display: inline-flex;   /* agar icon dan teks sejajar */
  align-items: center;    /* vertikal rata tengah */
  color: white;           /* warna teks */
  text-decoration: none;  /* hilangkan underline */
  font-size: 16px;        /* ukuran teks */
  font-weight: 500;       /* ketebalan teks */
}

.nav-link a:hover {
  opacity: 0.8;  /* efek hover */
}

.nav-link svg {
  margin-right: 8px;   /* jarak antara icon dan teks */
}

#page2, #page3 {
      display: none;
    }
	
	
	#page4, #page5 {
      display: none;
    }



.bab-card svg {
  width: 48px;
  height: 48px;
  flex-shrink: 0;
}



@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}


/* Animasi untuk feedback item */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .feedback-item {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 15px;
    animation: fadeInUp 0.5s ease-out;
    transition: all 0.3s;
  }
  
  .feedback-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  
  .feedback-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  
  .feedback-user {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .feedback-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: #4ea1ff;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
  }
  
  .feedback-time {
    color: #ccc;
    font-size: 14px;
  }
  
  .feedback-title {
    color: white;
    font-weight: bold;
    margin-bottom: 8px;
    font-size: 18px;
  }
  
  .feedback-category {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 12px;
    margin-bottom: 10px;
  }
  
  .category-design {
    background: rgba(78, 161, 255, 0.2);
    color: #4ea1ff;
  }
  
  .category-feature {
    background: rgba(76, 175, 80, 0.2);
    color: #4CAF50;
  }
  
  .category-content {
    background: rgba(255, 193, 7, 0.2);
    color: #FFC107;
  }
  
  .category-bug {
    background: rgba(244, 67, 54, 0.2);
    color: #F44336;
  }
  
  .category-other {
    background: rgba(156, 39, 176, 0.2);
    color: #9C27B0;
  }
  
  .feedback-content {
    color: #ddd;
    line-height: 1.6;
  }
  
  /* Animasi tombol submit */
  #submitFeedback {
    position: relative;
    overflow: hidden;
  }
  
  #submitFeedback:after {
    content: "";
    position: absolute;
    top: -50%;
    left: -60%;
    width: 200%;
    height: 200%;
    background: rgba(255,255,255,0.1);
    transform: rotate(30deg);
    transition: all 0.3s;
  }
  
  #submitFeedback:hover:after {
    left: 100%;
  }
  
  /* Animasi loading */
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  .loading-spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
    margin-left: 8px;
  }
  
  
  .feedback-time {
  color: #ccc;
  font-size: 14px;
  white-space: nowrap;
  text-align: right;
  min-width: 150px;
}

.feedback-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 10px;
  gap: 15px;
}

.feedback-user {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-grow: 1;
}

.feedback-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background-color: #4ea1ff;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  flex-shrink: 0;
}



/* Tambahkan di bagian style */
.discussion-item {
  margin-bottom: 20px;
  padding: 20px;
  transition: all 0.3s;
  cursor: pointer;
  position: relative;
}

.discussion-item:not(:last-child)::after {
  content: "";
  position: absolute;
  bottom: -10px;
  left: 20px;
  right: 20px;
  height: 1px;
  background: rgba(255,255,255,0.1);
}

.hot-discussion {
  border-left: 3px solid #F44336;
  padding-left: 17px;
}

.latest-discussion {
  border-left: 3px solid #4ea1ff;
  padding-left: 17px;
}


.forum-header {
  display: flex;
  justify-content: space-between;
  width: 100%;
  max-width: 1200px; /* atau sesuai lebar kontainer kamu */
  margin: 0 auto;
  padding: 10px 20px;
  color: rgba(255, 255, 255, 0.7);
  font-weight: 500;
  font-size: 16px;
}

.forum-column {
  flex: 1;
  text-align: left;
}

/* Atur agar kolom kanan rata kanan */
.forum-column:nth-child(2),
.forum-column:nth-child(3),
.forum-column:nth-child(4) {
  text-align: right;
}

.forum-header-line {
  width: 100%;
  max-width: 1200px; /* atau sesuai lebar kontainer */
  margin: 0 auto;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  margin-bottom: 20px; /* jarak ke bawah */
}



#newDiscussionModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

/* Style untuk konten modal */
#newDiscussionModal > div {
    background: #1a1a1a;
    border-radius: 15px;
    padding: 30px;
    width: 600px;
    max-width: 90%;
    max-height: 90vh;
    overflow-y: auto;
}




  .admin-badge {
    display: inline-block;
    background: linear-gradient(135deg, #ff6b6b, #ff3838);
    color: white;
    font-size: 12px;
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 10px;
    margin-left: 8px;
    vertical-align: middle;
  }
  
  .pinned-announcement {
    position: relative;
    background: rgba(255, 184, 78, 0.1);
    border: 1px solid rgba(255, 184, 78, 0.3);
    border-radius: 12px;
    padding: 20px;
  }
  
  .pinned-announcement::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background: linear-gradient(to bottom, #ffb84e, #ff8800);
    border-radius: 12px 0 0 12px;
  }
  
  .announcement-link {
    color: #4ea1ff;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 5px;
    margin-top: 10px;
  }
  
  .announcement-link:hover {
    text-decoration: underline;
  }



.announcement-item {
  position: relative;
}

.announcement-item::before {
  content: "PENGUMUMAN RESMI";
  position: absolute;
  top: 10px;
  right: 10px;
  background: #ff6b6b;
  color: white;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: bold;
}




.announcement-item {
    position: relative;
    border-left: 4px solid #ff6b6b !important;
    background: rgba(255, 107, 107, 0.05) !important;
}

.announcement-item .feedback-title {
    color: #ff6b6b !important;
    font-size: 18px !important;
}

.announcement-item .feedback-avatar {
    background: #ff6b6b !important;
}

.pinned-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #ff6b6b;
    color: white;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
}


.feedback-item {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 30px; /* dari semula 10px/8px */
  padding: 20px;
  margin-bottom: 20px;
  width: 100%;
  max-width: 100%; /* agar penuh */
  box-sizing: border-box;
}



.feedback-category {
  padding: 5px 10px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: bold;
  display: inline-block;
  margin-top: 10px;
}

.category-design { background: #4ea1ff21; color: #4ea1ff; }
.category-feature { background: #34d39921; color: #34d399; }
.category-bug { background: #f8717121; color: #f87171; }
.category-content { background: #facc1521; color: #facc15; }
.category-announcement { background: #ff6b6b21; color: #ff6b6b; }
.category-other { background: #9ca3af21; color: #9ca3af; }
















.pin-icon {
    width: 16px;
    height: 16px;
    margin-right: 6px;
    fill: #ff6b6b;
    vertical-align: middle;
  }
  .pinned-item {
    position: relative;
    border-left: 4px solid #ff6b6b;
    background: rgba(255, 107, 107, 0.08);
  }
  .pinned-item::before {
    content: '';
    position: absolute;
    top: 10px;
    right: 10px;
    width: 24px;
    height: 24px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ff6b6b'%3E%3Cpath d='M16 12V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v8l-2 2v1h15v-1l-2-2z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-size: contain;
    opacity: 0.7;
  }


/* Tambahkan di CSS Anda */
.feedback-item {
  transition: all 0.2s ease;
  cursor: pointer;
}

.feedback-item:hover {
  background: rgba(255, 255, 255, 0.08) !important;
}

.announcement-item {
  border-left: 4px solid #ff6b6b;
  background: rgba(255, 107, 107, 0.05);
}

.feedback-avatar {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(78, 161, 255, 0.2);
  color: white;
  font-weight: bold;
  margin-right: 15px;
}



/* Style untuk item pengumuman yang bisa diklik */
.pinned-item {
    cursor: pointer;
    transition: all 0.2s ease;
}

.pinned-item:hover {
    background: rgba(255, 255, 255, 0.08);
}

/* Style untuk tombol di dalam item yang tidak trigger klik */
.pinned-item button {
    cursor: default;
    pointer-events: auto;
}







/* Style untuk history changes */
.edit-highlight {
  background-color: rgba(255, 255, 0, 0.1);
  border-left: 3px solid #ff6b6b;
  padding-left: 10px;
  transition: all 0.3s ease;
}

.history-item {
  border-left: 3px solid #4ea1ff;
  margin-bottom: 10px;
  padding-left: 10px;
}

#editHistoryList::-webkit-scrollbar {
  width: 6px;
}

#editHistoryList::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
}

#editHistoryList::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.1);
  border-radius: 3px;
}

/* Style untuk modal perbandingan */
#editComparisonModal h3 {
  margin-top: 0;
}

#editComparisonModal div[style*="padding: 10px"] {
  margin-bottom: 15px;
}

#beforeEditContent, #afterEditContent {
  max-height: 60vh;
  overflow-y: auto;
  padding-right: 10px;
}

#beforeEditContent::-webkit-scrollbar, 
#afterEditContent::-webkit-scrollbar {
  width: 6px;
}

#beforeEditContent::-webkit-scrollbar-track,
#afterEditContent::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
}

#beforeEditContent::-webkit-scrollbar-thumb,
#afterEditContent::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.1);
  border-radius: 3px;
}

/* Highlight untuk perubahan */
.highlight-added {
  background-color: rgba(78,161,255,0.3);
  border-left: 2px solid #4ea1ff;
  padding-left: 4px;
}

.highlight-removed {
  background-color: rgba(255,107,107,0.3);
  border-left: 2px solid #ff6b6b;
  padding-left: 4px;
  text-decoration: line-through;
}

/* Style untuk modal perbandingan yang baru */
#editComparisonModal {
  backdrop-filter: blur(5px);
}

#editComparisonModal > div {
  animation: modalFadeIn 0.3s ease;
}

@keyframes modalFadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

#beforeEditContent, #afterEditContent {
  max-height: 50vh;
  overflow-y: auto;
  padding-right: 10px;
}







.text-diff-added {
  border-left: 3px solid #4ea1ff;
  padding-left: 5px;
  margin-left: 2px;
}

.text-diff-removed {
  border-left: 3px solid #ff6b6b;
  padding-left: 5px;
  margin-left: 2px;
  text-decoration: line-through;
}

/* Untuk kontainer utama */
.diff-container {
  padding: 8px;
  background: rgba(255,255,255,0.05);
  border-radius: 4px;
  white-space: pre-wrap;
  line-height: 1.6;
}







/* Efek hover untuk header */
#announcementHeader:hover {
  background: rgba(255,255,255,0.03);
  border-radius: 8px;
  padding: 5px 10px;
  margin: -5px -10px;
  transition: all 0.2s ease;
}

  .edit-comparison-user {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
  }

  .edit-comparison-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
  }

  .edit-comparison-date {
    color: #aaa;
    font-size: 12px;
    margin-top: 5px;
  }






/* Style untuk highlight perubahan */
.highlight-added {
  background-color: rgba(78,161,255,0.3);
  border-left: 2px solid #4ea1ff;
  padding: 0 2px;
  border-radius: 3px;
  margin: 0 1px;
  position: relative;
}

.highlight-added::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 0;
  background: #2a2a2a;
  color: #ddd;
  padding: 2px 5px;
  border-radius: 3px;
  font-size: 12px;
  white-space: nowrap;
  display: none;
}

.highlight-added:hover::after {
  display: block;
}

.highlight-removed {
  background-color: rgba(255,107,107,0.3);
  border-left: 2px dashed #ff6b6b;
  padding: 0 2px;
  border-radius: 3px;
  margin: 0 1px;
  text-decoration: line-through;
  position: relative;
}

.highlight-removed::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 0;
  background: #2a2a2a;
  color: #ddd;
  padding: 2px 5px;
  border-radius: 3px;
  font-size: 12px;
  white-space: nowrap;
  display: none;
}

.highlight-removed:hover::after {
  display: block;
}

/* Style untuk emoticon */
.emoticon-highlight {
  background: rgba(255,255,255,0.1);
  padding: 2px;
  border-radius: 4px;
  position: relative;
}

.emoticon-highlight::after {
  content: "Emoticon";
  position: absolute;
  bottom: 100%;
  left: 0;
  background: #2a2a2a;
  color: #ddd;
  padding: 2px 5px;
  border-radius: 3px;
  font-size: 12px;
  white-space: nowrap;
  display: none;
}

.emoticon-highlight:hover::after {
  display: block;
}






/* Gaya dasar untuk perbandingan */
.diff-container {
  padding: 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 5px;
  line-height: 1.6;
  white-space: pre-wrap;
}

/* Teks yang ditambahkan */
.diff-added {
  background-color: rgba(78, 161, 255, 0.3);
  border-left: 2px solid #4ea1ff;
  padding: 0 2px;
  margin: 0 1px;
  border-radius: 2px;
}

/* Teks yang dihapus */
.diff-removed {
  background-color: rgba(255, 107, 107, 0.3);
  border-left: 2px dashed #ff6b6b;
  padding: 0 2px;
  margin: 0 1px;
  border-radius: 2px;
  text-decoration: line-through;
}

/* Khusus emoticon */
.diff-emoticon {
  padding: 2px 4px !important;
  border-radius: 4px !important;
  background: rgba(255, 215, 0, 0.2) !important;
  border: 1px dotted rgba(255, 215, 0, 0.5) !important;
}

/* Khusus link */
.diff-link {
  color: #4ea1ff;
  text-decoration: underline;
}

.diff-removed.diff-link {
  color: #ff6b6b;
}

/* Container tanpa perubahan */
.no-changes {
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 5px;
}

/* Error state */
.diff-error {
  color: #ff6b6b;
  padding: 10px;
  border: 1px dashed #ff6b6b;
}



/* Style untuk modal perbandingan */
#editComparisonModal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.9);
  z-index: 1000;
  display: none;
  padding: 20px;
  overflow-y: auto;
}

#editComparisonModal > div {
  background: #2a2a2a;
  border-radius: 10px;
  max-width: 1000px;
  margin: 0 auto;
  padding: 25px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}

.comparison-section {
  margin-bottom: 20px;
}

.comparison-section h4 {
  color: #aaa;
  margin-top: 0;
  margin-bottom: 8px;
}

.original-text {
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 5px;
  white-space: pre-wrap;
}

.comparison-guide {
  margin-top: 30px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
}

.comparison-guide h4 {
  margin-top: 0;
  color: #ddd;
}

.color-sample {
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 3px;
  margin-right: 8px;
  vertical-align: middle;
}

.diff-added-sample {
  background-color: rgba(78, 161, 255, 0.3);
  border: 1px solid #4ea1ff;
}

.diff-removed-sample {
  background-color: rgba(255, 107, 107, 0.3);
  border: 1px dashed #ff6b6b;
}

.diff-emoticon-sample {
  background: rgba(255, 215, 0, 0.2);
  border: 1px dotted rgba(255, 215, 0, 0.5);
}

.diff-link-sample {
  background: rgba(78, 161, 255, 0.2);
  border: 1px solid #4ea1ff;
}






/* Layout Container */
.page10-container {
  display: flex;
  padding: 20px;
  margin: 0 100px;
  gap: 30px;
}

.page10-sidebar {
  flex: 0 0 250px;
  position: sticky;
  top: 20px;
  align-self: flex-start;
  height: calc(100vh - 100px);
  overflow-y: auto;
}

.page10-main-content {
  flex: 1;
  max-width: 800px;
}

/* Linebox Style */
.linebox {
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 29px;
  padding: 25px;
  background: rgba(0, 0, 0, 0.2);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  margin-bottom: 30px;
}

/* Garis-garis putih */
.title-line-white {
  height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
  width: 60%;
  margin: 0 auto;
  margin-top: -10px;
}

.title-line-small-white {
  height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
  width: 100%;
  margin-bottom: 25px;
}

.bottom-line-white {
  height: 1px;
  background: rgba(255, 255, 255, 0.2);
  width: 80%;
  margin: 30px auto;
}

.timeline-track-white {
  position: absolute;
  left: 25px;
  top: 0;
  bottom: 0;
  width: 2px;
  background: rgba(255, 255, 255, 0.3);
  z-index: 1;
}

.scroll-indicator-white {
  position: absolute;
  left: 25px;
  top: 0;
  width: 2px;
  background: white;
  z-index: 2;
  transition: height 0.3s ease-out;
}

.timeline-line-white {
  height: 2px;
  background: rgba(255, 255, 255, 0.3);
  width: 100%;
  margin-top: 20px;
}

.sidebar-line-white {
  height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
  margin-bottom: 15px;
}

/* Sidebar Style */
.sidebar-content {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 12px;
  padding: 20px;
}

.sidebar-title {
  color: white;
  font-size: 18px;
  margin-bottom: 15px;
  font-weight: 500;
}

.content-nav {
  list-style: none;
  padding: 0;
  margin: 0;
}

.content-link {
  display: block;
  padding: 12px 15px;
  margin-bottom: 8px;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  border-radius: 8px;
  transition: all 0.3s;
  position: relative;
  font-size: 15px;
}

.content-link::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: white;
  opacity: 0;
  transition: opacity 0.3s;
  border-radius: 3px;
}

.content-link:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.content-link.active {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  font-weight: 500;
}

.content-link.active::before {
  opacity: 1;
}

/* Timeline Style */
.history-timeline {
  position: relative;
  padding-left: 50px;
}

.timeline-item {
  position: relative;
  margin-bottom: 30px;
  padding: 25px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s;
  z-index: 3;
}

.timeline-item:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateX(5px);
}

.timeline-number-white {
  position: absolute;
  left: -40px;
  top: 25px;
  width: 30px;
  height: 30px;
  background: white;
  color: #333;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 16px;
  z-index: 4;
}

.timeline-content h3 {
  color: white;
  margin-bottom: 15px;
  font-size: 18px;
  font-weight: 500;
}

.timeline-content p {
  line-height: 1.7;
  color: rgba(255,255,255,0.8);
  font-size: 15px;
  margin-bottom: 10px;
}

.title-box-white {
  color: white;
  font-size: 22px;
  margin-bottom: 15px;
}

/* Animasi */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.timeline-item {
  animation: fadeInUp 0.6s ease-out forwards;
  opacity: 0;
}

.timeline-item:nth-child(1) { animation-delay: 0.1s; }
.timeline-item:nth-child(2) { animation-delay: 0.3s; }
.timeline-item:nth-child(3) { animation-delay: 0.5s; }
.timeline-item:nth-child(4) { animation-delay: 0.7s; }
.timeline-item:nth-child(5) { animation-delay: 0.9s; }
.timeline-item:nth-child(6) { animation-delay: 1.1s; }
.timeline-item:nth-child(7) { animation-delay: 1.3s; }
.timeline-item:nth-child(8) { animation-delay: 1.5s; }
.timeline-item:nth-child(9) { animation-delay: 1.7s; }





















.bab-card {
  cursor: pointer;
  transition: all 0.3s;
}

.bab-card:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateY(-5px);
}

.sejarah-card {
  position: relative;
}

.sejarah-card::after {
  content: 'Klik untuk detail';
  position: absolute;
  bottom: 10px;
  right: 10px;
  font-size: 12px;
  color: rgba(255,255,255,0.6);
}



/* Tambahkan di bagian CSS */
.video-container {
  padding: 25px;
}

.video-wrapper {
  position: relative;
  padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
  height: 0;
  overflow: hidden;
  margin: 20px 0;
}

.video-wrapper iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.video-description {
  padding: 0 10px;
}





/* Footnote Styles */
.footnotes-container {
  margin-top: 50px;
  padding: 25px;
}

.footnotes-list {
  padding: 10px;
}

.footnote-item {
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  line-height: 1.6;
}

.footnote-number {
  color: white;
  font-weight: bold;
  margin-right: 8px;
}

.footnote-text {
  color: rgba(255, 255, 255, 0.8);
  font-size: 14px;
}

a.footnote-link {
  color: #4dabf7;
  text-decoration: none;
  transition: color 0.3s;
}

a.footnote-link:hover {
  color: #a5d8ff;
  text-decoration: underline;
}



/* Emoji Reaction Styles */
.emoji-reactions {
  display: flex;
  justify-content: space-around;
  padding: 20px 0;
}

.emoji-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: all 0.3s;
  padding: 10px;
  border-radius: 10px;
}

.emoji-option:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.1);
}

.emoji {
  font-size: 32px;
  margin-bottom: 5px;
}

.emoji-count {
  color: white;
  font-size: 14px;
}

.emoji-option.selected {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.1);
}

.emoji-option.selected .emoji {
  filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
}









 /* CSS untuk komentar */
  .comments-container {
    margin: 30px auto;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
  }
  
  .comment-form {
    margin-bottom: 20px;
  }
  
  .comment-form textarea {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #444;
    background: rgba(255, 255, 255, 0.9);
    color: #333;
    font-size: 16px;
    resize: vertical;
    margin-bottom: 10px;
  }
  
  .comment-submit-btn {
    background: #009688;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s;
  }
  
  .comment-submit-btn:hover {
    background: #00796b;
  }
  
  .comment-filters {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
  }
  
  .filter-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
  }
  
  .filter-btn.active {
    background: #009688;
  }
  
  .comment-count-info {
    color: rgba(255, 255, 255, 0.8);
    font-size: 14px;
    margin-bottom: 15px;
  }
  
  .comments-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  
  .comment-item {
    background: rgba(255, 255, 255, 0.1);
    padding: 15px;
    border-radius: 10px;
    position: relative;
  }
  
  .comment-header {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }
  
  .comment-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #009688;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    color: white;
    font-weight: bold;
  }
  
  .comment-user {
    font-weight: bold;
    color: white;
  }
  
  .comment-time {
    color: rgba(255, 255, 255, 0.6);
    font-size: 12px;
    margin-left: 10px;
  }
  
  .comment-content {
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 10px;
    line-height: 1.5;
  }
  
  .comment-actions {
    display: flex;
    gap: 15px;
  }
  
  .comment-action {
    color: rgba(255, 255, 255, 0.7);
    font-size: 13px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .comment-action:hover {
    color: #009688;
  }
  
  .replies-container {
    margin-top: 15px;
    padding-left: 20px;
    border-left: 2px solid rgba(255, 255, 255, 0.1);
  }
  
  .reply-form {
    margin-top: 10px;
    display: none;
  }
  
  .reply-form.active {
    display: block;
  }
  
  .reply-form textarea {
    width: 100%;
    padding: 8px;
    border-radius: 8px;
    border: 1px solid #444;
    background: rgba(255, 255, 255, 0.9);
    color: #333;
    font-size: 14px;
    resize: vertical;
    margin-bottom: 5px;
  }
  
  .reply-submit-btn {
    background: rgba(0, 150, 136, 0.7);
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
  }
  
  .reply-submit-btn:hover {
    background: rgba(0, 150, 136, 1);
  }
  
  .new-badge {
    background: #ff5722;
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 10px;
    margin-left: 5px;
  }




/* Admin Button Styles */
#toggleAdminBtn {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 60px;
  height: 60px;
  padding: 15px;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
}

#toggleAdminBtn:hover {
  background: #45a049;
  transform: scale(1.1);
  box-shadow: 0 6px 12px rgba(0,0,0,0.3);
}

/* Admin Form Container */
#adminFormContainer {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 800px;
  max-width: 90vw;
  height: 80vh;
  max-height: 90vh;
  background: rgba(0,0,0,0.95);
  border-radius: 15px;
  padding: 25px;
  z-index: 1001;
  box-shadow: 0 0 30px rgba(0,0,0,0.7);
  border: 1px solid #444;
  display: flex;
  flex-direction: column;
}

/* Form Header */
#adminFormContainer h2 {
  color: white;
  text-align: center;
  margin-bottom: 20px;
  font-size: 28px;
  border-bottom: 1px solid #444;
  padding-bottom: 15px;
}

/* Form Content Area */
#adminControls {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Tabs Navigation */
.admin-tabs {
  display: flex;
  margin-bottom: 20px;
  border-bottom: 1px solid #444;
}

.admin-tab {
  padding: 12px 20px;
  background: transparent;
  color: #aaa;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.3s ease;
}

.admin-tab.active {
  color: white;
  border-bottom: 3px solid #4CAF50;
}

/* Tab Content */
.admin-tab-content {
  flex: 1;
  display: none;
  overflow: hidden;
  flex-direction: column;
}

.admin-tab-content.active {
  display: flex;
}

/* Section Selection */
#contentSection {
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  background: #333;
  color: white;
  border: 1px solid #555;
  margin-bottom: 20px;
  font-size: 16px;
}

/* Content Editor */
#adminContentEditor {
  flex: 1;
  width: 100%;
  padding: 15px;
  border-radius: 8px;
  background: #222;
  color: white;
  border: 1px solid #555;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 18px;
  line-height: 1.6;
  resize: none;
  margin-bottom: 20px;
}

/* Action Buttons */
#adminFormContainer .action-buttons {
  display: flex;
  gap: 15px;
  justify-content: center;
}

#adminFormContainer .action-buttons button {
  padding: 12px 25px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 500;
  transition: all 0.2s ease;
}

#adminPreviewBtn {
  background: #2196F3;
  color: white;
}

#adminSaveBtn {
  background: #4CAF50;
  color: white;
}

#adminCancelBtn {
  background: #f44336;
  color: white;
}

/* Status Message */
#adminStatus {
  margin-top: 15px;
  padding: 12px;
  border-radius: 6px;
  text-align: center;
  font-size: 16px;
}

/* Overlay */
#adminOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 1000;
  display: none;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  #adminFormContainer {
    width: 95vw;
    height: 90vh;
    padding: 15px;
  }
  
  #adminContentEditor {
    font-size: 16px;
  }
  
  .action-buttons {
    flex-direction: column;
  }
  
  .action-buttons button {
    width: 100%;
  }
}


/* CSS untuk Dashboard */
  .dashboard-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
    color: white;
  }
  
  .dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
  }
  
  .dashboard-notification-bell {
    position: relative;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: background-color 0.3s;
  }
  
  .dashboard-notification-bell:hover {
    background-color: rgba(255,255,255,0.1);
  }
  
  .notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: #ff4444;
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
  }
  
  .dashboard-profile, .dashboard-notifications, .dashboard-activity {
    background-color: rgba(0,0,0,0.3);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
  }
  
  .profile-header, .notifications-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .edit-btn, .small-btn {
    background-color: rgba(255,255,255,0.1);
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 14px;
    transition: background-color 0.3s;
  }
  
  .edit-btn:hover, .small-btn:hover {
    background-color: rgba(255,255,255,0.2);
  }
  
  .profile-picture-container {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
  }
  
  .profile-picture {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid rgba(255,255,255,0.2);
  }
  
  .profile-detail {
    margin-bottom: 10px;
    display: flex;
  }
  
  .detail-label {
    color: rgba(255,255,255,0.7);
    width: 120px;
  }
  
  .detail-value {
    color: white;
    flex: 1;
  }
  
  .social-links-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  .social-link-input {
    display: flex;
    align-items: center;
  }
  
  .social-icon {
    margin-right: 10px;
    color: rgba(255,255,255,0.7);
  }
  
  .social-links {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .social-link {
    color: #4CAF50;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .social-link:hover {
    text-decoration: underline;
  }
  
  .save-btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  
  .save-btn:hover {
    background-color: #3e8e41;
  }
  
  .cancel-btn {
    background-color: rgba(255,255,255,0.1);
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  
  .cancel-btn:hover {
    background-color: rgba(255,255,255,0.2);
  }
  
  .back-btn {
    background-color: rgba(255,255,255,0.1);
    color: white;
    border: none;
    padding: 10px 25px;
    border-radius: 5px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background-color 0.3s;
  }
  
  .back-btn:hover {
    background-color: rgba(255,255,255,0.2);
  }
  
  .notification-actions {
    display: flex;
    gap: 10px;
  }
  
  .notifications-list {
    max-height: 300px;
    overflow-y: auto;
  }
  
  .notification-item {
    padding: 12px 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
  }
  
  .notification-item.unread {
    background-color: rgba(66, 133, 244, 0.1);
  }
  
  .notification-icon {
    margin-right: 10px;
    color: #4CAF50;
  }
  
  .notification-content {
    flex: 1;
  }
  
  .notification-time {
    color: rgba(255,255,255,0.5);
    font-size: 12px;
    margin-top: 3px;
  }
  
  .activity-tabs {
    display: flex;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    margin-bottom: 15px;
  }
  
  .activity-tab {
    background: none;
    border: none;
    color: rgba(255,255,255,0.7);
    padding: 8px 15px;
    cursor: pointer;
    position: relative;
  }
  
  .activity-tab.active {
    color: white;
  }
  
  .activity-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #4CAF50;
  }
  
  .activity-item {
    padding: 10px 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  
  .activity-time {
    color: rgba(255,255,255,0.5);
    font-size: 12px;
    margin-top: 3px;
  }
  
  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.7);
  }
  
  .modal-content {
    background-color: rgba(0,0,0,0.9);
    margin: 5% auto;
    padding: 20px;
    border: 1px solid #444;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
  }
  
  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
  
  .close-modal {
    color: rgba(255,255,255,0.7);
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  
  .close-modal:hover {
    color: white;
  }
  
  .setting-item {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
    margin-right: 10px;
  }
  
  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
  }
  
  .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }
  
  input:checked + .slider {
    background-color: #4CAF50;
  }
  
  input:checked + .slider:before {
    transform: translateX(26px);
  }
  
  .modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
  }







.notification-item {
    padding: 12px 15px;
    border-bottom: 1px solid #444;
    cursor: pointer;
    transition: background-color 0.2s;
    display: flex;
    align-items: center;
}

.notification-item:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

.notification-item.unread {
    background-color: rgba(77, 166, 255, 0.1);
}

.notification-icon {
    font-size: 20px;
    margin-right: 15px;
    width: 30px;
    text-align: center;
}

.notification-content {
    flex: 1;
}

.notification-time {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.6);
    margin-top: 3px;
}

.notification-action {
    display: inline-block;
    margin-top: 5px;
    padding: 3px 8px;
    background-color: #4da6ff;
    color: white;
    border-radius: 4px;
    font-size: 12px;
    cursor: pointer;
}

.highlight-comment {
    animation: highlight 3s;
    border-left: 3px solid #4da6ff;
    padding-left: 10px;
}

.highlight-reply {
    animation: highlight 3s;
    background-color: rgba(77, 166, 255, 0.1);
}

@keyframes highlight {
    0% { background-color: rgba(77, 166, 255, 0.3); }
    100% { background-color: transparent; }
}




/* Notifikasi */
.notification-item {
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    background: rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.notification-item.unread {
    background: rgba(77, 166, 255, 0.15);
    border-left: 3px solid #4da6ff;
}

.notification-item:hover {
    background: rgba(255,255,255,0.1);
}

.notification-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.notification-content {
    flex-grow: 1;
}

.notification-content small {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
    display: block;
    margin-top: 4px;
}

/* Aktivitas */
.activity-item {
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    background: rgba(255,255,255,0.05);
    display: flex;
    cursor: pointer;
    transition: all 0.3s ease;
}

.activity-item:hover {
    background: rgba(255,255,255,0.1);
}

.activity-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.activity-content {
    flex-grow: 1;
}

.activity-content h4 {
    margin: 0 0 4px 0;
    color: #4da6ff;
}

.activity-content p {
    margin: 0 0 4px 0;
    color: rgba(255,255,255,0.8);
}

.activity-content small {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
}






/* Notifikasi */
.notification-item {
    padding: 12px 15px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    cursor: pointer;
    transition: background 0.2s;
    display: flex;
    align-items: flex-start;
}

.notification-item:hover {
    background: rgba(255,255,255,0.05);
}

.notification-item.unread {
    background: rgba(41, 98, 255, 0.1);
}

.notification-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.notification-content {
    flex-grow: 1;
}

.notification-content p {
    margin: 0 0 5px 0;
    color: white;
}

.notification-content small {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
}

.notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #ff4757;
    color: white;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: bold;
}

/* Aktivitas Terkini */
.activity-tabs {
    display: flex;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    margin-bottom: 15px;
}

.activity-tab {
    padding: 8px 15px;
    background: none;
    border: none;
    color: rgba(255,255,255,0.7);
    cursor: pointer;
    font-size: 13px;
    position: relative;
}

.activity-tab.active {
    color: white;
    font-weight: bold;
}

.activity-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: #4da6ff;
}

.activity-item {
    padding: 12px 15px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    cursor: pointer;
    transition: background 0.2s;
    display: flex;
    align-items: flex-start;
}

.activity-item:hover {
    background: rgba(255,255,255,0.05);
}

.activity-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.activity-content {
    flex-grow: 1;
}

.activity-content p {
    margin: 0 0 5px 0;
    color: rgba(255,255,255,0.8);
    font-size: 13px;
}

.activity-content small {
    color: rgba(255,255,255,0.6);
    font-size: 11px;
}



/* Gaya untuk notifikasi dan aktivitas */
.notification-item, .activity-item {
    padding: 12px;
    margin: 5px 0;
    border-radius: 8px;
    background: rgba(255,255,255,0.03);
    transition: all 0.3s ease;
}

.notification-item.unread {
    background: rgba(41, 98, 255, 0.1);
    border-left: 3px solid #4da6ff;
}

.notification-item:hover, .activity-item:hover {
    background: rgba(255,255,255,0.08);
    transform: translateX(2px);
}

.activity-tab-content {
    display: none;
    max-height: 300px;
    overflow-y: auto;
}

.activity-tab-content.active {
    display: block;
}

/* Animasi untuk notifikasi baru */
@keyframes newNotification {
    0% { transform: scale(0.95); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

.new-notification {
    animation: newNotification 0.3s ease-out;
}




/* Notifikasi */
.notifications-list {
    max-height: 400px;
    overflow-y: auto;
    padding: 10px;
}

.notification-item {
    display: flex;
    align-items: flex-start;
    padding: 12px;
    margin-bottom: 8px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.05);
    cursor: pointer;
    transition: background 0.2s;
    position: relative;
}

.notification-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.notification-item.unread {
    background: rgba(41, 98, 255, 0.1);
}

.notification-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.notification-content {
    flex-grow: 1;
}

.notification-content p {
    margin: 0 0 4px 0;
    color: white;
}

.notification-content small {
    color: rgba(255, 255, 255, 0.6);
    font-size: 12px;
}

.notification-unread-dot {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #4CAF50;
}

/* Aktivitas */
.activity-tabs {
    display: flex;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 15px;
}

.activity-tab {
    padding: 8px 16px;
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.7);
    cursor: pointer;
    font-size: 14px;
    position: relative;
}

.activity-tab.active {
    color: white;
    font-weight: 500;
}

.activity-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: #4CAF50;
}

.activity-tab-content {
    display: none;
}

.activity-tab-content.active {
    display: block;
}

.activity-item {
    display: flex;
    align-items: flex-start;
    padding: 12px;
    margin-bottom: 8px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.05);
    cursor: pointer;
    transition: background 0.2s;
}

.activity-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.activity-icon {
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.activity-content {
    flex-grow: 1;
}

.activity-content p {
    margin: 0 0 4px 0;
    color: white;
}

.activity-content small {
    color: rgba(255, 255, 255, 0.6);
    font-size: 12px;
}

/* Loader */
.loader {
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-top: 3px solid #4CAF50;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    animation: spin 1s linear infinite;
    margin: 0 auto 10px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.notification-loader,
.activity-loader {
    text-align: center;
    padding: 20px;
    color: rgba(255, 255, 255, 0.7);
}

/* Toast */
.toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #4CAF50;
    color: white;
    padding: 12px 24px;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

.toast.error {
    background: #f44336;
}

.toast.warning {
    background: #ff9800;
}

@keyframes slideIn {
    from { bottom: -50px; opacity: 0; }
    to { bottom: 20px; opacity: 1; }
}

.fade-out {
    animation: fadeOut 0.5s ease-out forwards;
}

@keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
}



/* Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.7);
}

.modal-content {
    background-color: #2a2a2a;
    margin: 5% auto;
    padding: 20px;
    border-radius: 8px;
    width: 80%;
    max-width: 600px;
    color: white;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.modal-header h3 {
    margin: 0;
}

.close-modal {
    font-size: 28px;
    cursor: pointer;
}

/* Activity Items */
.activity-item {
    display: flex;
    padding: 12px;
    margin-bottom: 10px;
    background-color: #333;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.activity-item:hover {
    background-color: #444;
}

.activity-icon {
    font-size: 24px;
    margin-right: 15px;
}

.activity-content {
    flex: 1;
}

.activity-content p {
    margin: 5px 0;
}

.activity-content small {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
}

.view-detail-btn {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    margin-top: 5px;
}

/* Detail Content */
.comment-detail, .reaction-detail, .post-detail {
    padding: 15px;
    background-color: #333;
    border-radius: 6px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    background-color: #4CAF50;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-right: 10px;
}

.user-info {
    flex: 1;
}

.user-info h4 {
    margin: 0;
}

.user-info small {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
}

.comment-header, .reaction-header, .post-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.view-original-btn {
    display: inline-block;
    background-color: #2196F3;
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    text-decoration: none;
    font-size: 12px;
    margin-left: 10px;
}

.like-btn {
    background-color: transparent;
    border: 1px solid rgba(255,255,255,0.2);
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    display: inline-flex;
    align-items: center;
}

.like-btn svg {
    margin-right: 5px;
}

/* Empty State */
.empty-state, .empty-notifications {
    padding: 20px;
    text-align: center;
    color: rgba(255,255,255,0.7);
}

/* Notification Badge */
.notification-badge {
    background-color: #f44336;
    color: white;
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 12px;
    position: absolute;
    top: -5px;
    right: -5px;
    display: none;
}

.unread {
    background-color: rgba(74, 144, 226, 0.1);
}






/* Style untuk halaman sponsor */
.sponsor-video {
  transition: transform 0.3s;
}

.sponsor-video:hover {
  transform: scale(1.02);
}

.video-caption {
  transition: opacity 0.3s;
}

.sponsor-video-item {
  transition: all 0.3s;
}

.sponsor-video-item:hover {
  transform: translateY(-5px);
}


.sponsorLink {
  color: #fff;
  text-decoration: none;
  display: flex;
  align-items: center;
}

.sponsorLink:hover {
  text-decoration: underline;
}




/* Efek hover untuk video TikTok */
iframe {
  transition: transform 0.3s ease;
}

iframe:hover {
  transform: scale(1.02);
}

/* Style untuk tombol hubungi sponsor */
#contactSponsorBtn {
  transition: all 0.3s ease;
}

#contactSponsorBtn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 20px rgba(0,102,255,0.3);
}



/* User List Styles */
.user-item {
  display: flex;
  align-items: center;
  padding: 10px;
  border-bottom: 1px solid #333;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #555;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  font-weight: bold;
}

.user-info {
  flex: 1;
}

.user-info h4 {
  margin: 0;
  color: white;
}

.user-info p, .user-info small {
  margin: 2px 0;
  color: #aaa;
}

.follow-btn, .message-btn {
  padding: 5px 10px;
  margin-left: 10px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.follow-btn {
  background: #4285f4;
  color: white;
}

.message-btn {
  background: #34a853;
  color: white;
}

/* Activity/Notification Detail Styles */
.activity-item, .notification-item {
  display: flex;
  padding: 10px;
  border-bottom: 1px solid #333;
}

.activity-icon, .notification-icon {
  font-size: 20px;
  margin-right: 15px;
}

.activity-content, .notification-content {
  flex: 1;
}

.activity-content p, .notification-content p {
  margin: 0;
  color: white;
}

.activity-content small, .notification-content small {
  color: #aaa;
}

.notification-item.unread {
  background: rgba(66, 133, 244, 0.1);
}

.notification-dot {
  width: 8px;
  height: 8px;
  background: #4285f4;
  border-radius: 50%;
  margin-left: 10px;
}


/* Users List Styles */
.dashboard-users {
    margin-top: 20px;
    padding: 20px;
    background: #1e1e1e;
    border-radius: 8px;
}

.users-search {
    margin-bottom: 15px;
}

.user-item {
    display: flex;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #333;
    margin-bottom: 10px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #555;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-weight: bold;
}

.user-info {
    flex: 1;
}

.user-info h4 {
    margin: 0;
    color: white;
}

.user-info p, .user-info small {
    margin: 2px 0;
    color: #aaa;
    display: block;
}

.user-actions {
    display: flex;
    gap: 10px;
}

.follow-btn, .message-btn {
    padding: 5px 10px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    white-space: nowrap;
}

.follow-btn {
    background: #4285f4;
    color: white;
}

.follow-btn.following {
    background: #34a853;
}

.message-btn {
    background: #fbbc05;
    color: white;
}

/* Message Modal Styles */
.message {
    margin-bottom: 10px;
    padding: 8px 12px;
    border-radius: 8px;
    max-width: 70%;
}

.message.sent {
    background: #4285f4;
    margin-left: auto;
    color: white;
}

.message.received {
    background: #333;
    margin-right: auto;
}

.message-content {
    word-wrap: break-word;
}

.message-time {
    font-size: 0.8em;
    color: #aaa;
    text-align: right;
    margin-top: 5px;
}




/* Users Search Section */
.users-search {
    position: relative;
    margin-bottom: 20px;
}

.search-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
}

.users-list {
    max-height: 500px;
    overflow-y: auto;
    padding-right: 5px;
}

.user-item {
    display: flex;
    align-items: center;
    padding: 12px;
    margin-bottom: 10px;
    background: #252525;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.user-item:hover {
    background: #333;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #444;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-weight: bold;
    color: white;
}

.user-info {
    flex: 1;
}

.user-info h4 {
    margin: 0;
    color: white;
    font-size: 15px;
}

.user-info p {
    margin: 3px 0 0;
    color: #aaa;
    font-size: 13px;
}

.user-info small {
    display: block;
    color: #666;
    font-size: 12px;
    margin-top: 3px;
}

.user-actions {
    display: flex;
    gap: 8px;
}

.follow-btn, .message-btn {
    padding: 6px 12px;
    border-radius: 6px;
    border: none;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.follow-btn {
    background: #444;
    color: white;
}

.follow-btn.following {
    background: #1a73e8;
    color: white;
}

.message-btn {
    background: #333;
    color: white;
    border: 1px solid #444;
}

.message-btn:hover {
    background: #444;
}

.no-users-found {
    text-align: center;
    padding: 20px;
    color: #888;
    font-size: 14px;
}


/* User List Styles */
.user-item {
  display: flex;
  align-items: center;
  padding: 15px;
  margin-bottom: 10px;
  background-color: #2a2a2a;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.user-item:hover {
  background-color: #333;
}

.user-avatar-container {
  position: relative;
  margin-right: 15px;
}

.user-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background-color: #4a6fa5;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
}

.user-status {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 2px solid #2a2a2a;
}

.user-status.online {
  background-color: #4caf50;
}

.user-status.offline {
  background-color: #f44336;
}

.user-details {
  flex-grow: 1;
}

.user-details h3 {
  margin: 0 0 5px 0;
  color: white;
}

.user-details p {
  margin: 0;
  color: #aaa;
  font-size: 14px;
}

.user-meta {
  display: flex;
  gap: 10px;
  margin-top: 5px;
}

.user-meta small {
  color: #777;
  font-size: 12px;
}

.user-actions {
  display: flex;
  gap: 10px;
}

.follow-btn {
  padding: 8px 15px;
  border: none;
  border-radius: 20px;
  background-color: #4a6fa5;
  color: white;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s ease;
}

.follow-btn:hover {
  background-color: #3a5a8f;
}

.follow-btn.following {
  background-color: #333;
  color: #aaa;
}

.message-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background-color: #333;
  color: white;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.message-btn:hover {
  background-color: #4a6fa5;
}

/* Loading states */
.users-loader {
  text-align: center;
  padding: 20px;
}

.users-loader .loader {
  border: 3px solid #f3f3f3;
  border-top: 3px solid #4a6fa5;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.no-users-found, .error-message {
  text-align: center;
  padding: 20px;
  color: #aaa;
}





/* Add to your existing CSS */
.user-item {
    display: flex;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid #333;
    transition: background-color 0.2s;
}

.user-item:hover {
    background-color: #2a2a2a;
}

.user-avatar-container {
    position: relative;
    margin-right: 15px;
}

.user-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: #444;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 18px;
}

.user-status {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px solid #1e1e1e;
}

.user-status.online {
    background-color: #4CAF50;
}

.user-status.offline {
    background-color: #888;
}

.user-details {
    flex: 1;
}

.user-details h3 {
    margin: 0 0 5px 0;
    color: white;
    font-size: 16px;
}

.user-details p {
    margin: 0 0 5px 0;
    color: #aaa;
    font-size: 14px;
}

.user-meta {
    display: flex;
    gap: 15px;
    margin-bottom: 5px;
}

.user-meta small {
    color: #888;
    font-size: 12px;
}

.user-stats {
    display: flex;
    gap: 15px;
}

.user-stats span {
    color: #aaa;
    font-size: 13px;
}

.user-actions {
    display: flex;
    gap: 10px;
}

.follow-btn {
    padding: 8px 15px;
    border-radius: 20px;
    border: none;
    background-color: #444;
    color: white;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
}

.follow-btn:hover {
    background-color: #555;
}

.follow-btn.following {
    background-color: #4CAF50;
}

.message-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    background-color: #444;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
}

.message-btn:hover {
    background-color: #555;
}

/* Message Modal Styles */
.message {
    margin-bottom: 10px;
    padding: 8px 12px;
    border-radius: 8px;
    max-width: 70%;
    word-wrap: break-word;
}

.message.sent {
    background-color: #4CAF50;
    margin-left: auto;
    border-bottom-right-radius: 0;
}

.message.received {
    background-color: #333;
    margin-right: auto;
    border-bottom-left-radius: 0;
}

.message-content {
    font-size: 14px;
    line-height: 1.4;
}

.message-time {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
    text-align: right;
    margin-top: 3px;
}

.no-users-found, .error-message {
    padding: 20px;
    text-align: center;
    color: #aaa;
}

.users-loader {
    padding: 20px;
    text-align: center;
}







/* Messaging System Styles */
.dashboard-messages {
  margin-bottom: 20px;
}

.messages-content {
  display: flex;
  height: 400px;
  border-radius: 8px;
  overflow: hidden;
  background: #252525;
}

.contacts-list {
  width: 30%;
  border-right: 1px solid #333;
  overflow-y: auto;
}

.contact-item {
  padding: 12px 15px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  transition: background 0.2s;
}

.contact-item:hover {
  background: #333;
}

.contact-item.active {
  background: #3a3a3a;
}

.contact-info {
  display: flex;
  align-items: center;
}

.contact-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #444;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 10px;
  font-weight: bold;
}

.contact-name {
  font-weight: 500;
}

.contact-last-message {
  font-size: 12px;
  color: #aaa;
  margin-top: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.unread-badge {
  background: #4CAF50;
  color: white;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  margin-left: auto;
}

.conversation-container {
  width: 70%;
  display: flex;
  flex-direction: column;
}

.no-conversation-selected {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: #777;
}

.conversation-header {
  padding: 12px 15px;
  border-bottom: 1px solid #333;
  font-weight: 500;
}

.messages-list {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}

.message-item {
  margin-bottom: 15px;
  max-width: 70%;
}

.message-sent {
  margin-left: auto;
  text-align: right;
}

.message-received {
  margin-right: auto;
}

.message-bubble {
  padding: 10px 15px;
  border-radius: 18px;
  display: inline-block;
}

.message-sent .message-bubble {
  background: #4CAF50;
  color: white;
}

.message-received .message-bubble {
  background: #333;
  color: white;
}

.message-time {
  font-size: 11px;
  color: #777;
  margin-top: 5px;
}

.message-input-container {
  padding: 10px;
  border-top: 1px solid #333;
  display: flex;
}

.message-input {
  flex: 1;
  padding: 10px;
  border-radius: 20px;
  border: 1px solid #444;
  background: #333;
  color: white;
  outline: none;
}

.send-message-btn {
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  margin-left: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Follow System Styles */
.dashboard-follow {
  margin-bottom: 20px;
}

.follow-stats {
  display: flex;
  justify-content: space-around;
  padding: 20px 0;
  border-bottom: 1px solid #333;
}

.follow-stat {
  text-align: center;
}

.stat-number {
  font-size: 24px;
  font-weight: bold;
  display: block;
}

.stat-label {
  font-size: 14px;
  color: #aaa;
}

.follow-lists {
  display: flex;
  margin-top: 15px;
}

.follow-list {
  width: 50%;
  padding: 0 10px;
}

.follow-list h3 {
  margin-bottom: 10px;
  font-size: 16px;
}

.list-container {
  max-height: 300px;
  overflow-y: auto;
}

.follow-user-item {
  display: flex;
  align-items: center;
  padding: 10px;
  border-bottom: 1px solid #333;
}

.follow-user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #444;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 10px;
  font-weight: bold;
}

.follow-user-name {
  flex: 1;
}

.follow-btn {
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 5px 10px;
  font-size: 12px;
  cursor: pointer;
}

.unfollow-btn {
  background: #f44336;
}

/* Modal Styles */
.modal {
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: #252525;
  border-radius: 8px;
  width: 400px;
  max-width: 90%;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.modal-header {
  padding: 15px;
  border-bottom: 1px solid #333;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h3 {
  margin: 0;
}

.close-modal {
  font-size: 24px;
  cursor: pointer;
}

.modal-body {
  padding: 15px;
}

.search-container {
  margin-bottom: 15px;
}

.search-container input {
  width: 100%;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #444;
  background: #333;
  color: white;
}

.user-list {
  max-height: 300px;
  overflow-y: auto;
}

.user-item {
  display: flex;
  align-items: center;
  padding: 10px;
  cursor: pointer;
  border-radius: 4px;
}

.user-item:hover {
  background: #333;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #444;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 10px;
  font-weight: bold;
}

.user-name {
  flex: 1;
}

.user-email {
  font-size: 12px;
  color: #aaa;
}




/* Style untuk sistem pesan */
.messages-content {
  display: flex;
  height: 500px;
  border: 1px solid #444;
  border-radius: 8px;
  overflow: hidden;
}

.contacts-list {
  width: 300px;
  border-right: 1px solid #444;
  overflow-y: auto;
}

.contact-item {
  padding: 12px;
  cursor: pointer;
  border-bottom: 1px solid #333;
  transition: background-color 0.2s;
}

.contact-item:hover {
  background-color: #333;
}

.contact-item.active {
  background-color: #444;
}

.contact-info {
  display: flex;
  align-items: center;
  gap: 10px;
}

.contact-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.unread-badge {
  background-color: #4CAF50;
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  margin-left: auto;
}

.conversation-container {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.conversation-header {
  padding: 12px;
  background-color: #333;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.messages-list {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
  background-color: #222;
}

.message-item {
  margin-bottom: 12px;
  max-width: 70%;
}

.message-sent {
  margin-left: auto;
  text-align: right;
}

.message-received {
  margin-right: auto;
}

.message-bubble {
  padding: 10px 15px;
  border-radius: 18px;
  display: inline-block;
}

.message-sent .message-bubble {
  background-color: #4CAF50;
  color: white;
}

.message-received .message-bubble {
  background-color: #444;
  color: white;
}

.message-time {
  font-size: 12px;
  color: #999;
  margin-top: 4px;
}

.message-status {
  margin-left: 5px;
  font-size: 12px;
}

.message-status.sent {
  color: #999;
}

.message-status.delivered {
  color: #ccc;
}

.message-status.read {
  color: #4CAF50;
}

.message-input-container {
  display: flex;
  padding: 12px;
  border-top: 1px solid #444;
  background-color: #333;
}

.message-input {
  flex: 1;
  padding: 10px;
  border-radius: 20px;
  border: 1px solid #444;
  background-color: #222;
  color: white;
}

.send-message-btn {
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  margin-left: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Style untuk sistem follow */
.follow-stats {
  display: flex;
  gap: 20px;
  margin-bottom: 20px;
}

.follow-stat {
  text-align: center;
  padding: 10px 20px;
  background-color: #333;
  border-radius: 8px;
}

.stat-number {
  font-size: 24px;
  font-weight: bold;
  display: block;
}

.stat-label {
  font-size: 14px;
  color: #999;
}

.follow-lists {
  display: flex;
  gap: 20px;
}

.follow-list {
  flex: 1;
  background-color: #333;
  border-radius: 8px;
  padding: 15px;
}

.follow-list h3 {
  margin-top: 0;
  border-bottom: 1px solid #444;
  padding-bottom: 10px;
}

.follow-user-item {
  display: flex;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid #444;
}

.follow-user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 10px;
}

.follow-user-name {
  flex: 1;
}

.follow-btn {
  padding: 5px 10px;
  border: none;
  border-radius: 4px;
  background-color: #4CAF50;
  color: white;
  cursor: pointer;
  font-size: 14px;
}

.follow-btn.unfollow-btn {
  background-color: #f44336;
}

/* Modal untuk pesan baru */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.7);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background-color: #333;
  border-radius: 8px;
  width: 400px;
  max-width: 90%;
}

.modal-header {
  padding: 15px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h3 {
  margin: 0;
}

.close-modal {
  font-size: 24px;
  cursor: pointer;
}

.modal-body {
  padding: 15px;
}

.search-container {
  margin-bottom: 15px;
}

.search-container input {
  width: 100%;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #444;
  background-color: #222;
  color: white;
}

.user-list {
  max-height: 300px;
  overflow-y: auto;
}

.user-item {
  display: flex;
  align-items: center;
  padding: 10px;
  cursor: pointer;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.user-item:hover {
  background-color: #444;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 10px;
}

.user-name {
  font-weight: bold;
}

.user-email {
  font-size: 12px;
  color: #999;
}





	
	
  </style>
</head>
<body>
  <div class="header">
    <img src="images/5.jpg" alt="Logo" class="logo" />
	<div class="title">Life Is What It Is Learn</div>
  </div>
  
  <div id="authArea" style="position: absolute; top: 10px; right: 20px; z-index: 999; display: flex; align-items: center; gap: 15px;">
  <button id="loginBtn" style="display: flex; align-items: center; background: none; border: 2px solid #9fc1d5; color: #9fc1d5; font-weight: bold; font-size: 29px; border-radius: 30px; padding: 10px 20px; cursor: pointer;">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 48 48" width="24">
      <path fill="#4285F4" d="M24 9.5c3.54 0 6.36 1.38 8.32 3.19l6.14-6.14C34.9 2.52 29.88 0 24 0 14.96 0 7.18 5.72 3.74 13.85l7.36 5.73C13 12.33 18.12 9.5 24 9.5z"/>
      <path fill="#34A853" d="M46.36 24.6c0-1.74-.16-3.41-.45-5.03H24v9.52h12.57c-.55 3-2.2 5.51-4.71 7.19v5.98h7.62c4.46-4.12 6.98-10.18 6.98-17.66z"/>
      <path fill="#FBBC05" d="M10.59 28.45c-1.07-3.2-1.07-6.64 0-9.84v-6.02H3.23a23.91 23.91 0 000 21.88l7.36-5.73z"/>
      <path fill="#EA4335" d="M24 48c6.48 0 11.92-2.13 15.9-5.78l-7.62-5.98C29.93 38.67 27.13 39.5 24 39.5c-5.88 0-10.98-3.84-12.9-9.14l-7.36 5.73C7.18 42.28 14.96 48 24 48z"/>
    </svg>
    <span style="margin-left: 10px;">Masuk dengan Google</span>
  </button>

  <button id="logoutBtn" style="display: none; background: none; border: 2px solid white; color: white; padding: 10px 15px; border-radius: 20px; font-size: 29px; cursor: pointer;">
    Keluar
  </button>

  <span id="greeting" style="color: white; font-size: 29px; margin-left: 15px;"></span>
</div>



<!-- Halaman 1 - Utama -->
  <div id="page1">
    <!-- Konten halaman utama -->
    <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
    <h1 style="color: white; font-size: 28px; margin-bottom: 20px; margin-left: 180px;">Halaman Utama</h1>
    <div class="line-box">
      <!-- Kartu-kartu konten -->
      <div class="card" id="card-arduino">
        <img src="images/5.jpg" alt="Foto Arduino" />
        <div class="card-title">
          Arduino 
          <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </div>
      </div>

      <div class="card" id="card-iot">
        <img src="images/5.jpg" alt="Foto IOT" />
        <div class="card-title">
          IOT 
          <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </div>
      </div>

      <div class="card" id="card-blog">
        <img src="images/5.jpg" alt="Foto Blog" />
        <div class="card-title">
          Blog
          <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </div>
      </div>
    </div>
	
	
   <div class="bottom-text">
  <div>
    <a href="#" class="tentangLink">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
      </svg>
      Tentang Kami
    </a>
  </div>
  <div>
    <a href="#" class="masukanLink">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
      </svg>
      Masukan
    </a>
  </div>
  <div>
    <a href="#" class="forumLink">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
      </svg>
      Forum Diskusi
    </a>
  </div>
  <div>
    <a href="#" class="sponsorLink">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
      </svg>
      Sponsor
    </a>
  </div>
</div>
</div>	
 















<!-- Halaman 2 - Arduino -->
  <div id="page2">
   <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>

    <h1 style="color: white; font-size: 28px; margin-bottom: 20px; margin-left: 180px;">Halaman Arduino</h1>
    <div class="line-box page2-content">
      <div class="page2-left">
        <img src="images/5.jpg" alt="Foto Arduino Detail" />
        <div class="bab-cards">
		<div class="bab-card sejarah-card">
    <div class="bab-title-box">Sejarah Arduino</div>
    <div class="bab-desc-box">Arduino pertama kali dikembangkan pada tahun 2005 di Italia untuk mempermudah pengajaran elektronika dan pemrograman.</div>
    <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
    </svg>
</div>

          <div class="bab-card">
            <div class="bab-title-box">Project Arduino</div>
            <div class="bab-desc-box">Dengan Arduino, banyak project dibuat seperti robotika, IoT, otomasi rumah, hingga alat bantu belajar interaktif.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Jenis Arduino</div>
            <div class="bab-desc-box">Terdapat banyak jenis board Arduino seperti Uno, Mega, Nano, yang memiliki spesifikasi berbeda sesuai kebutuhan.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Bahasa Pemrograman</div>
            <div class="bab-desc-box">Arduino menggunakan bahasa pemrograman C/C++ dengan IDE Arduino yang mudah dipelajari pemula.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Sensor & Modul</div>
            <div class="bab-desc-box">Arduino mendukung berbagai sensor & modul seperti sensor suhu, cahaya, motor driver, WiFi, dan lainnya.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
		  <!-- Contoh card untuk membuka dashboard -->
<div class="bab-card" id="dashboardCard">
  <div class="bab-title-box">Dashboard Saya</div>
  <div class="bab-desc-box">Kelola profil, notifikasi, dan aktivitas Anda</div>
  <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="5" y1="12" x2="19" y2="12"></line>
    <polyline points="12 5 19 12 12 19"></polyline>
  </svg>
</div>
		  
        </div>
      </div>
	  
	  
      <div class="page2-right">
        <h1 class="title-box">Arduino</h1>
        <p class="desc-box">
          Arduino adalah papan mikrokontroler open-source yang digunakan untuk membuat proyek elektronik interaktif.
          Dengan Arduino, Anda dapat mempelajari dasar-dasar pemrograman, sensor, dan aktuator dengan mudah.
          Cocok untuk pemula maupun profesional yang ingin membuat prototipe cepat.
        </p>
      </div>
	   <a href="https://faridardiansyah.netlify.app/#" target="_blank" style="
  position: fixed;
  bottom: 20px;
  right: 30px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 10px 20px;
  color: white;
  font-size: 16px;
  font-weight: 500;
  text-decoration: none;
  z-index: 999;
">
  Powered by: Manusia
</a>


    </div>
    
    <div class="bottom-line"></div>

    <div class="bottom-text">
      <div>
        <a href="#" class="tentangLink">

          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Tentang Kami
        </a>
      </div>
      <div>
       <a href="#" class="masukanLink">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Masukan
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Saran
        </a>
      </div>
    </div>

    <div class="nav-link">
      <a href="#" id="back">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 5 5 12 12 19"></polyline>
        </svg>
        Kembali
      </a>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  

  <!-- Halaman 3 - IoT -->
  <div id="page3">
   <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>

    <h1 style="color: white; font-size: 28px; margin-bottom: 20px; margin-left: 180px;">Halaman IoT</h1>
    <div class="line-box page2-content">
      <div class="page2-left">
        <img src="images/5.jpg" alt="Foto IOT" />
        <div class="bab-cards">
          <div class="bab-card">
            <div class="bab-title-box">Pengertian IoT</div>
            <div class="bab-desc-box">Internet of Things (IoT) adalah konsep menghubungkan perangkat fisik ke internet agar dapat saling berkomunikasi dan bertukar data.</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Contoh Penerapan</div>
            <div class="bab-desc-box">Contoh umum IoT meliputi smart home, smart city, kendaraan pintar, dan perangkat wearable.</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Komponen IoT</div>
            <div class="bab-desc-box">IoT terdiri dari sensor, perangkat, konektivitas jaringan, dan sistem cloud untuk pemrosesan data.</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Keamanan IoT</div>
            <div class="bab-desc-box">Aspek penting dari IoT adalah menjaga keamanan dan privasi data yang dikirim antar perangkat.</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Platform Populer</div>
            <div class="bab-desc-box">Beberapa platform IoT yang populer adalah Blynk, Thingspeak, dan Google Cloud IoT Core.</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
        </div>
      </div>
      <div class="page2-right">
        <h1 class="title-box">Internet of Things</h1>
        <p class="desc-box">
          IoT memungkinkan perangkat fisik terhubung ke jaringan internet untuk bertukar informasi dan memberikan kontrol secara jarak jauh.
          Teknologi ini semakin berkembang dan digunakan di berbagai bidang seperti industri, pertanian, kesehatan, dan rumah tangga.
        </p>
      </div>
	    <a href="https://faridardiansyah.netlify.app/#" target="_blank" style="
  position: fixed;
  bottom: 20px;
  right: 30px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 10px 20px;
  color: white;
  font-size: 16px;
  font-weight: 500;
  text-decoration: none;
  z-index: 999;
">
  Powered by: Manusia
</a>


    </div>

    <div class="bottom-line"></div>

    <div class="bottom-text">
      <div>
        <a href="#" class="tentangLink">

          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Tentang Kami
        </a>
      </div>
      <div>
        <a href="#" class="masukanLink">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Masukan
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Saran
        </a>
      </div>
    </div>

    <div class="nav-link">
      <a href="#" id="back-iot">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 5 5 12 12 19"></polyline>
        </svg>
        Kembali
      </a>
    </div>
  </div>



<!-- Pop-up Halaman Penuh -->
<div id="popup-dev" style="
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.95);
  color: white;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  padding: 20px;
">

  <!-- SVG animasi gear -->
  <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#00ffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
    style="animation: spin 2s linear infinite; margin-bottom: 30px;">
    <circle cx="12" cy="12" r="3"></circle>
    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06A1.65 1.65 0 0 0 15 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 8.6 15a1.65 1.65 0 0 0-1.82-.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 15.4 9a1.65 1.65 0 0 0 1.82.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 15z"></path>
  </svg>

  <h2 style="font-size: 28px; margin-bottom: 15px;">Website ini sedang dalam perkembangan</h2>
  <p style="font-size: 18px; color: #ccc;">Fitur dan tampilan mungkin akan berubah seiring waktu.</p>
  
  <button onclick="document.getElementById('popup-dev').style.display='none'" style="
    margin-top: 30px;
    padding: 10px 20px;
    background: none;
    border: 2px solid #00ffff;
    color: #00ffff;
    font-size: 18px;
    border-radius: 10px;
    cursor: pointer;
  ">Saya Mengerti</button>
</div>






<!-- Halaman 4 - Blog -->
<div id="page4">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 28px; margin-bottom: 20px; margin-left: 180px;">Halaman Blog</h1>
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 30px;">
    <h1 class="title-box">Blog Terbaru</h1>
    
    <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
      <p style="color: #ccc; margin: 0;">Artikel terbaru dari berbagai topik</p>
      <a href="#" id="lihatSemuaBlog" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: flex; align-items: center;">
        Lihat semua blog 
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </a>
    </div>
    
    <div class="bab-card" style="width: 100%; display: flex; gap: 20px; align-items: center;">
      <img src="images/5.jpg" alt="Blog 1" style="width: 200px; height: 120px; object-fit: cover; border-radius: 15px;" />
      <div style="flex: 1;">
        <div style="color: #ccc; font-size: 14px;">14 Juli 2025 • 60 min read</div>
        <h3 style="color: white; font-weight: bold; font-size: 20px; margin: 8px 0;">
         Siapa Farid Ardiansyah?
        </h3>
        <p style="color: #ccc; margin: 8px 0; line-height: 1.5;">
          Kalau Kamu tidak tau siapa farid ardiansyah, saya menjelaskan secara detail...
        </p>
        <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center;">
          Baca selengkapnya
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </div>
    
    <div class="bab-card" style="width: 100%; display: flex; gap: 20px; align-items: center;">
      <img src="images/5.jpg" alt="Blog 2" style="width: 200px; height: 120px; object-fit: cover; border-radius: 15px;" />
      <div style="flex: 1;">
        <div style="color: #ccc; font-size: 14px;">14 Juli 2025 • 60 min read</div>
        <h3 style="color: white; font-weight: bold; font-size: 20px; margin: 8px 0;">
          Apakah Kuliah di Universitas Gunadarma worth it sebanding harga UKT?
        </h3>
        <p style="color: #ccc; margin: 8px 0; line-height: 1.5;">
          Saya adalah alumnie univrsitas gunadarma, saya menjelaskan secara detail sesuai pengalaman kuliah 4 tahun...
        </p>
        <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center;">
          Baca selengkapnya
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </div>
    
    <div class="bab-card" style="width: 100%; display: flex; gap: 20px; align-items: center;">
      <img src="images/5.jpg" alt="Blog 3" style="width: 200px; height: 120px; object-fit: cover; border-radius: 15px;" />
      <div style="flex: 1;">
        <div style="color: #ccc; font-size: 14px;">14 Juli 2025 • 60 min read</div>
        <h3 style="color: white; font-weight: bold; font-size: 20px; margin: 8px 0;">
          Apakah saya membutuhkan pasangan dalam hidup?
        </h3>
        <p style="color: #ccc; margin: 8px 0; line-height: 1.5;">
          saya menjelaskan secara detail sesuai dengan pengalaman hidup...
        </p>
        <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center;">
          Baca selengkapnya
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </div>
  </div>
  
  
  <div class="bottom-line"></div>

    <div class="bottom-text">
      <div>
        <a href="#" class="tentangLink">

          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Tentang Kami
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Masukan
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Saran
        </a>
      </div>
    </div>

  <div class="nav-link">
    <a href="#" id="back-blog">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
  
  <a href="https://faridardiansyah.netlify.app/#" target="_blank" style="
    position: fixed;
    bottom: 20px;
    right: 30px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    padding: 10px 20px;
    color: white;
    font-size: 16px;
    font-weight: 500;
    text-decoration: none;
    z-index: 999;
  ">
    Powered by: Manusia
  </a>
</div>







<!-- Halaman 5 - Kumpulan Blog -->
<div id="page5">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 28px; margin: 30px 0 10px 180px;">Kumpulan Blog</h1>
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 20px;">
    <!-- Header dengan info jumlah blog -->
    <div style="width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <div id="blogCountDisplay" style="color: #ccc; font-size: 16px;">
        Menampilkan 6 dari 25 Blog
      </div>
      <div style="display: flex; gap: 10px; align-items: center;">
        <div style="position: relative;">
          <input type="text" id="blogSearch" placeholder="Cari blog..." style="
            padding: 10px 15px;
            padding-right: 40px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            color: white;
            font-size: 14px;
            width: 250px;
          ">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
          ">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </div>
        <button id="searchBtn" style="
          padding: 10px 15px;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          border-radius: 20px;
          color: #4ea1ff;
          font-size: 14px;
          cursor: pointer;
          transition: all 0.3s;
        ">
          Cari
        </button>
      </div>
    </div>
    
    <!-- Daftar blog -->
    <div id="blogList" style="width: 100%; display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;">
      <!-- Blog 1 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="BMKG: Cuaca Ekstrem Masih Mengintai, Musim Kemarau Belum Dominan" data-date="2025-07-12" data-category="Berita" data-tags="cuaca, bmkg, iklim">
        <img src="images/5.jpg" alt="Blog 1" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: red; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;">Farid Ardiansyah</span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
            Siapa Farid Ardiansyah?
          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
            Kalau Kamu tidak tau siapa farid ardiansyah, saya menjelaskan secara detail.....
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Blog 2 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="Tutorial Arduino: Membuat Sistem Monitoring Suhu dan Kelembaban" data-date="2025-07-10" data-category="Tutorial" data-tags="arduino, sensor, pemrograman">
        <img src="images/5.jpg" alt="Blog 2" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: blue; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;">Universitas Gunadarma </span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
            Apakah Kuliah di Universitas Gunadarma worth it sebanding harga UKT?

          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
            Saya adalah alumnie univrsitas gunadarma, saya menjelaskan secara detail sesuai pengalaman kuliah 4 tahun......
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Blog 3 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="IoT dalam Pertanian: Meningkatkan Produktivitas dengan Teknologi" data-date="2025-07-08" data-category="Teknologi" data-tags="iot, pertanian, smart-farming">
        <img src="images/5.jpg" alt="Blog 3" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: green; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;">pasangan</span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
		  Apakah saya membutuhkan pasangan dalam hidup?

          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
            saya menjelaskan secara detail sesuai dengan pengalaman hidup......
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Blog 4 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="Review Modul ESP32: Kelebihan dan Kekurangan untuk Project IoT" data-date="2025-07-05" data-category="Review" data-tags="esp32, iot, review">
        <img src="images/5.jpg" alt="Blog 4" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: red; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;"> Belum dibikin blog nya, sabar ya</span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
            Belum dibikin blog nya, sabar ya
          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
            saya bakal bikin blog nya sesuai waktu ya
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Blog 5 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="Panduan Lengkap Pemrograman Arduino untuk Pemula" data-date="2025-07-03" data-category="Tutorial" data-tags="arduino, pemrograman, dasar">
        <img src="images/5.jpg" alt="Blog 5" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: yellow; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;">  Belum dibikin blog nya, sabar ya</span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
             Belum dibikin blog nya, sabar ya
          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
                        saya bakal bikin blog nya sesuai waktu ya...
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Blog 6 -->
      <div class="bab-card blog-item" style="display: flex; flex-direction: column; height: 100%; transition: transform 0.3s;" data-title="Teknologi Smart Home: Mengontrol Rumah dari Smartphone" data-date="2025-07-01" data-category="Teknologi" data-tags="smart-home, iot, otomasi">
        <img src="images/5.jpg" alt="Blog 6" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" />
        <div style="flex: 1; display: flex; flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="color: green; font-size: 12px; font-weight: bold; background: rgba(78, 161, 255, 0.1); padding: 4px 8px; border-radius: 10px;"> Belum dibikin blog nya, sabar ya</span>
            <span style="color: #ccc; font-size: 12px;">14 Juli 2025</span>
          </div>
          <h3 style="color: white; font-weight: bold; font-size: 18px; margin: 0 0 10px 0; line-height: 1.4;">
             Belum dibikin blog nya, sabar ya
          </h3>
          <p style="color: #ccc; margin: 0 0 15px 0; line-height: 1.5; font-size: 14px; flex-grow: 1;">
             saya bakal bikin blog nya sesuai waktu ya......
          </p>
          <a href="#" style="color: #4ea1ff; font-weight: bold; text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; margin-top: auto;">
            Baca selengkapnya
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 5px;">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </a>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
      <button id="prevPage" style="
        padding: 8px 16px;
        background: transparent;
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 8px;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: all 0.3s;
      ">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Sebelumnya
      </button>
      
      <div style="display: flex; gap: 5px;">
        <button class="page-btn active" data-page="1" style="
          width: 35px;
          height: 35px;
          border-radius: 50%;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          color: white;
          cursor: pointer;
          transition: all 0.3s;
        ">1</button>
        <button class="page-btn" data-page="2" style="
          width: 35px;
          height: 35px;
          border-radius: 50%;
          background: transparent;
          border: 1px solid rgba(255,255,255,0.2);
          color: white;
          cursor: pointer;
          transition: all 0.3s;
        ">2</button>
        <button class="page-btn" data-page="3" style="
          width: 35px;
          height: 35px;
          border-radius: 50%;
          background: transparent;
          border: 1px solid rgba(255,255,255,0.2);
          color: white;
          cursor: pointer;
          transition: all 0.3s;
        ">3</button>
        <span style="color: white; display: flex; align-items: center; padding: 0 10px;">...</span>
        <button class="page-btn" data-page="8" style="
          width: 35px;
          height: 35px;
          border-radius: 50%;
          background: transparent;
          border: 1px solid rgba(255,255,255,0.2);
          color: white;
          cursor: pointer;
          transition: all 0.3s;
        ">8</button>
      </div>
      
      <button id="nextPage" style="
        padding: 8px 16px;
        background: transparent;
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 8px;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: all 0.3s;
      ">
        Selanjutnya
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </button>
    </div>
  </div>
  
  <div class="bottom-line"></div>

    <div class="bottom-text">
      <div>
        <a href="#" class="tentangLink">

          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Tentang Kami
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Masukan
        </a>
      </div>
      <div>
        <a href="#">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Saran
        </a>
      </div>
    </div>

  <div class="nav-link">
    <a href="#" id="back-page5">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
  
  <a href="https://faridardiansyah.netlify.app/#" target="_blank" style="
    position: fixed;
    bottom: 20px;
    right: 30px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    padding: 10px 20px;
    color: white;
    font-size: 16px;
    font-weight: 500;
    text-decoration: none;
    z-index: 999;
  ">
    Powered by: Manusia
  </a>
</div>


<!-- Halaman 6 - Tentang Kami -->
<div id="page6" style="display:none;">
  
  <h1 style="color: white; font-size: 39px; margin: 20px 0 30px 180px;">Tentang Kami</h1>
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 30px;">
  
    <div style="color: white; font-size: 25px;">
      Diperbarui <span id="tentangKamiTime">baru saja</span>
    </div>
  

  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;">
    Life Is What It Is Learn
  </div>

    <div style="color: white; font-size: 29px; line-height: 1.7;">
     Life Is What It Is Learn adalah website pengalaman hidup yang terus menerus tetap berjalan tanpa ada satupun yang support saya dalam hal apapun, maka nya saya terus belajar sampai meninggal, melupakan orang lain dan melupakan nyari pasangan. <br><br>
      Kunjungi Portfolio saya: 
      <a href="https://faridardiansyah.netlify.app/" target="_blank" style="color: red;">Portfolio Farid Ardiansyah</a>
    </div>
	
	<div style="color: white; font-size: 29px; line-height: 1.7;">
     saya terus belajar dan belajar tentang pemrograman, illustration character, saya terus perbaiki kesalahan dan kekurangan. kamu bisa diskusi di forum chat.
      <a href="https://forumchat-faridardiansyah.netlify.app/" target="_blank" style="color: green;">Forum Chat</a>
    </div>

    <img src="images/5.jpg" alt="Tentang Kami" style="width: 500px; border-radius: 20px;" />


  <div class="nav-link">
    <a href="#" id="back-tentang">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
</div>
</div>
</div>









<!-- Halaman 7 - Masukan -->
<div id="page7" style="display: none;">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 28px; margin: 30px 0 20px 180px;">Halaman Masukan</h1>
  
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 30px; padding: 40px; border-radius: 20px; background: rgba(0, 0, 0, 0.3); margin: 0 100px;">
    <!-- Header dengan info feedback -->
    <div style="width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <div id="feedbackCountDisplay" style="color: #ccc; font-size: 16px;">
        Menampilkan semua masukan
      </div>
      <div style="display: flex; gap: 10px;">
        <button id="sortNewest" class="sort-btn active" style="
          padding: 8px 15px;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          border-radius: 20px;
          color: #4ea1ff;
          font-size: 14px;
          cursor: pointer;
        ">
          Terbaru
        </button>
        <button id="sortPopular" class="sort-btn" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          Populer
        </button>
      </div>
    </div>

    <!-- Form Pengumuman (Hanya untuk Admin/Kontributor) -->
    <div id="adminAnnouncementForm" style="width: 100%; margin-bottom: 30px; display: none; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Buat Pengumuman
      </h2>
      
      <form id="announcementForm" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
        <div>
          <label for="announcementTitle" style="color: white; display: block; margin-bottom: 8px; font-size: 16px;">Judul Pengumuman</label>
          <input type="text" id="announcementTitle" placeholder="Contoh: Pemeliharaan Sistem" 
                 style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;">
        </div>
        
        <div>
          <label for="announcementContent" style="color: white; display: block; margin-bottom: 8px; font-size: 16px;">Isi Pengumuman</label>
          <textarea id="announcementContent" rows="5" placeholder="Tulis pengumuman Anda..." 
                    style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;"></textarea>
        </div>
        
        <div style="display: flex; justify-content: flex-end;">
          <button type="submit" id="submitAnnouncement" style="padding: 12px 25px; background: linear-gradient(135deg, #ff6b6b, #ff0000); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s;">
            Kirim Pengumuman
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 8px;">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
          </button>
        </div>
      </form>
    </div>

    <div id="pinnedAnnouncementsContainer" style="width: 100%; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: #ff6b6b; margin-bottom: 15px; font-size: 22px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">Pengumuman Penting</h2>
      <div id="pinnedAnnouncementsList"></div>
    </div>
    
    <div id="feedbackHistory" style="width: 100%; margin-bottom: 30px; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Riwayat Masukan
      </h2>
      <div id="feedbackListContainer" style="display: flex; flex-direction: column; gap: 15px;">
        <!-- Feedback items will be added here dynamically -->
      </div>
    </div>
    
    <!-- Form masukan baru -->
    <div id="newFeedbackForm" style="width: 100%; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Kirim Masukan Baru
      </h2>
      
      <form id="masukanForm" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <!-- Kolom 1 - Judul Masukan -->
        <div style="grid-column: 1;">
          <label for="feedbackTitle" style="color: white; display: block; margin-bottom: 8px; font-size: 16px;">Judul Masukan</label>
          <input type="text" id="feedbackTitle" placeholder="Contoh: Perbaikan desain halaman utama" 
                 style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;">
        </div>
        
        <!-- Kolom 2 - Kategori -->
        <div style="grid-column: 2;">
          <label for="feedbackCategory" style="color: white; display: block; margin-bottom: 8px; font-size: 16px;">Kategori</label>
        <select id="feedbackCategory" style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white; required">
    <option value="design">Desain</option>
    <option value="feature">Fitur</option>
    <option value="content">Konten</option>
    <option value="bug">Bug/Masalah</option>
    <option value="arduino">Arduino</option>
    <option value="other">Lainnya</option>
</select>
        </div>
        
        <!-- Kolom 3 - Isi Masukan (full width) -->
        <div style="grid-column: 1 / span 2;">
          <label for="feedbackContent" style="color: white; display: block; margin-bottom: 8px; font-size: 16px;">Isi Masukan</label>
          <textarea id="feedbackContent" rows="5" placeholder="Tulis masukan Anda secara detail..." 
                    style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;"></textarea>
        </div>
        
        <!-- Tombol Submit -->
        <div style="grid-column: 1 / span 2; display: flex; justify-content: flex-end;">
          <button type="submit" id="submitFeedback" style="padding: 12px 25px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s;">
            Kirim Masukan
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 8px;">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal untuk Reply -->
  <div id="replyModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;">
    <div style="background: #1a1a1a; border-radius: 15px; padding: 30px; width: 600px; max-width: 90%; max-height: 90vh; overflow-y: auto;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="color: white; font-size: 24px;">Balas Masukan</h2>
        <button id="closeReplyModal" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">&times;</button>
      </div>
      
      <div id="originalFeedback" style="margin-bottom: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;"></div>
      
      <form id="replyForm">
        <textarea id="replyContent" rows="5" placeholder="Tulis balasan Anda..." style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; margin-bottom: 20px;"></textarea>
        
        <div style="display: flex; justify-content: flex-end; gap: 10px;">
          <button type="button" id="cancelReply" style="padding: 10px 20px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; cursor: pointer;">
            Batal
          </button>
          <button type="submit" id="submitReply" style="padding: 10px 20px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">
            Kirim Balasan
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <div class="bottom-line"></div>

  <div class="bottom-text">
    <div>
      <a href="#" class="tentangLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Tentang Kami
      </a>
    </div>
    <div>
      <a href="#" class="masukanLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Masukan
      </a>
    </div>
    <div>
      <a href="#">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Saran
      </a>
    </div>
  </div>

  <div class="nav-link">
    <a href="#" id="back-masukan">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
</div>













<!-- Halaman 8 - Diskusi Forum -->
<div id="page8" style="display:none;">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 39px; margin: 20px 0 30px 180px;">Diskusi Forum</h1>
  
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 30px; padding: 40px;">
    <!-- Header dengan search dan filter -->
    <div style="width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <div style="display: flex; gap: 10px; align-items: center;">
        <div style="position: relative;">
          <input type="text" id="forumSearch" placeholder="Cari diskusi..." style="
            padding: 10px 15px;
            padding-right: 40px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            color: white;
            font-size: 16px;
            width: 300px;
          ">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
          ">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </div>
        <button id="searchForumBtn" style="
          padding: 10px 15px;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          border-radius: 20px;
          color: #4ea1ff;
          font-size: 16px;
          cursor: pointer;
          transition: all 0.3s;
        ">
          Cari
        </button>
      </div>
	  
	  
	  
	  <button id="newDiscussionBtn" style="padding: 10px 20px;background: linear-gradient(135deg, #4ea1ff, #0066ff);border: none;border-radius: 10px;color: white;font-weight: bold;cursor: pointer;display: flex;align-items: center;gap: 8px;">
  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="12" y1="5" x2="12" y2="19"></line>
    <line x1="5" y1="12" x2="19" y2="12"></line>
  </svg>
  Diskusi Baru
</button>
   
   <!-- Modal untuk Diskusi Baru -->
<div id="newDiscussionModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;">
  <div style="background: #1a1a1a; border-radius: 15px; padding: 30px; width: 600px; max-width: 90%; max-height: 90vh; overflow-y: auto;">
    <h2 style="color: white; font-size: 24px; margin-bottom: 20px;">Buat Diskusi Baru</h2>
    <form id="newDiscussionForm">
      <div style="margin-bottom: 20px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Judul Diskusi</label>
        <input type="text" id="discussionTitle" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
      </div>
      <div style="margin-bottom: 20px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Kategori</label>
        <select id="discussionCategory" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
          <option value="">Pilih Kategori</option>
          <option value="arduino">Arduino</option>
          <option value="iot">IoT</option>
          <option value="pemrograman">Pemrograman</option>
          <option value="elektronik">Elektronik</option>
          <option value="lainnya">Lainnya</option>
        </select>
      </div>
      <div style="margin-bottom: 20px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Deskripsi Diskusi</label>
        <textarea id="discussionContent" rows="5" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;"></textarea>
      </div>
      <div style="display: flex; justify-content: flex-end; gap: 10px;">
        <button type="button" id="cancelDiscussion" style="padding: 10px 20px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; cursor: pointer;">Batal</button>
        <button type="submit" id="submitDiscussion" style="padding: 10px 20px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">Buat Diskusi</button>
      </div>
    </form>
  </div>
</div>
</div>
   
   
   
   
   
    <!-- Kategori dan Tag -->
    <div style="width: 100%; margin-bottom: 20px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px;">Kategori Populer</h2>
      <div style="display: flex; flex-wrap: wrap; gap: 10px;">
        <button class="category-btn active" data-category="all" style="
          padding: 8px 15px;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          border-radius: 20px;
          color: #4ea1ff;
          font-size: 14px;
          cursor: pointer;
        ">
          Semua
        </button>
        <button class="category-btn" data-category="arduino" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          Arduino
        </button>
        <button class="category-btn" data-category="iot" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          IoT
        </button>
        <button class="category-btn" data-category="pemrograman" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          Pemrograman
        </button>
        <button class="category-btn" data-category="elektronik" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          Elektronik
        </button>
      </div>
    </div>
    
    <!-- Filter Diskusi -->
    <div style="width: 100%; margin-bottom: 20px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px;">Filter Diskusi</h2>
      <div style="display: flex; gap: 10px; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 15px;">
        <button id="filterLatest" class="filter-btn active" data-filter="latest" style="
          padding: 8px 15px;
          background: rgba(78, 161, 255, 0.2);
          border: 1px solid rgba(78, 161, 255, 0.5);
          border-radius: 20px;
          color: #4ea1ff;
          font-size: 14px;
          cursor: pointer;
        ">
          Terbaru
        </button>
        <button id="filterHot" class="filter-btn" data-filter="hot" style="
          padding: 8px 15px;
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          color: white;
          font-size: 14px;
          cursor: pointer;
        ">
          Populer
        </button>
      </div>
    </div>

    <!-- Header Tabel Diskusi -->
    <div class="forum-header">
      <div class="forum-column">Topik</div>
      <div class="forum-column">Balasan</div>
      <div class="forum-column">Dilihat</div>
      <div class="forum-column">Aktivitas</div>
    </div>
    <div class="forum-header-line"></div>
    
    <!-- Daftar Diskusi -->
    <div id="discussionList" style="width: 100%;"></div>
    
    <!-- Pagination -->
    <div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 30px;">
      <button id="prevPageBtn" style="padding: 8px 15px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; cursor: pointer;">
        Sebelumnya
      </button>
      <div id="pageNumbers" style="display: flex; gap: 5px;"></div>
      <button id="nextPageBtn" style="padding: 8px 15px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; cursor: pointer;">
        Selanjutnya
      </button>
    </div>
  </div>
  
  <div class="bottom-line"></div>

  <div class="bottom-text">
    <div>
      <a href="#" class="tentangLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Tentang Kami
      </a>
    </div>
    <div>
      <a href="#" class="masukanLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Masukan
      </a>
    </div>
    <div>
      <a href="#">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Saran
      </a>
    </div>
  </div>

  <div class="nav-link">
    <a href="#" id="back-forum">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
  
  <!-- Modal untuk Diskusi Baru -->
  <div id="newDiscussionModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;">
    <div style="background: #1a1a1a; border-radius: 15px; padding: 30px; width: 600px; max-width: 90%; max-height: 90vh; overflow-y: auto;">
      <h2 style="color: white; font-size: 24px; margin-bottom: 20px;">Buat Diskusi Baru</h2>
      
      <form id="newDiscussionForm">
        <div style="margin-bottom: 20px;">
          <label style="color: white; display: block; margin-bottom: 8px;">Judul Diskusi</label>
          <input type="text" id="discussionTitle" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
        </div>
        
        <div style="margin-bottom: 20px;">
          <label style="color: white; display: block; margin-bottom: 8px;">Kategori</label>
          <select id="discussionCategory" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
            <option value="">Pilih Kategori</option>
            <option value="arduino">Arduino</option>
            <option value="iot">IoT</option>
            <option value="pemrograman">Pemrograman</option>
            <option value="elektronik">Elektronik</option>
            <option value="lainnya">Lainnya</option>
          </select>
        </div>
        
        <div style="margin-bottom: 20px;">
          <label style="color: white; display: block; margin-bottom: 8px;">Deskripsi Diskusi</label>
          <textarea id="discussionContent" rows="5" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;"></textarea>
        </div>
        
        <div style="display: flex; justify-content: flex-end; gap: 10px;">
          <button type="button" id="cancelDiscussion" style="padding: 10px 20px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; cursor: pointer;">
            Batal
          </button>
          <button type="submit" id="submitDiscussion" style="padding: 10px 20px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">
            Buat Diskusi
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <a href="https://faridardiansyah.netlify.app/#" target="_blank" style="
    position: fixed;
    bottom: 20px;
    right: 30px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    padding: 10px 20px;
    color: white;
    font-size: 16px;
    font-weight: 500;
    text-decoration: none;
    z-index: 999;
  ">
    Powered by: Manusia
  </a>
</div>








<!-- Halaman 9 - Detail Pengumuman -->
<div id="page9" style="display: none;">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 28px; margin: 30px 0 20px 180px;">Detail Pengumuman</h1>
  
  <div class="line-box" style="flex-direction: column; align-items: flex-start; gap: 30px; padding: 40px; border-radius: 20px; background: rgba(0, 0, 0, 0.3); margin: 0 100px;">
    <!-- Konten Pengumuman -->
    <div id="announcementDetailContainer" style="width: 100%; background: rgba(255,255,255,0.05); padding: 30px; border-radius: 15px;">
      <!-- Konten akan dimuat oleh JavaScript -->
    </div>

    <!-- Form Edit Pengumuman (Hanya untuk Admin) -->
    <div id="adminAnnouncementForm" style="display: none; width: 100%; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; margin-top: 20px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Edit Pengumuman
      </h2>
      <form id="editAnnouncementForm">
        <div style="margin-bottom: 20px;">
          <label style="display: block; color: white; margin-bottom: 8px; font-size: 16px;">Judul</label>
          <input type="text" id="editAnnouncementTitle" style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;">
        </div>
        <div style="margin-bottom: 20px;">
          <label style="display: block; color: white; margin-bottom: 8px; font-size: 16px;">Isi</label>
          <textarea id="editAnnouncementContent" rows="5" style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white;"></textarea>
        </div>
        <div style="display: flex; justify-content: flex-end; gap: 10px;">
          <button type="button" id="cancelEditAnnouncement" style="padding: 12px 25px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; color: white; cursor: pointer;">
            Batal
          </button>
          <button type="button" id="deleteAnnouncement" style="padding: 12px 25px; background: linear-gradient(135deg, #ff6b6b, #ff0000); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer;">
            Hapus
          </button>
          <button type="submit" style="padding: 12px 25px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer;">
            Simpan Perubahan
          </button>
        </div>
      </form>
    </div>
	








<div id="editComparisonModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box;">
  <div style="background: #2a2a2a; border-radius: 10px; width: 100%; max-width: 1000px; max-height: 90vh; overflow-y: auto; padding: 25px; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
    <!-- Header dengan info pengguna dan tanggal -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
      <div style="display: flex; align-items: center; gap: 15px;">
        <div id="comparisonUserAvatar" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; overflow: hidden;">
          <img id="comparisonUserPhoto" src="" alt="User" style="width: 100%; height: 100%; object-fit: cover; display: none;">
          <span id="comparisonUserInitial" style="color: white; font-weight: bold;"></span>
        </div>
        <div>
          <div id="comparisonUserName" style="color: white; font-weight: 500; font-size: 16px;">Admin</div>
          <div id="comparisonEditDate" style="color: #aaa; font-size: 12px;">Tanggal perubahan</div>
        </div>
      </div>
      <h2 style="color: white; margin: 0; font-size: 22px; display: flex; align-items: center;">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 10px;">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        Perbandingan Perubahan
      </h2>
      <button id="closeEditComparison" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 5px;">&times;</button>
    </div>
    
    <!-- Navigasi perubahan -->
    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
      <button id="prevComparison" style="padding: 8px 15px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;" disabled>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Sebelumnya
      </button>
      <div id="comparisonCounter" style="color: #aaa; font-size: 14px; display: flex; align-items: center;">
        Perubahan 1 dari 1
      </div>
      <button id="nextComparison" style="padding: 8px 15px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;" disabled>
        Selanjutnya
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>
    
    <!-- Konten perbandingan -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
      <div style="border: 1px solid rgba(255,107,107,0.3); border-radius: 8px; padding: 15px;">
        <h3 style="color: #ff6b6b; margin-top: 0; border-bottom: 1px solid rgba(255,107,107,0.3); padding-bottom: 10px; display: flex; align-items: center;">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
          Sebelum Edit
        </h3>
        <div id="beforeEditContent" style="color: #ddd; line-height: 1.6;"></div>
      </div>
      
      <div style="border: 1px solid rgba(78,161,255,0.3); border-radius: 8px; padding: 15px;">
        <h3 style="color: #4ea1ff; margin-top: 0; border-bottom: 1px solid rgba(78,161,255,0.3); padding-bottom: 10px; display: flex; align-items: center;">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
            <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
            <path d="M2 2l7.586 7.586"></path>
            <circle cx="11" cy="11" r="2"></circle>
          </svg>
          Sesudah Edit
        </h3>
        <div id="afterEditContent" style="color: #ddd; line-height: 1.6;"></div>
      </div>
    </div>
    
    <div style="background: rgba(255,255,255,0.05); border-radius: 6px; padding: 12px; margin-top: 20px;">
      <div style="display: flex; align-items: center; color: #aaa; font-size: 14px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12" y2="8"></line>
        </svg>
        <div>
          <div style="font-weight: 500; color: #ddd; margin-bottom: 5px;">Petunjuk Perbandingan:</div>
          <div style="display: flex; align-items: center; margin-bottom: 3px;">
            <span style="display: inline-block; width: 14px; height: 14px; background: rgba(78,161,255,0.3); border: 1px solid #4ea1ff; border-radius: 2px; margin-right: 8px;"></span>
            <span>Teks yang ditambahkan</span>
          </div>
          <div style="display: flex; align-items: center;">
            <span style="display: inline-block; width: 14px; height: 14px; background: rgba(255,107,107,0.3); border: 1px solid #ff6b6b; border-radius: 2px; margin-right: 8px; text-decoration: line-through;"></span>
            <span>Teks yang dihapus</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>











    <!-- Balasan Pengumuman -->
    <div id="announcementRepliesContainer" style="width: 100%; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Balasan (<span id="repliesCount">0</span>)
      </h2>
      <div id="announcementRepliesList" style="display: flex; flex-direction: column; gap: 15px;"></div>
      
      <!-- Form Balasan -->
      <div id="loginToReply" style="display: none; margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px; text-align: center;">
        <p style="color: #aaa; margin-bottom: 10px;">Silakan login untuk membalas</p>
        <a href="#" id="loginLink" style="color: #4ea1ff; text-decoration: none;">Login</a>
      </div>
      
      <form id="announcementReplyForm" style="display: none; margin-top: 20px;">
        <textarea id="announcementReplyContent" rows="3" placeholder="Tulis balasan Anda..." style="width: 100%; padding: 12px 15px; border-radius: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); color: white; margin-bottom: 15px;"></textarea>
        <div style="display: flex; justify-content: flex-end;">
          <button type="submit" style="padding: 12px 25px; background: linear-gradient(135deg, #4ea1ff, #0066ff); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer;">
            Kirim Balasan
          </button>
        </div>
      </form>
    </div>

    <!-- Pengumuman Terkait -->
    <div id="relatedAnnouncementsContainer" style="width: 100%; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
      <h2 style="color: white; font-size: 22px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        Pengumuman Terkait
      </h2>
      <div id="relatedAnnouncementsList"></div>
    </div>
  </div>

  <div class="bottom-line"></div>

  <div class="bottom-text">
    <div>
      <a href="#" class="tentangLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Tentang Kami
      </a>
    </div>
    <div>
      <a href="#" class="masukanLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Masukan
      </a>
    </div>
    <div>
      <a href="#">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Saran
      </a>
    </div>
  </div>

  <div class="nav-link">
    <a href="#" id="backToAnnouncements">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
</div>
  






<div id="page10" style="display: none;">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>

  <div class="title-section">
    <h1 style="color: white; font-size: 28px; margin-bottom: 20px; text-align: center;">Sejarah Lengkap Arduino</h1>

  </div>
  
  <div class="page10-container">
    <!-- Sidebar Daftar Konten -->
    <div class="page10-sidebar">
      <div class="sidebar-content linebox">
        <h3 class="sidebar-title">Daftar Konten</h3>

        <ul class="content-nav">
          <li><a href="#year2003" class="content-link active">2003 - Awal Mula</a></li>
          <li><a href="#year2005" class="content-link">2005 - Peluncuran</a></li>
          <li><a href="#year2008" class="content-link">2008 - Pertumbuhan</a></li>
          <li><a href="#year2010" class="content-link">2010 - Arduino Uno</a></li>
          <li><a href="#year2012" class="content-link">2012 - Ekspansi</a></li>
          <li><a href="#year2015" class="content-link">2015 - Perubahan</a></li>
          <li><a href="#year2017" class="content-link">2017 - Kolaborasi</a></li>
          <li><a href="#year2020" class="content-link">2020 - Pandemi</a></li>
          <li><a href="#yearNow" class="content-link">Sekarang</a></li>
        </ul>
      </div>
    </div>
    
    <!-- Konten Utama Timeline -->
    <div class="page10-main-content">
      <div class="history-content linebox">
        <h2 class="title-box-white">Timeline Perkembangan Arduino</h2>

        
        <div class="history-timeline">
          <!-- Garis vertikal timeline -->
          <div class="timeline-track-white"></div>
          
          <!-- Garis scroll indicator -->
          <div class="scroll-indicator-white" id="scrollIndicator"></div>
          
          <!-- Item Timeline -->
		  <div class="timeline-item" id="year2003">
  <div class="timeline-number-white">1</div>
  <div class="timeline-content">
    <h3>2003 - Awal Mula</h3>
    <p>Proyek Arduino dimulai di Interaction Design Institute Ivrea (IDII) di Ivrea, Italia sebagai alat untuk prototyping cepat bagi siswa desain<a href="#footnote1" class="footnote-link">[1]</a>.</p>
    <p>Ide awalnya adalah menciptakan alat yang mudah digunakan untuk membuat prototipe interaktif tanpa memerlukan latar belakang elektronik yang mendalam<a href="#footnote2" class="footnote-link">[2]</a>.</p>
  </div>

          </div>
          
          <div class="timeline-item" id="year2005">
            <div class="timeline-number-white">2</div>
            <div class="timeline-content">
              <h3>2005 - Peluncuran Resmi</h3>
              <p>Arduino pertama kali diperkenalkan dengan board berbasis ATMega8. Nama "Arduino" diambil dari nama bar di Ivrea yang sering dikunjungi oleh pendirinya.</p>
              <p>Board pertama ini memiliki 14 pin digital I/O (6 bisa digunakan sebagai PWM), 6 input analog, resonator keramik 16MHz, koneksi USB, dan jack power.</p>
              <p>Proyek ini dirilis sebagai open-source, baik desain hardware maupun software-nya.</p>
            </div>

          </div>
          
          <div class="timeline-item" id="year2008">
            <div class="timeline-number-white">3</div>
            <div class="timeline-content">
              <h3>2008 - Pertumbuhan Pesat</h3>
              <p>Popularitas Arduino meledak di kalangan maker dan komunitas DIY. Arduino Duemilanove dirilis dengan berbagai peningkatan fitur termasuk auto-select power source.</p>
              <p>Komunitas Arduino mulai bermunculan di berbagai negara, dengan forum online yang aktif berdiskusi tentang proyek dan pemecahan masalah.</p>
              <p>Buku pertama tentang Arduino diterbitkan, memperkenalkan platform ini ke audiens yang lebih luas.</p>
            </div>

          </div>
          
          <div class="timeline-item" id="year2010">
            <div class="timeline-number-white">4</div>
            <div class="timeline-content">
              <h3>2010 - Arduino Uno</h3>
              <p>Arduino Uno dirilis menjadi board standar paling populer dengan chip ATmega328P dan antarmuka USB yang stabil menggunakan chip ATmega16U2 sebagai USB-to-serial converter.</p>
              <p>Uno (berarti "satu" dalam bahasa Italia) menjadi board yang paling banyak digunakan dalam pendidikan dan proyek-proyek hobi.</p>
              <p>Versi ini memperkenalkan standar pinout yang kemudian diikuti oleh banyak board kompatibel Arduino.</p>
            </div>

          </div>
          
          <div class="timeline-item" id="year2012">
            <div class="timeline-number-white">5</div>
            <div class="timeline-content">
              <h3>2012 - Ekspansi Produk</h3>
              <p>Arduino memperluas jajaran produk dengan Arduino Due (processor ARM 32-bit pertama), Leonardo (menggunakan ATmega32u4 dengan USB built-in), dan berbagai shield tambahan.</p>
              <p>Arduino Yún diperkenalkan, menggabungkan processor Arduino dengan sistem Linux berbasis WiFi.</p>
              <p>Mulai muncul banyak clone dan varian Arduino dari berbagai produsen, menunjukkan popularitas platform ini.</p>
            </div>

          </div>
          
          <div class="timeline-item" id="year2015">
            <div class="timeline-number-white">6</div>
            <div class="timeline-content">
              <h3>2015 - Perubahan Perusahaan</h3>
              <p>Terjadi perpecahan dalam Arduino LLC dengan pembentukan Arduino SRL oleh salah satu pendiri. Hal ini menyebabkan kebingungan di komunitas dengan dua versi software yang berbeda.</p>
              <p>Arduino mengumpulkan $2.3 juta dalam kampanye Kickstarter untuk Arduino Tian, board dengan WiFi dan Bluetooth.</p>
              <p>IDE Arduino 1.6 dirilis dengan dukungan untuk board-board baru dan peningkatan stabilitas.</p>
            </div>

          </div>
          
          <div class="timeline-item" id="year2017">
            <div class="timeline-number-white">7</div>
            <div class="timeline-content">
              <h3>2017 - Kolaborasi dan Penyelesaian</h3>
              <p>Arduino LLC dan Arduino SRL akhirnya bersatu kembali setelah penyelesaian sengketa hukum, membentuk Arduino AG.</p>
              <p>Arduino mengumumkan kolaborasi dengan ARM untuk mengembangkan Arduino MKR series yang berfokus pada IoT.</p>
              <p>Arduino Create, platform cloud untuk pengembangan Arduino, diluncurkan secara resmi.</p>
            </div>
          </div>
          
          <div class="timeline-item" id="year2020">
            <div class="timeline-number-white">8</div>
            <div class="timeline-content">
              <h3>2020 - Masa Pandemi</h3>
              <p>Selama pandemi COVID-19, Arduino melihat peningkatan penggunaan untuk proyek-proyek DIY dan pendidikan di rumah.</p>
              <p>Arduino Portenta H7 diluncurkan, board profesional untuk aplikasi industri dan embedded.</p>
              <p>Arduino menyediakan konten pembelajaran online gratis untuk membantu pembelajaran jarak jauh.</p>
            </div>
          </div>
          
          <div class="timeline-item" id="yearNow">
            <div class="timeline-number-white">9</div>
            <div class="timeline-content">
              <h3>Sekarang - Platform Global</h3>
              <p>Arduino menjadi platform standar untuk pendidikan STEM dan proyek IoT dengan jutaan board terjual.</p>
              <p>Ekosistem Arduino terus berkembang dengan board-board baru seperti Nano RP2040 Connect dan Giga R1 WiFi.</p>
              <p>Arduino Cloud menjadi platform terintegrasi untuk pemrograman, monitoring, dan kontrol perangkat IoT.</p>
              <p>Komunitas global Arduino terus tumbuh dengan ribuan proyek open-source yang dibagikan setiap tahun.</p>
            </div>
          </div>
	<div class="video-container linebox" style="margin-bottom: 30px; ">
  <h2 class="title-box-white">Video Sejarah Arduino</h2>

  
  <div class="video-wrapper">
    <iframe 
      width="100%" 
      height="450" 
           src="https://www.youtube.com/embed/cTPYUox41bU?autoplay=0" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen
      style="border-radius: 15px;"
    ></iframe>
  </div>
  
  <div class="video-description">
    <p style="color: rgba(255,255,255,0.8); line-height: 1.6; font-size: 25px;">
      Video ini menampilkan sejarah lengkap perkembangan Arduino dari awal hingga sekarang. 
      Anda akan melihat bagaimana platform ini berkembang dari proyek kecil di Italia menjadi 
      fenomena global yang mengubah cara orang belajar elektronik dan pemrograman.
    </p>
  </div>
</div>

<!-- Tambahkan ini sebelum div.bottom-line -->
<div class="footnotes-container linebox">
  <h3 class="title-box-white">Catatan Kaki</h3>
  
  <div class="footnotes-list">
    <div id="footnote1" class="footnote-item">
      <span class="footnote-number">[1]</span>
      <span class="footnote-text">Banzi, M. (2011). <em>Getting Started with Arduino</em>. Maker Media. <a href="" target="_blank" class="footnote-link"></a></span>
    </div>
    
    <div id="footnote2" class="footnote-item">
      <span class="footnote-number">[2]</span>
      <span class="footnote-text">Arduino LLC. (2008). <em>Arduino History Documentation</em>. <a href="" target="_blank" class="footnote-link"></a></span>
    </div>
    
    <!-- Tambahkan lebih banyak catatan kaki sesuai kebutuhan -->
  </div>
</div>


        </div>
      </div>
    </div>
  </div>



<div class="reaction-container linebox">
  <h3 class="title-box-white">Bagaimana perasaan Anda tentang konten ini?</h3>
  <div class="sidebar-line-white"></div>
  
  <div class="emoji-reactions">
    <div class="emoji-option" data-emoji="happy">
      <span class="emoji">😊</span>
      <span class="emoji-count" id="happy-count">0</span>
    </div>
    
    <div class="emoji-option" data-emoji="sad">
      <span class="emoji">😢</span>
      <span class="emoji-count" id="sad-count">0</span>
    </div>
    
    <div class="emoji-option" data-emoji="disappointed">
      <span class="emoji">😞</span>
      <span class="emoji-count" id="disappointed-count">0</span>
    </div>
    
    <div class="emoji-option" data-emoji="angry">
      <span class="emoji">😠</span>
      <span class="emoji-count" id="angry-count">0</span>
    </div>
    
    <div class="emoji-option" data-emoji="neutral">
      <span class="emoji">😐</span>
      <span class="emoji-count" id="neutral-count">0</span>
    </div>
  </div>
  
  <div class="sidebar-line-white" style="margin-top: 20px;"></div>
  <p class="reaction-message" style="color: rgba(255,255,255,0.7); font-size: 14px; text-align: center;">
    Terima kasih atas feedback Anda!
  </p>
  <p class="login-message" style="color: white; font-size: 14px; text-align: center; display: none;">
    Silakan login untuk memberikan reaksi
  </p>
</div>






<!-- Tambahkan ini sebelum div.bottom-line -->
<div class="comments-container linebox">
  <h2 class="title-box-white">Diskusi Arduino</h2>
  
  <!-- Form Komentar -->
  <div class="comment-form">
    <textarea id="commentInput" placeholder="Tulis komentar Anda tentang sejarah Arduino..." rows="3"></textarea>
    <button id="submitComment" class="comment-submit-btn">Kirim Komentar</button>
  </div>
  
  <!-- Filter Kategori -->
  <div class="comment-filters">
    <button class="filter-btn active" data-filter="all">Semua Komentar</button>
    <button class="filter-btn" data-filter="new">Baru (≤7 hari)</button>
    <button class="filter-btn" data-filter="old">Lama (>7 hari)</button>
  </div>
  
  <!-- Info Jumlah Komentar -->
  <div class="comment-count-info">
    <span id="totalComments">0</span> Komentar (<span id="newComments">0</span> baru, <span id="oldComments">0</span> lama)
  </div>
  
  <!-- Daftar Komentar -->
  <div class="comments-list" id="commentsList">
    <!-- Komentar akan dimuat di sini -->
  </div>
</div>




<!-- Modified Metadata Container -->
<div class="metadata-container linebox">
  <div style="display: flex; justify-content: space-between; color: rgba(255,255,255,0.8); font-size: 14px;">
    <div>
      <span style="font-weight: bold;">Penulis Data:</span> 
      <span id="dataAuthor">-</span>
    </div>
    <div>
      <span style="font-weight: bold;">Terakhir Diupdate:</span> 
      <span id="lastUpdated">-</span>
    </div>
  </div>
</div>













          <div class="bab-card">
            <div class="bab-title-box">Project Arduino</div>
            <div class="bab-desc-box">Dengan Arduino, banyak project dibuat seperti robotika, IoT, otomasi rumah, hingga alat bantu belajar interaktif.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Jenis Arduino</div>
            <div class="bab-desc-box">Terdapat banyak jenis board Arduino seperti Uno, Mega, Nano, yang memiliki spesifikasi berbeda sesuai kebutuhan.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Bahasa Pemrograman</div>
            <div class="bab-desc-box">Arduino menggunakan bahasa pemrograman C/C++ dengan IDE Arduino yang mudah dipelajari pemula.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
          <div class="bab-card">
            <div class="bab-title-box">Sensor & Modul</div>
            <div class="bab-desc-box">Arduino mendukung berbagai sensor & modul seperti sensor suhu, cahaya, motor driver, WiFi, dan lainnya.</div>
             <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
      






<!-- Improved Admin Edit Form -->
<div id="adminFormContainer" style="display: none; background: rgba(0,0,0,0.95); padding: 25px; border-radius: 15px; margin-top: 30px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1001; width: 90%; max-width: 900px; max-height: 90vh; overflow-y: auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); border: 1px solid #444;">
  <h2 style="color: white; text-align: center; margin-bottom: 20px; font-size: 24px; border-bottom: 1px solid #444; padding-bottom: 10px;">Editor Konten Halaman 10</h2>
  
  <div id="adminAuth" style="margin-bottom: 20px; text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 8px;">
    <p style="color: white; margin-bottom: 15px; font-size: 16px;">Anda harus login sebagai admin untuk mengedit konten</p>
    <button id="adminLoginBtn" style="padding: 10px 20px; background: #4285F4; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; display: flex; align-items: center; margin: 0 auto;">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
        <polyline points="10 17 15 12 10 7"></polyline>
        <line x1="15" y1="12" x2="3" y2="12"></line>
      </svg>
      Login dengan Google
    </button>
  </div>
  
  <div id="adminControls" style="display: none;">
    <div style="color: white; margin-bottom: 20px; text-align: center; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
      Login sebagai: <span id="adminEmail" style="font-weight: bold; color: #4CAF50;"></span>
      <button id="adminLogoutBtn" style="margin-left: 15px; padding: 5px 12px; background: #ff4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
        Logout
      </button>
    </div>
    
    <!-- Tab Navigation -->
    <div class="admin-tabs" style="display: flex; margin-bottom: 15px; border-bottom: 1px solid #444;">
      <button class="admin-tab active" data-tab="content">Konten Utama</button>
      <button class="admin-tab" data-tab="metadata">Metadata</button>
    </div>
    
    <!-- Content Tab -->
    <div id="contentTab" class="admin-tab-content" style="display: block;">
      <h3 style="color: white; margin-bottom: 15px; font-size: 18px;">Edit Bagian Konten</h3>
      
      <!-- Section Selection -->
      <div style="margin-bottom: 20px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Pilih Bagian:</label>
        <select id="contentSection" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444; margin-bottom: 15px;">
          <option value="title">Judul Halaman</option>
          <option value="timeline">Timeline</option>
          <option value="video">Bagian Video</option>
          <option value="footnotes">Catatan Kaki</option>
          <option value="reactions">Bagian Reaksi</option>
          <option value="comments">Bagian Komentar</option>
          <option value="cards">Kartu Informasi</option>
        </select>
      </div>
      
      <!-- Content Editor -->
      <div id="editorContainer" style="margin-bottom: 20px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Editor Konten:</label>
        <textarea id="adminContentEditor" style="width: 100%; height: 300px; padding: 12px; border-radius: 5px; margin-bottom: 15px; background: #222; color: white; border: 1px solid #444; font-family: monospace; font-size: 14px; line-height: 1.5; white-space: pre; overflow-x: auto;"></textarea>
      </div>
    </div>
    
    <!-- Metadata Tab -->
    <div id="metadataTab" class="admin-tab-content" style="display: none;">
      <h3 style="color: white; margin-bottom: 15px; font-size: 18px;">Edit Metadata</h3>
      
      <div style="margin-bottom: 15px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Penulis:</label>
        <input type="text" id="authorInput" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444; margin-bottom: 15px;">
      </div>
      
      <div style="margin-bottom: 15px;">
        <label style="color: white; display: block; margin-bottom: 8px;">Deskripsi Perubahan:</label>
        <textarea id="changeDescription" style="width: 100%; height: 100px; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444; margin-bottom: 15px;"></textarea>
      </div>
    </div>
    
    <!-- Action Buttons -->
    <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
      <button id="adminPreviewBtn" style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
        Preview
      </button>
      <button id="adminSaveBtn" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
        Simpan Perubahan
      </button>
      <button id="adminCancelBtn" style="padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
        Batal
      </button>
    </div>
    
    <div id="adminStatus" style="margin-top: 20px; color: white; text-align: center; min-height: 20px; padding: 10px; border-radius: 4px;"></div>
  </div>
</div>

<!-- Overlay for admin form -->
<div id="adminOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000;"></div>

<!-- Button to toggle admin form -->
<button id="toggleAdminBtn" style="position: fixed; bottom: 30px; right: 30px; padding: 15px; background: #4CAF50; color: white; border: none; border-radius: 50%; cursor: pointer; z-index: 999; box-shadow: 0 2px 10px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 20h9"></path>
    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
  </svg>
</button>











<div class="bottom-line"></div>
    <div class="bottom-text">
      <!-- Link-link footer -->
      <div>
        <a href="#" class="tentangLink">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Tentang Kami
        </a>
      </div>
      <div>
        <a href="#" class="masukanLink">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Masukan
        </a>
      </div>
      <div>
        <a href="#" class="forumLink">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
          Forum Diskusi
        </a>
      </div>
    </div>
	
  </div>









<div id="page11" style="display: none;">
  <div class="dashboard-container">
    <!-- Header Dashboard -->
    <div class="dashboard-header">
      <h1 style="color: white; font-size: 28px; margin-bottom: 20px;">Dashboard Pengguna</h1>
      <div class="dashboard-notification-bell" id="notificationBell">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <span class="notification-badge" id="notificationBadge">0</span>
      </div>
    </div>

    <!-- Profil Pengguna -->
    <div class="dashboard-profile linebox">
      <div class="profile-header">
        <h2 class="title-box-white">Profil Saya</h2>
        <button id="editProfileBtn" class="edit-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 20h9"></path>
            <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
          </svg>
          Edit Profil
        </button>
      </div>
      
      <div class="profile-content">
        <div class="profile-picture-container">
          <img id="userProfilePicture" src="" alt="Foto Profil" class="profile-picture">
          <div class="profile-info">
            <h3 id="userDisplayName" style="color: white; margin-bottom: 5px;">Nama Pengguna</h3>
            <p id="userEmail" style="color: rgba(255,255,255,0.7); font-size: 14px;">email@contoh.com</p>
          </div>
        </div>
        
        <!-- Form Edit Profil (Awalnya tersembunyi) -->
        <div id="editProfileForm" style="display: none; margin-top: 20px;">
          <div style="margin-bottom: 15px;">
            <label style="color: white; display: block; margin-bottom: 5px;">Nama Tampilan</label>
            <input type="text" id="displayNameInput" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444;">
          </div>
          
          <div style="margin-bottom: 15px;">
            <label style="color: white; display: block; margin-bottom: 5px;">Link Media Sosial</label>
            <div class="social-links-container">
              <div class="social-link-input">
                <span class="social-icon">🔗</span>
                <input type="url" id="twitterInput" placeholder="Twitter" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444;">
              </div>
              <div class="social-link-input">
                <span class="social-icon">🔗</span>
                <input type="url" id="instagramInput" placeholder="Instagram" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444;">
              </div>
              <div class="social-link-input">
                <span class="social-icon">🔗</span>
                <input type="url" id="githubInput" placeholder="GitHub" style="width: 100%; padding: 8px; border-radius: 4px; background: #333; color: white; border: 1px solid #444;">
              </div>
            </div>
          </div>
          
          <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
            <button id="cancelEditBtn" class="cancel-btn">Batal</button>
            <button id="saveProfileBtn" class="save-btn">Simpan</button>
          </div>
        </div>
        
        <!-- Info Profil (Awalnya ditampilkan) -->
        <div id="profileInfo" style="margin-top: 20px;">
          <div class="profile-detail">
            <span class="detail-label">Bergabung sejak:</span>
            <span class="detail-value" id="joinDate">Januari 2023</span>
          </div>
          
          <div class="profile-detail">
            <span class="detail-label">Media Sosial:</span>
            <div class="social-links" id="socialLinks">
              <!-- Link media sosial akan dimuat di sini -->
              <span style="color: rgba(255,255,255,0.7);">Tidak ada link media sosial</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  
  <div class="dashboard-notifications linebox">
    <div class="notifications-header">
        <h2 class="title-box-white">Notifikasi</h2>
        <div class="notification-actions">
            <button id="markAllReadBtn" class="small-btn">Tandai Sudah Dibaca</button>
            <button id="notificationSettingsBtn" class="small-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
                Pengaturan
            </button>
        </div>
    </div>
    
    <div class="notifications-list" id="notificationsList">
        <div class="notification-loader">
            <div class="loader"></div>
            <p>Memuat notifikasi...</p>
        </div>
    </div>
</div>




<div class="dashboard-activity linebox">
    <h2 class="title-box-white">Aktivitas Terkini</h2>
    
    <div class="activity-tabs">
        <button class="activity-tab active" data-tab="all">Semua Aktivitas</button>
        <button class="activity-tab" data-tab="comments">Komentar & Balasan</button>
        <button class="activity-tab" data-tab="reactions">Reaksi</button>
        <button class="activity-tab" data-tab="posts">Postingan</button>
    </div>
    
    <div class="activity-content">
        <div class="activity-tab-content active" id="allActivity">
            <div class="activity-loader">
                <div class="loader"></div>
                <p>Memuat aktivitas...</p>
            </div>
        </div>
        <div class="activity-tab-content" id="commentsActivity">
            <div class="activity-loader">
                <div class="loader"></div>
                <p>Memuat komentar...</p>
            </div>
        </div>
        <div class="activity-tab-content" id="reactionsActivity">
            <div class="activity-loader">
                <div class="loader"></div>
                <p>Memuat reaksi...</p>
            </div>
        </div>
        <div class="activity-tab-content" id="postsActivity">
            <div class="activity-loader">
                <div class="loader"></div>
                <p>Memuat postingan...</p>
            </div>
        </div>
    </div>
</div>
  
  <!-- Modal Detail Aktivitas -->
<div id="activityDetailModal" class="modal" style="display:none;">
  <div class="modal-content linebox" style="max-width: 700px; margin: auto; background: #1e1e1e; color: white; border-radius: 12px;">
    
    <!-- Header Modal -->
    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding: 15px;">
      <h3 id="activityModalTitle" style="margin: 0; font-size: 20px;">Detail Aktivitas</h3>
      <button onclick="document.getElementById('activityDetailModal').style.display='none'" 
              style="background: none; border: none; color: white; font-size: 22px; cursor: pointer;">
        &times;
      </button>
    </div>

    <!-- Konten Modal -->
    <div id="activityModalContent" style="padding: 20px;">
      <div class="loader"></div>
      <p>Memuat detail...</p>
    </div>

    <!-- Footer Modal -->
    <div class="modal-footer" style="border-top: 1px solid #333; padding: 10px; text-align: right;">
      <button class="cancel-btn" onclick="document.getElementById('activityDetailModal').style.display='none'">Tutup</button>
    </div>

  </div>
</div>


<div class="dashboard-users linebox">
    <h2 class="title-box-white">Pengguna Lain</h2>
    
    <div class="users-search">
        <input type="text" id="userSearchInput" placeholder="Cari pengguna..." 
               style="width: 100%; padding: 10px; border-radius: 8px; background: #333; 
                      color: white; border: 1px solid #444; font-size: 14px;">
        <div class="search-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
        </div>
    </div>
    
    <div class="users-list" id="usersList">
        <div class="users-loader">
            <div class="loader"></div>
            <p>Memuat daftar pengguna...</p>
        </div>
    </div>
</div>


<!-- Messaging Section -->
<div class="dashboard-messages linebox">
  <div class="messages-header">
    <h2 class="title-box-white">Pesan</h2>
    <button id="newMessageBtn" class="edit-btn">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M12 5v14M5 12h14"></path>
      </svg>
      Pesan Baru
    </button>
  </div>
  
  <div class="messages-content">
    <div class="contacts-list" id="contactsList">
      <div class="loader">
        <div class="loader-spinner"></div>
        <p>Memuat kontak...</p>
      </div>
    </div>
    
    <div class="conversation-container" id="conversationContainer">
      <div class="no-conversation-selected">
        <p>Pilih kontak untuk melihat percakapan</p>
      </div>
    </div>
  </div>
</div>

<!-- Follow System Section -->
<div class="dashboard-follow linebox">
  <div class="follow-header">
    <h2 class="title-box-white">Hubungan</h2>
  </div>
  
  <div class="follow-stats">
    <div class="follow-stat">
      <span class="stat-number" id="followingCount">0</span>
      <span class="stat-label">Mengikuti</span>
    </div>
    <div class="follow-stat">
      <span class="stat-number" id="followersCount">0</span>
      <span class="stat-label">Pengikut</span>
    </div>
  </div>
  
  <div class="follow-lists">
    <div class="follow-list">
      <h3>Mengikuti</h3>
      <div class="list-container" id="followingList">
        <div class="loader">
          <div class="loader-spinner"></div>
          <p>Memuat daftar...</p>
        </div>
      </div>
    </div>
    
    <div class="follow-list">
      <h3>Pengikut</h3>
      <div class="list-container" id="followersList">
        <div class="loader">
          <div class="loader-spinner"></div>
          <p>Memuat daftar...</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- New Message Modal -->
<div id="newMessageModal" class="modal" style="display:none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Pesan Baru</h3>
      <span class="close-modal">&times;</span>
    </div>
    <div class="modal-body">
      <div class="search-container">
        <input type="text" id="recipientSearch" placeholder="Cari pengguna...">
      </div>
      <div class="user-list" id="messageRecipientList"></div>
    </div>
  </div>
</div>



  
    
    <!-- Tombol Kembali -->
    <div style="text-align: center; margin-top: 30px;">
      <button id="backFromDashboard" class="back-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Kembali
      </button>
    </div>
  </div>
  
  <!-- Modal Pengaturan Notifikasi -->
  <div id="notificationSettingsModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Pengaturan Notifikasi</h3>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="setting-item">
          <label class="switch">
            <input type="checkbox" id="emailNotifications" checked>
            <span class="slider round"></span>
          </label>
          <span>Notifikasi Email</span>
        </div>
        
        <div class="setting-item">
          <label class="switch">
            <input type="checkbox" id="pushNotifications" checked>
            <span class="slider round"></span>
          </label>
          <span>Notifikasi Push</span>
        </div>
        
        <div class="setting-item">
          <label class="switch">
            <input type="checkbox" id="activityNotifications" checked>
            <span class="slider round"></span>
          </label>
          <span>Notifikasi Aktivitas</span>
        </div>
        
        <div class="setting-item">
          <label class="switch">
            <input type="checkbox" id="announcementNotifications" checked>
            <span class="slider round"></span>
          </label>
          <span>Pengumuman</span>
        </div>
        
        <div class="setting-item">
          <label class="switch">
            <input type="checkbox" id="messageNotifications" checked>
            <span class="slider round"></span>
          </label>
          <span>Pesan</span>
        </div>
      </div>
      <div class="modal-footer">
        <button id="saveNotificationSettings" class="save-btn">Simpan</button>
        <button id="cancelNotificationSettings" class="cancel-btn">Batal</button>
      </div>
    </div>
  </div>
</div>
















<!-- Halaman 12 - Sponsor -->
<div id="page12" style="display:none;">
  <div id="dynamicText" style="margin-top: 50px; font-size: 40px; font-weight: bold; color: #ffffff; text-align: center;"></div>
  
  <h1 style="color: white; font-size: 28px; margin-bottom: 20px; margin-left: 180px;">Sponsor Kami</h1>
  
  <div class="line-box" style="flex-direction: column; align-items: center; gap: 40px; padding: 40px;">
    <!-- Video TikTok Utama (Besar) -->
    <div style="width: 100%; max-width: 500px; margin: 0 auto;">
      <h2 style="color: white; font-size: 24px; margin-bottom: 20px; text-align: center;">Video Sponsor Utama</h2>
      <div style="width: 100%;">
        <iframe 
          src="https://www.tiktok.com/embed/v2/7533829578503179526" 
          style="width: 100%; height: 700px; border: none; border-radius: 15px; overflow: hidden;"
          allowfullscreen
          scrolling="no"
          allow="encrypted-media;"
        ></iframe>
      </div>
    </div>
    
  
    <!-- Info Menjadi Sponsor -->
    <div style="background: rgba(255,255,255,0.05); border-radius: 15px; padding: 30px; max-width: 800px; text-align: center; margin-top: 50px;">
      <h2 style="color: white; font-size: 24px; margin-bottom: 15px;">Ingin Menjadi Sponsor?</h2>
      <p style="color: #ccc; font-size: 16px; line-height: 1.6; margin-bottom: 20px;">
        Dukung pengembangan konten kami dengan menjadi sponsor.
      </p>
      <button id="contactSponsorBtn" style="
        padding: 12px 25px;
        background: linear-gradient(135deg, #4ea1ff, #0066ff);
        border: none;
        border-radius: 10px;
        color: white;
        font-weight: bold;
        cursor: pointer;
        font-size: 16px;
      ">
        Hubungi Kami
      </button>
    </div>
  </div>
  
  <div class="bottom-line"></div>

  <div class="bottom-text">
    <div>
      <a href="#" class="tentangLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Tentang Kami
      </a>
    </div>
    <div>
      <a href="#" class="masukanLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Masukan
      </a>
    </div>
    <div>
      <a href="#" class="sponsorLink">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(45deg); margin-left: 8px;">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        Sponsor
      </a>
    </div>
  </div>

  <div class="nav-link">
    <a href="#" id="back-sponsor">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 5 5 12 12 19"></polyline>
      </svg>
      Kembali
    </a>
  </div>
</div>



















<script type="module" src="./dist/main.js">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getFirestore, collection, collectionGroup,  addDoc, onSnapshot, serverTimestamp, query, orderBy, deleteDoc, getDoc, writeBatch, setDoc, doc, updateDoc, where, getDocs, documentId, limit, increment, getCountFromServer, arrayUnion, 
    arrayRemove, deleteField, runTransaction, or, and, startAt, endAt } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInWithPopup, signOut, onAuthStateChanged, GoogleAuthProvider, setPersistence,
    browserLocalPersistence } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAzgMVdqZhrqQ3PqiSWapaCl6oglF3QP64",
        authDomain: "life-is-what-it-is-learn.firebaseapp.com",
        projectId: "life-is-what-it-is-learn",
        storageBucket: "life-is-what-it-is-learn.appspot.com",
        messagingSenderId: "755474876167",
        appId: "1:755474876167:web:205fb4ea8c7b8d5b66e7a2"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();
    const db = getFirestore(app);
	  const CONTENT_DOC_ID = 'page10_content';
    const ADMIN_EMAIL = "faridardiansyah061@gmail.com";
	const ADMIN_UID = "9k1G7CiLZWNCkadVn3m8ZZRaQwg1";



	






// Add this to your page11 script section

// Dashboard User Profile Visibility
async function setupUserProfileVisibility() {
  const editProfileBtn = document.getElementById('editProfileBtn');
  const editProfileForm = document.getElementById('editProfileForm');
  const cancelEditBtn = document.getElementById('cancelEditBtn');
  const saveProfileBtn = document.getElementById('saveProfileBtn');
  const profileInfo = document.getElementById('profileInfo');
  const displayNameInput = document.getElementById('displayNameInput');
  const twitterInput = document.getElementById('twitterInput');
  const instagramInput = document.getElementById('instagramInput');
  const githubInput = document.getElementById('githubInput');
  
  // Toggle edit profile form
  editProfileBtn.addEventListener('click', () => {
    profileInfo.style.display = 'none';
    editProfileForm.style.display = 'block';
    
    // Load current values
    const user = auth.currentUser;
    if (user) {
      getDoc(doc(db, 'users', user.uid)).then((docSnap) => {
        if (docSnap.exists()) {
          const data = docSnap.data();
          displayNameInput.value = data.displayName || '';
          twitterInput.value = data.socialLinks?.twitter || '';
          instagramInput.value = data.socialLinks?.instagram || '';
          githubInput.value = data.socialLinks?.github || '';
        }
      });
    }
  });
  
  cancelEditBtn.addEventListener('click', () => {
    profileInfo.style.display = 'block';
    editProfileForm.style.display = 'none';
  });
  
  // Save profile
  saveProfileBtn.addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) return;
    
    const displayName = displayNameInput.value.trim();
    const twitter = twitterInput.value.trim();
    const instagram = instagramInput.value.trim();
    const github = githubInput.value.trim();
    
    if (!displayName) {
      alert('Nama tampilan tidak boleh kosong');
      return;
    }
    
    try {
      // Update user profile in Firestore
      await setDoc(doc(db, 'users', user.uid), {
        displayName,
        socialLinks: {
          twitter: twitter || null,
          instagram: instagram || null,
          github: github || null
        },
        lastUpdated: serverTimestamp()
      }, { merge: true });
      
      // Update UI
      document.getElementById('userDisplayName').textContent = displayName;
      
      if (twitter || instagram || github) {
        let socialLinksHTML = '';
        if (twitter) socialLinksHTML += `<a href="${twitter}" target="_blank">Twitter</a> `;
        if (instagram) socialLinksHTML += `<a href="${instagram}" target="_blank">Instagram</a> `;
        if (github) socialLinksHTML += `<a href="${github}" target="_blank">GitHub</a>`;
        document.getElementById('socialLinks').innerHTML = socialLinksHTML;
      } else {
        document.getElementById('socialLinks').innerHTML = '<span style="color: rgba(255,255,255,0.7);">Tidak ada link media sosial</span>';
      }
      
      profileInfo.style.display = 'block';
      editProfileForm.style.display = 'none';
    } catch (error) {
      console.error('Error saving profile:', error);
      alert('Gagal menyimpan profil');
    }
  });
}

// Notification Settings
async function setupNotificationSettings() {
  const notificationSettingsBtn = document.getElementById('notificationSettingsBtn');
  const notificationSettingsModal = document.getElementById('notificationSettingsModal');
  const closeModal = document.querySelector('.close-modal');
  const saveNotificationSettings = document.getElementById('saveNotificationSettings');
  const cancelNotificationSettings = document.getElementById('cancelNotificationSettings');
  
  // Open modal
  notificationSettingsBtn.addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) return;
    
    // Load current settings
    const userDoc = await getDoc(doc(db, 'users', user.uid));
    if (userDoc.exists() && userDoc.data().notificationSettings) {
      const settings = userDoc.data().notificationSettings;
      document.getElementById('emailNotifications').checked = settings.email ?? true;
      document.getElementById('pushNotifications').checked = settings.push ?? true;
      document.getElementById('activityNotifications').checked = settings.activity ?? true;
      document.getElementById('announcementNotifications').checked = settings.announcement ?? true;
      document.getElementById('messageNotifications').checked = settings.message ?? true;
    }
    
    notificationSettingsModal.style.display = 'block';
  });
  
  // Close modal
  closeModal.addEventListener('click', () => {
    notificationSettingsModal.style.display = 'none';
  });
  
  cancelNotificationSettings.addEventListener('click', () => {
    notificationSettingsModal.style.display = 'none';
  });
  
  // Save settings
  saveNotificationSettings.addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) return;
    
    try {
      await updateDoc(doc(db, 'users', user.uid), {
        notificationSettings: {
          email: document.getElementById('emailNotifications').checked,
          push: document.getElementById('pushNotifications').checked,
          activity: document.getElementById('activityNotifications').checked,
          announcement: document.getElementById('announcementNotifications').checked,
          message: document.getElementById('messageNotifications').checked
        }
      });
      
      notificationSettingsModal.style.display = 'none';
      alert('Pengaturan notifikasi berhasil disimpan');
    } catch (error) {
      console.error('Error saving notification settings:', error);
      alert('Gagal menyimpan pengaturan notifikasi');
    }
  });
}

// Enhanced Notification System
async function setupNotifications() {
  const notificationsList = document.getElementById('notificationsList');
  const notificationBadge = document.getElementById('notificationBadge');
  const markAllReadBtn = document.getElementById('markAllReadBtn');
  
  let unsubscribeNotifications = null;
  
  onAuthStateChanged(auth, async (user) => {
    if (unsubscribeNotifications) {
      unsubscribeNotifications();
    }
    
    if (!user) {
      notificationsList.innerHTML = `
        <div class="notification-empty">
          <p>Silakan login untuk melihat notifikasi</p>
        </div>
      `;
      notificationBadge.textContent = '0';
      return;
    }
    
    // Load notifications
    unsubscribeNotifications = onSnapshot(
      query(
        collection(db, 'notifications'),
        where('userId', '==', user.uid),
        orderBy('timestamp', 'desc'),
        limit(50)
      ),
      async (snapshot) => {
        // Update badge count
        const unreadCount = snapshot.docs.filter(doc => !doc.data().read).length;
        notificationBadge.textContent = unreadCount.toString();
        
        if (snapshot.empty) {
          notificationsList.innerHTML = `
            <div class="notification-empty">
              <p>Tidak ada notifikasi</p>
            </div>
          `;
          return;
        }
        
        notificationsList.innerHTML = '';
        
        for (const doc of snapshot.docs) {
          const notification = doc.data();
          const notificationElement = document.createElement('div');
          notificationElement.className = `notification-item ${notification.read ? '' : 'unread'}`;
          notificationElement.dataset.id = doc.id;
          
          // Format notification message based on type
          let message = '';
          let icon = '';
          
          switch (notification.type) {
            case 'comment':
              message = `${notification.senderName} mengomentari ${notification.contentType === 'arduino-history' ? 'sejarah Arduino' : notification.contentType}`;
              icon = '💬';
              break;
            case 'reply':
              message = `${notification.senderName} membalas komentar Anda`;
              icon = '↩️';
              break;
            case 'like':
              message = `${notification.senderName} menyukai ${notification.contentType === 'arduino-history' ? 'sejarah Arduino Anda' : 'komen Anda'}`;
              icon = '❤️';
              break;
            case 'reaction':
              message = `${notification.senderName} bereaksi ${notification.content} pada ${notification.contentType === 'arduino-history' ? 'sejarah Arduino' : 'konten'}`;
              icon = notification.content;
              break;
            case 'follow':
              message = `${notification.senderName} mulai mengikuti Anda`;
              icon = '👤';
              break;
            case 'message':
              message = `${notification.senderName} mengirim pesan`;
              icon = '✉️';
              break;
            case 'announcement':
              message = `Pengumuman baru: ${notification.content}`;
              icon = '📢';
              break;
            default:
              message = notification.content;
              icon = '🔔';
          }
          
          notificationElement.innerHTML = `
            <div class="notification-icon">${icon}</div>
            <div class="notification-content">
              <p>${message}</p>
              <small>${formatTime(notification.timestamp)}</small>
            </div>
            ${!notification.read ? '<div class="notification-dot"></div>' : ''}
          `;
          
          // Mark as read when clicked
          notificationElement.addEventListener('click', async () => {
            if (!notification.read) {
              await updateDoc(doc.ref, { read: true });
            }
            
            // Handle navigation based on notification type
            if (notification.contentId) {
              switch (notification.contentType) {
                case 'arduino-history':
                  // Navigate to Arduino history with focus on the commented item
                  break;
                case 'discussion':
                  // Navigate to discussion
                  break;
                case 'feedback':
                  // Navigate to feedback
                  break;
              }
            }
          });
          
          notificationsList.appendChild(notificationElement);
        }
      }
    );
  });
  
  // Mark all as read
  markAllReadBtn.addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) return;
    
    try {
      // Get all unread notifications
      const q = query(
        collection(db, 'notifications'),
        where('userId', '==', user.uid),
        where('read', '==', false)
      );
      
      const snapshot = await getDocs(q);
      const batch = writeBatch(db);
      
      snapshot.forEach((doc) => {
        batch.update(doc.ref, { read: true });
      });
      
      await batch.commit();
    } catch (error) {
      console.error('Error marking notifications as read:', error);
    }
  });
}

// Enhanced Activity Feed
async function setupActivityFeed() {
  const activityTabs = document.querySelectorAll('.activity-tab');
  const allActivityTab = document.getElementById('allActivity');
  const commentsActivityTab = document.getElementById('commentsActivity');
  const reactionsActivityTab = document.getElementById('reactionsActivity');
  const postsActivityTab = document.getElementById('postsActivity');
  
  let unsubscribeActivities = null;
  
  // Tab switching
  activityTabs.forEach(tab => {
    tab.addEventListener('click', () => {
      activityTabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      document.querySelectorAll('.activity-tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      document.getElementById(`${tab.dataset.tab}Activity`).classList.add('active');
    });
  });
  
  onAuthStateChanged(auth, async (user) => {
    if (unsubscribeActivities) {
      unsubscribeActivities();
    }
    
    if (!user) {
      allActivityTab.innerHTML = `
        <div class="activity-empty">
          <p>Silakan login untuk melihat aktivitas</p>
        </div>
      `;
      return;
    }
    
    // Load activities
    unsubscribeActivities = onSnapshot(
      query(
        collection(db, 'activities'),
        where('userId', '==', user.uid),
        orderBy('timestamp', 'desc'),
        limit(50)
      ),
      async (snapshot) => {
        if (snapshot.empty) {
          allActivityTab.innerHTML = commentsActivityTab.innerHTML = 
            reactionsActivityTab.innerHTML = postsActivityTab.innerHTML = `
            <div class="activity-empty">
              <p>Tidak ada aktivitas</p>
            </div>
          `;
          return;
        }
        
        // Clear loaders
        allActivityTab.innerHTML = '';
        commentsActivityTab.innerHTML = '';
        reactionsActivityTab.innerHTML = '';
        postsActivityTab.innerHTML = '';
        
        // Categorize activities
        const allActivities = [];
        const commentActivities = [];
        const reactionActivities = [];
        const postActivities = [];
        
        for (const doc of snapshot.docs) {
          const activity = doc.data();
          allActivities.push(activity);
          
          // Format activity message
          let message = '';
          let icon = '';
          let category = '';
          
          switch (activity.type) {
            case 'comment':
              message = `Anda mengomentari ${activity.contentType === 'arduino-history' ? 'sejarah Arduino' : activity.contentType}`;
              icon = '💬';
              category = 'comments';
              break;
            case 'reply':
              message = `Anda membalas komentar di ${activity.contentType}`;
              icon = '↩️';
              category = 'comments';
              break;
            case 'like':
              message = `Anda menyukai ${activity.contentType === 'arduino-history' ? 'sejarah Arduino' : 'komentar'}`;
              icon = '❤️';
              category = 'comments';
              break;
            case 'reaction':
              message = `Anda bereaksi ${activity.emojiType} pada ${activity.contentType}`;
              icon = activity.emojiType;
              category = 'reactions';
              break;
            case 'post':
              message = `Anda membuat ${activity.contentType === 'arduino-history' ? 'sejarah Arduino baru' : 'postingan baru'}`;
              icon = '📝';
              category = 'posts';
              break;
            case 'follow':
              message = `Anda mulai mengikuti ${activity.targetUserName}`;
              icon = '👤';
              category = 'all';
              break;
            case 'message':
              message = `Anda mengirim pesan ke ${activity.targetUserName}`;
              icon = '✉️';
              category = 'all';
              break;
            default:
              message = activity.content || 'Aktivitas baru';
              icon = '🔔';
              category = 'all';
          }
          
          const activityElement = document.createElement('div');
          activityElement.className = 'activity-item';
          activityElement.innerHTML = `
            <div class="activity-icon">${icon}</div>
            <div class="activity-content">
              <p>${message}</p>
              <small>${formatTime(activity.timestamp)}</small>
            </div>
          `;
          
          // Add to appropriate tabs
          allActivityTab.appendChild(activityElement.cloneNode(true));
          
          if (category === 'comments' || activity.type === 'like' || activity.type === 'reply') {
            commentsActivityTab.appendChild(activityElement.cloneNode(true));
          } else if (category === 'reactions') {
            reactionsActivityTab.appendChild(activityElement.cloneNode(true));
          } else if (category === 'posts') {
            postsActivityTab.appendChild(activityElement.cloneNode(true));
          }
        }
      }
    );
  });
}





// 2. ENHANCED ACTIVITY FEED WITH DETAILS
async function setupEnhancedActivityFeed() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;

  // Realtime listener for activities
  onSnapshot(
    query(
      collection(db, 'activities'),
      where('userId', '==', currentUser.uid),
      orderBy('timestamp', 'desc')
    ),
    (snapshot) => {
      const allActivities = document.getElementById('allActivity');
      const commentActivities = document.getElementById('commentsActivity');
      const reactionActivities = document.getElementById('reactionsActivity');
      const postActivities = document.getElementById('postsActivity');

      // Clear existing content but keep headers
      [allActivities, commentActivities, reactionActivities, postActivities].forEach(container => {
        container.innerHTML = container.querySelector('h3')?.outerHTML || '';
      });

      snapshot.forEach(doc => {
        const activity = doc.data();
        const activityItem = createActivityItem(activity);
        
        // Add to all activities
        allActivities.appendChild(activityItem.cloneNode(true));
        
        // Categorize
        if (activity.type === 'comment' || activity.type === 'reply' || activity.type === 'like') {
          commentActivities.appendChild(activityItem.cloneNode(true));
        } else if (activity.type === 'reaction') {
          reactionActivities.appendChild(activityItem.cloneNode(true));
        } else if (activity.type === 'post' || activity.type === 'upload') {
          postActivities.appendChild(activityItem.cloneNode(true));
        }
      });

      // Handle empty states
      if (allActivities.children.length === 0) {
        allActivities.innerHTML = '<p>Tidak ada aktivitas</p>';
      }
      if (commentActivities.children.length === 0) {
        commentActivities.innerHTML = '<p>Tidak ada aktivitas komentar</p>';
      }
      if (reactionActivities.children.length === 0) {
        reactionActivities.innerHTML = '<p>Tidak ada aktivitas reaksi</p>';
      }
      if (postActivities.children.length === 0) {
        postActivities.innerHTML = '<p>Tidak ada aktivitas postingan</p>';
      }
    }
  );
}




function createActivityItem(activity) {
  const activityElement = document.createElement('div');
  activityElement.className = 'activity-item';
  
  let details = '';
  let icon = '🔔';
  
  switch (activity.type) {
    case 'comment':
      icon = '💬';
      details = `Anda mengomentari "${activity.content.substring(0, 30)}..." pada ${activity.contentType}`;
      break;
    case 'reply':
      icon = '↩️';
      details = `Anda membalas komentar "${activity.content.substring(0, 30)}..." pada ${activity.contentType}`;
      break;
    case 'like':
      icon = '❤️';
      details = `Anda menyukai ${activity.contentType} oleh ${activity.targetUserName}`;
      break;
    case 'reaction':
      icon = activity.emojiType;
      details = `Anda bereaksi ${activity.emojiType} pada ${activity.contentType} oleh ${activity.targetUserName}`;
      break;
    case 'post':
      icon = '📝';
      details = `Anda membuat postingan baru di ${activity.contentType}: "${activity.title}"`;
      break;
    case 'upload':
      icon = '📤';
      details = `Anda mengupload ${activity.contentType}: "${activity.title}"`;
      break;
    case 'follow':
      icon = '👥';
      details = `Anda mulai mengikuti ${activity.targetUserName}`;
      break;
    case 'message':
      icon = '✉️';
      details = `Anda mengirim pesan ke ${activity.targetUserName}: "${activity.content.substring(0, 30)}..."`;
      break;
  }

  activityElement.innerHTML = `
    <div class="activity-icon">${icon}</div>
    <div class="activity-content">
      <p>${details}</p>
      <small>${formatTime(activity.timestamp)}</small>
    </div>
  `;

  return activityElement;
}




// Helper functions
function formatTime(timestamp) {
    if (!timestamp) return 'Tidak diketahui';
    
    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
    const now = new Date();
    const diffInSeconds = Math.floor((now - date) / 1000);
    
    if (diffInSeconds < 60) return 'Baru saja';
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit lalu`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam lalu`;
    if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} hari lalu`;
    
    return date.toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'short',
        year: 'numeric'
    });
}

function formatDate(timestamp) {
    if (!timestamp) return 'Tidak diketahui';
    
    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
    return date.toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
    });
}



// 3. DETAILED NOTIFICATION SYSTEM
async function setupDetailedNotifications() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;

  onSnapshot(
    query(
      collection(db, 'notifications'),
      where('userId', '==', currentUser.uid),
      orderBy('timestamp', 'desc')
    ),
    (snapshot) => {
      const notificationsList = document.getElementById('notificationsList');
      notificationsList.innerHTML = '';

      snapshot.forEach(doc => {
        const notification = doc.data();
        const notificationItem = document.createElement('div');
        notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;
        
        let details = '';
        let icon = '🔔';
        
        switch (notification.type) {
          case 'comment':
            icon = '💬';
            details = `${notification.senderName} mengomentari ${notification.contentType} Anda: "${notification.content.substring(0, 30)}..."`;
            break;
          case 'reply':
            icon = '↩️';
            details = `${notification.senderName} membalas komentar Anda: "${notification.content.substring(0, 30)}..."`;
            break;
          case 'like':
            icon = '❤️';
            details = `${notification.senderName} menyukai ${notification.contentType} Anda`;
            break;
          case 'reaction':
            icon = notification.content;
            details = `${notification.senderName} bereaksi ${notification.content} pada ${notification.contentType} Anda`;
            break;
          case 'follow':
            icon = '👥';
            details = `${notification.senderName} mulai mengikuti Anda`;
            break;
          case 'message':
            icon = '✉️';
            details = `${notification.senderName} mengirim pesan: "${notification.content.substring(0, 30)}..."`;
            break;
        }

        notificationItem.innerHTML = `
          <div class="notification-icon">${icon}</div>
          <div class="notification-content">
            <p>${details}</p>
            <small>${formatTime(notification.timestamp)}</small>
          </div>
          ${!notification.read ? '<div class="notification-dot"></div>' : ''}
        `;

        notificationItem.addEventListener('click', async () => {
          if (!notification.read) {
            await updateDoc(doc.ref, { read: true });
          }
          // Handle navigation based on notification type
        });

        notificationsList.appendChild(notificationItem);
      });

      if (snapshot.empty) {
        notificationsList.innerHTML = '<p>Tidak ada notifikasi</p>';
      }
    }
  );
}











// Fungsi untuk melacak status online
async function setupPresenceTracking() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;
  
  const userRef = doc(db, 'users', currentUser.uid);
  
  // Update status to online
  await updateDoc(userRef, {
    isOnline: true,
    lastLogin: serverTimestamp()
  });
  
  // Update status when user goes offline
  const onClose = async () => {
    await updateDoc(userRef, {
      isOnline: false,
      lastLogin: serverTimestamp()
    });
  };
  
  // Handle different browser events
  window.addEventListener('beforeunload', onClose);
  window.addEventListener('pagehide', onClose);
  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') {
      onClose();
    } else {
      updateDoc(userRef, {
        isOnline: true,
        lastLogin: serverTimestamp()
      });
    }
  });
  
  return () => {
    window.removeEventListener('beforeunload', onClose);
    window.removeEventListener('pagehide', onClose);
    document.removeEventListener('visibilitychange', onClose);
    onClose();
  };
}

// Panggil fungsi ini saat user login
onAuthStateChanged(auth, async (user) => {
  if (user) {
    const cleanupPresence = await setupPresenceTracking();
    
    // Cleanup when component unmounts
    window.addEventListener('unload', cleanupPresence);
  }
});







// 4. LAST LOGIN TRACKING
async function trackUserPresence() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;

  // Update last login on initial load
  await updateDoc(doc(db, 'users', currentUser.uid), {
    lastLogin: serverTimestamp(),
    isOnline: true
  });

  // Update status when user goes offline
  window.addEventListener('beforeunload', async () => {
    await updateDoc(doc(db, 'users', currentUser.uid), {
      isOnline: false,
      lastLogin: serverTimestamp()
    });
  });
}







// Fungsi untuk memuat daftar pengguna
async function loadUsers(searchTerm = "") {
    const usersList = document.getElementById('usersList');
    const currentUser = auth.currentUser;
    
    if (!currentUser) {
        usersList.innerHTML = `
            <div class="no-users-found">
                <p>Silakan login untuk melihat pengguna lain</p>
            </div>
        `;
        return;
    }

    // Tampilkan loading state singkat
    usersList.innerHTML = `
        <div class="users-loader">
            <div class="loader"></div>
            <p>Memuat daftar pengguna...</p>
        </div>
    `;

    try {
        // Ambil semua dokumen user
        const usersRef = collection(db, 'users');
        const snapshot = await getDocs(usersRef);
        
        // Kumpulkan data user (kecuali diri sendiri)
        let usersData = [];
        snapshot.forEach(docSnap => {
            const userData = docSnap.data();
            if (userData.uid !== currentUser.uid) {
                usersData.push({
                    id: docSnap.id,
                    ...userData,
                    displayName: userData.displayName || userData.email?.split('@')[0] || 'Pengguna'
                });
            }
        });

        // Filter berdasarkan pencarian
        if (searchTerm.trim() !== "") {
            const searchLower = searchTerm.toLowerCase();
            usersData = usersData.filter(user => 
                user.displayName.toLowerCase().includes(searchLower) || 
                user.email?.toLowerCase().includes(searchLower)
            );
        }

        // Urutkan berdasarkan nama
        usersData.sort((a, b) => a.displayName.localeCompare(b.displayName));

        // Bersihkan tampilan
        usersList.innerHTML = '';
        
        if (usersData.length === 0) {
            usersList.innerHTML = `
                <div class="no-users-found">
                    <p>Tidak ada pengguna yang ditemukan</p>
                </div>
            `;
            return;
        }

        // Tampilkan daftar user
        usersData.forEach(user => {
            // Format tanggal bergabung
            const joinDate = user.joinDate 
                ? new Date(user.joinDate.seconds * 1000).toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' }) 
                : 'Tidak diketahui';

            // Format terakhir aktif
            const lastActive = user.lastActive 
                ? new Date(user.lastActive.seconds * 1000).toLocaleString('id-ID') 
                : 'Tidak diketahui';

            const userElement = document.createElement('div');
            userElement.classList.add('user-item');
            userElement.innerHTML = `
                <div class="user-info">
                    <strong>${user.displayName}</strong><br>
                    <small>${user.email || ''}</small><br>
                    <span>Tanggal Bergabung: ${joinDate}</span><br>
                    <span>Terakhir Aktif: ${lastActive}</span>
                </div>
            `;
            usersList.appendChild(userElement);
        });

    } catch (error) {
        console.error("Error loading users:", error);
        usersList.innerHTML = `
            <div class="error-message">
                <p>Gagal memuat daftar pengguna</p>
            </div>
        `;
    }
}



// Inisialisasi
document.addEventListener('DOMContentLoaded', () => {
    const userSearchInput = document.getElementById('userSearchInput');
    
    // Load users saat input berubah (dengan debounce)
    let searchTimeout;
    userSearchInput.addEventListener('input', (e) => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            loadUsers(e.target.value.trim());
        }, 300);
    });

    // Load data awal & update lastActive
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            // ✅ Update lastActive setiap kali user login
            try {
                await updateDoc(doc(db, 'users', user.uid), {
                    lastActive: serverTimestamp()
                });
            } catch (error) {
                console.error("Gagal memperbarui lastActive:", error);
            }

            // ✅ Muat daftar pengguna
            loadUsers();
        }
    });
});






// Variabel global
let currentConversation = null;
let unsubscribeContacts = null;
let unsubscribeMessages = null;






async function setupMessagingSystem() {
  const contactsList = document.getElementById('contactsList');
  const conversationContainer = document.getElementById('conversationContainer');
  const newMessageBtn = document.getElementById('newMessageBtn');
  const newMessageModal = document.getElementById('newMessageModal');
  const closeModal = document.querySelector('.close-modal');
  const recipientSearch = document.getElementById('recipientSearch');
  const messageRecipientList = document.getElementById('messageRecipientList');

  // Buka modal pesan baru
  newMessageBtn.addEventListener('click', () => {
    newMessageModal.style.display = 'flex';
    loadMessageRecipients();
  });

  // Tutup modal
  closeModal.addEventListener('click', () => {
    newMessageModal.style.display = 'none';
  });

  // Search recipients dengan debounce
  let searchTimeout;
  recipientSearch.addEventListener('input', (e) => {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => {
      loadMessageRecipients(e.target.value.trim());
    }, 300);
  });

  // Load kontak saat auth state berubah
  onAuthStateChanged(auth, (user) => {
    if (user) {
      loadContacts();
      setDoc(doc(db, 'userContacts', user.uid), { contacts: {} }, { merge: true });
    } else {
      contactsList.innerHTML = '<p>Silakan login untuk melihat pesan</p>';
      conversationContainer.innerHTML = '<div class="no-conversation-selected"><p>Silakan login untuk melihat percakapan</p></div>';
      
      if (unsubscribeContacts) unsubscribeContacts();
      if (unsubscribeMessages) unsubscribeMessages();
    }
  });




// Fungsi untuk memuat daftar penerima pesan
async function loadMessageRecipients(searchTerm = '') {
  const currentUser = auth.currentUser;
  if (!currentUser) return;
  
  messageRecipientList.innerHTML = '<div class="loader">Memuat pengguna...</div>';

  try {
    // Ambil semua pengguna
    const usersSnapshot = await getDocs(collection(db, 'users'));

    // Filter: hilangkan user yang sedang login
    let allUsers = usersSnapshot.docs.filter(doc => doc.id !== currentUser.uid);

    const searchLower = searchTerm.toLowerCase();
    const filteredUsers = allUsers
      .filter(doc => {
        const user = doc.data();
        const userName = (user.displayName || user.email.split('@')[0]).toLowerCase();
        const userEmail = user.email.toLowerCase();
        return userName.includes(searchLower) || userEmail.includes(searchLower);
      })
      .sort((a, b) => {
        const nameA = (a.data().displayName || a.data().email).toLowerCase();
        const nameB = (b.data().displayName || b.data().email).toLowerCase();
        return nameA.localeCompare(nameB);
      });

    messageRecipientList.innerHTML = '';

    if (filteredUsers.length === 0) {
      messageRecipientList.innerHTML = '<p>Tidak ada pengguna ditemukan</p>';
      return;
    }

    filteredUsers.forEach(doc => {
      const user = doc.data();
      const userItem = document.createElement('div');
      userItem.className = 'user-item';
      userItem.innerHTML = `
        <div class="user-avatar">${(user.displayName || user.email.split('@')[0]).substring(0, 2).toUpperCase()}</div>
        <div>
          <div class="user-name">${user.displayName || user.email.split('@')[0]}</div>
          <div class="user-email">${user.email}</div>
        </div>
      `;

      userItem.addEventListener('click', () => {
        newMessageModal.style.display = 'none';
        startConversation(doc.id, user.displayName || user.email.split('@')[0]);
      });

      messageRecipientList.appendChild(userItem);
    });
  } catch (error) {
    console.error('Error loading recipients:', error);
    messageRecipientList.innerHTML = '<p>Gagal memuat daftar pengguna</p>';
  }
}













  // Mulai percakapan baru
  function startConversation(userId, userName) {
    if (!userId) {
      console.error('Invalid userId:', userId);
      return;
    }
    
    currentConversation = userId;
    loadConversation(userId, userName);
    markMessagesAsRead(userId);
  }

 // Memuat percakapan
function loadConversation(userId, userName) {
  const currentUser = auth.currentUser;
  if (!currentUser || !userId) return;

  if (unsubscribeMessages) unsubscribeMessages();

  conversationContainer.innerHTML = `
    <div class="conversation-header">
      <div class="conversation-user">${userName}</div>
      <button class="follow-btn" id="followUserBtn" data-userid="${userId}">Ikuti</button>
    </div>
    <div class="messages-list" id="messagesList"></div>
    <div class="message-input-container">
      <input type="text" class="message-input" id="messageInput" placeholder="Ketik pesan...">
      <button class="send-message-btn" id="sendMessageBtn">Kirim</button>
    </div>
  `;

  // 🔹 Setup follow button (realtime)
  const followBtn = document.getElementById("followUserBtn");
  checkFollowStatusRealtime(userId, followBtn);

  followBtn.addEventListener("click", async () => {
    const isUnfollow = followBtn.classList.contains("unfollow-btn");
    try {
      if (isUnfollow) {
        await unfollowUser(userId);
      } else {
        await followUser(userId, userName);
      }
    } catch (error) {
      console.error("Error in follow operation:", error);
      alert("Operasi gagal: " + error.message);
    }
  });

  // 🔹 Load messages realtime
  const conversationId = [currentUser.uid, userId].sort().join("_");
  unsubscribeMessages = onSnapshot(
    query(
      collection(db, "conversations", conversationId, "messages"),
      orderBy("timestamp", "asc")
    ),
    (snapshot) => {
      const messagesList = document.getElementById("messagesList");
      messagesList.innerHTML = "";

      snapshot.forEach((doc) => {
        const message = doc.data();
        const messageElement = document.createElement("div");
        messageElement.className = `message-item ${
          message.senderId === currentUser.uid ? "message-sent" : "message-received"
        }`;

        messageElement.innerHTML = `
          <div class="message-bubble">${message.content}</div>
          <div class="message-time">
            ${formatTime(message.timestamp)}
            ${
              message.senderId === currentUser.uid
                ? `<span class="message-status ${message.read ? "read" : "sent"}">${
                    message.read ? "✓✓" : "✓"
                  }</span>`
                : ""
            }
          </div>
        `;

        messagesList.appendChild(messageElement);
      });

      messagesList.scrollTop = messagesList.scrollHeight;
    }
  );

  // 🔹 Setup kirim pesan
  document
    .getElementById("sendMessageBtn")
    .addEventListener("click", sendMessageHandler);
  document
    .getElementById("messageInput")
    .addEventListener("keypress", (e) => {
      if (e.key === "Enter") sendMessageHandler();
    });

  async function sendMessageHandler() {
    const content = document.getElementById("messageInput").value.trim();
    if (!content) return;

    try {
      if (!currentConversation) {
        throw new Error("Silakan pilih percakapan terlebih dahulu");
      }

      const conversationId = [currentUser.uid, currentConversation].sort().join("_");
      await sendMessage(conversationId, currentConversation, content);
      document.getElementById("messageInput").value = "";
    } catch (error) {
      console.error("Failed to send message:", error);
      alert("Gagal mengirim pesan: " + error.message);
    }
  }
}


 
 
 
 
 
 
 async function sendMessage(conversationId, recipientId, content) {
  const currentUser = auth.currentUser;
  if (!currentUser) {
    throw new Error("User not authenticated");
  }

  // Validasi input
  if (!conversationId || !recipientId || !content) {
    throw new Error("Missing required fields");
  }

  try {
    const messageData = {
      content: content,
      senderId: currentUser.uid,
      recipientId: recipientId,
      timestamp: serverTimestamp(),
      delivered: false,
      read: false
    };

    // Simpan pesan
    await addDoc(
      collection(db, 'conversations', conversationId, 'messages'),
      messageData
    );

    // Update kontak kedua belah pihak
    const batch = writeBatch(db);
    
    // Update kontak pengirim
    batch.set(
      doc(db, 'userContacts', currentUser.uid),
      {
        [`contacts.${recipientId}`]: {
          lastMessage: content,
          lastMessageTime: serverTimestamp(),
          unreadCount: 0
        }
      },
      { merge: true }
    );
    
    // Update kontak penerima
    batch.set(
      doc(db, 'userContacts', recipientId),
      {
        [`contacts.${currentUser.uid}`]: {
          lastMessage: content,
          lastMessageTime: serverTimestamp(),
          unreadCount: increment(1)
        }
      },
      { merge: true }
    );

    await batch.commit();
    
    return true;
  } catch (error) {
    console.error("Error sending message:", error);
    throw error;
  }
}
 
 
 
 
 
 
 
 async function loadContacts() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;

  if (unsubscribeContacts) unsubscribeContacts();

  const contactsList = document.getElementById("contactsList");
  contactsList.innerHTML = '<div class="loader">Memuat kontak...</div>';

  const userContactsRef = doc(db, "userContacts", currentUser.uid);
  unsubscribeContacts = onSnapshot(userContactsRef, async (docSnap) => {
    contactsList.innerHTML = "";

    if (!docSnap.exists()) {
      contactsList.innerHTML = "<p>Tidak ada kontak</p>";
      return;
    }

    const contactsData = docSnap.data().contacts || {};
    const contactIds = Object.keys(contactsData);

    if (contactIds.length === 0) {
      contactsList.innerHTML = "<p>Tidak ada percakapan</p>";
      return;
    }

    for (const userId of contactIds) {
      try {
        // 🔹 Ambil data user
        const userDoc = await getDoc(doc(db, "users", userId));
        if (!userDoc.exists()) continue;
        const user = userDoc.data();

        // 🔹 Ambil pesan terakhir dari subkoleksi messages
        const conversationId = [currentUser.uid, userId].sort().join("_");
        const messagesRef = collection(db, "conversations", conversationId, "messages");
        const lastMsgQuery = query(messagesRef, orderBy("timestamp", "desc"), limit(1));
        const lastMsgSnap = await getDocs(lastMsgQuery);

        let lastMessage = "Belum ada pesan";
        let lastMessageTime = null;
        if (!lastMsgSnap.empty) {
          const msgData = lastMsgSnap.docs[0].data();
          lastMessage = msgData.content;
          lastMessageTime = msgData.timestamp ? formatTime(msgData.timestamp.toDate()) : "";
        }

        // 🔹 Render kontak
        const contactItem = document.createElement("div");
        contactItem.className = "contact-item";
        contactItem.innerHTML = `
          <div class="contact-info">
            <div class="contact-avatar">${(user.displayName || user.email).substring(0,2).toUpperCase()}</div>
            <div>
              <div class="contact-name">${user.displayName || user.email}</div>
              <div class="contact-last-message">${lastMessage}</div>
            </div>
          </div>
          <div class="contact-meta">
            <span class="last-message-time">${lastMessageTime || ""}</span>
          </div>
        `;

        contactItem.addEventListener("click", () => {
          startConversation(userId, user.displayName || user.email);
        });

        contactsList.appendChild(contactItem);
      } catch (error) {
        console.error("Error loading contact:", error);
      }
    }
  }, (err) => {
    console.error("Error listening contacts:", err);
    contactsList.innerHTML = "<p>Gagal memuat kontak</p>";
  });
}

 
 
 
 
 
 
 
 
 
 
 
 





  // Tandai pesan sebagai sudah dibaca
  async function markMessagesAsRead(userId) {
    const currentUser = auth.currentUser;
    if (!currentUser || !userId) return;
    
    const conversationId = [currentUser.uid, userId].sort().join('_');
    
    try {
      const q = query(
        collection(db, 'conversations', conversationId, 'messages'),
        where('recipientId', '==', currentUser.uid),
        where('read', '==', false)
      );
      
      const snapshot = await getDocs(q);
      const batch = writeBatch(db);
      
      snapshot.forEach(doc => {
        batch.update(doc.ref, { read: true });
      });
      
      if (snapshot.size > 0) {
        await batch.commit();
        await updateDoc(doc(db, 'userContacts', currentUser.uid), {
          [`contacts.${userId}.unreadCount`]: 0
        }, { merge: true });
      }
    } catch (error) {
      console.error('Error marking messages as read:', error);
    }
  }
}






// Global cache following
let currentFollowing = {};
let unsubscribeFollowingRealtime = null;

// Listener realtime untuk following
function startFollowingListener() {
  const currentUser = auth.currentUser;
  if (!currentUser) return;

  if (unsubscribeFollowingRealtime) unsubscribeFollowingRealtime(); // stop listener lama

  const userRef = doc(db, "userFollows", currentUser.uid);
  unsubscribeFollowingRealtime = onSnapshot(userRef, (snap) => {
    const data = snap.data() || {};
    currentFollowing = data.following || {};

    // update semua tombol follow
    document.querySelectorAll(".follow-btn").forEach(btn => {
      const targetId = btn.dataset.userid;
      if (currentFollowing[targetId]) {
        btn.textContent = "Berhenti Mengikuti";
        btn.classList.add("unfollow-btn");
      } else {
        btn.textContent = "Ikuti";
        btn.classList.remove("unfollow-btn");
      }
    });
  });
}

// jalankan setelah login
onAuthStateChanged(auth, (user) => {
  if (user) startFollowingListener();
});




function startFollowRelationListener(userId) {
  const userRef = doc(db, "userFollows", userId);

  onSnapshot(userRef, async (snap) => {
    const data = snap.data() || {};
    const followingIds = Object.keys(data.following || {});
    const followerIds = Object.keys(data.followers || {});

    document.getElementById("followingCount").textContent = followingIds.length;
    document.getElementById("followersCount").textContent = followerIds.length;

    // render daftar mengikuti
    renderUserList("followingList", followingIds, true);
    // render daftar pengikut
    renderUserList("followersList", followerIds, false);
  });
}



async function renderUserList(containerId, ids, showUnfollow) {
  const container = document.getElementById(containerId);
  container.innerHTML = "";

  if (ids.length === 0) {
    container.innerHTML = "<p>Tidak ada data</p>";
    return;
  }

  // Ambil user satu per satu biar aman (>10 id juga bisa)
  const userDocs = await Promise.all(ids.map(uid => getDoc(doc(db, "users", uid))));

  userDocs.forEach(docSnap => {
    if (!docSnap.exists()) return;
    const user = docSnap.data();

    const item = document.createElement("div");
    item.className = "follow-user-item";
    item.innerHTML = `
      <div class="follow-user-avatar">${(user.displayName || user.email).substring(0,2).toUpperCase()}</div>
      <div class="follow-user-name">${user.displayName || user.email}</div>
      ${showUnfollow ? `<button class="follow-btn unfollow-btn" data-userid="${user.uid}">Berhenti Mengikuti</button>` : ""}
    `;

    if (showUnfollow) {
      item.querySelector("button").addEventListener("click", () => unfollowUser(user.uid));
    }
    container.appendChild(item);
  });
}






async function setupFollowSystem() {
  const followingCount = document.getElementById('followingCount');
  const followersCount = document.getElementById('followersCount');
  const followingList = document.getElementById('followingList');
  const followersList = document.getElementById('followersList');
  
  let unsubscribeFollowing = null;
  let unsubscribeFollowers = null;
  
  // Load follow data
  function loadFollowData(userId) {
    if (unsubscribeFollowing) unsubscribeFollowing();
    if (unsubscribeFollowers) unsubscribeFollowers();
    
    // Following
    unsubscribeFollowing = onSnapshot(doc(db, 'userFollows', userId), (doc) => {
      const data = doc.data();
      const following = data?.following || {};
      const followingIds = Object.keys(following);
      
      followingCount.textContent = followingIds.length;
      
      if (followingIds.length === 0) {
        followingList.innerHTML = '<p>Belum mengikuti siapapun</p>';
      } else {
        getDocs(query(
          collection(db, 'users'),
          where('uid', 'in', followingIds)
        )).then(snapshot => {
          followingList.innerHTML = '';
          
          snapshot.forEach(userDoc => {
            const user = userDoc.data();
            const followItem = document.createElement('div');
            followItem.className = 'follow-user-item';
            followItem.innerHTML = `
              <div class="follow-user-avatar">${(user.displayName || user.email.split('@')[0]).substring(0, 2).toUpperCase()}</div>
              <div class="follow-user-name">${user.displayName || user.email.split('@')[0]}</div>
              <button class="follow-btn unfollow-btn" data-userid="${user.uid}">Berhenti Mengikuti</button>
            `;
            
            followItem.querySelector('button').addEventListener('click', () => {
              unfollowUser(user.uid);
            });
            
            followingList.appendChild(followItem);
          });
        });
      }
    });
    
    // Followers
    unsubscribeFollowers = onSnapshot(doc(db, 'userFollows', userId), (doc) => {
      const data = doc.data();
      const followers = data?.followers || {};
      const followerIds = Object.keys(followers);
      
      followersCount.textContent = followerIds.length;
      
      if (followerIds.length === 0) {
        followersList.innerHTML = '<p>Belum memiliki pengikut</p>';
      } else {
        getDocs(query(
          collection(db, 'users'),
          where('uid', 'in', followerIds)
        )).then(snapshot => {
          followersList.innerHTML = '';
          
          snapshot.forEach(userDoc => {
            const user = userDoc.data();
            const followItem = document.createElement('div');
            followItem.className = 'follow-user-item';
            
            const isFollowing = data?.following?.[user.uid] || false;
            
            followItem.innerHTML = `
              <div class="follow-user-avatar">${(user.displayName || user.email.split('@')[0]).substring(0, 2).toUpperCase()}</div>
              <div class="follow-user-name">${user.displayName || user.email.split('@')[0]}</div>
              <button class="follow-btn ${isFollowing ? 'unfollow-btn' : ''}" data-userid="${user.uid}">
                ${isFollowing ? 'Berhenti Mengikuti' : 'Ikuti'}
              </button>
            `;
            
            followItem.querySelector('button').addEventListener('click', async () => {
              try {
                if (isFollowing) {
                  await unfollowUser(user.uid);
                } else {
                  await followUser(user.uid, user.displayName || user.email.split('@')[0]);
                }
              } catch (error) {
                console.error('Error in follow operation:', error);
                alert('Operasi gagal: ' + error.message);
              }
            });
            
            followersList.appendChild(followItem);
          });
        });
      }
    });
  }
  
  // Initialize
  onAuthStateChanged(auth, (user) => {
    if (user) {
      
	  startFollowRelationListener(user.uid);
      setDoc(doc(db, 'userFollows', user.uid), {
        following: {},
        followers: {}
      }, { merge: true });
    } else {
      followingCount.textContent = '0';
      followersCount.textContent = '0';
      followingList.innerHTML = '<p>Silakan login untuk melihat daftar</p>';
      followersList.innerHTML = '<p>Silakan login untuk melihat daftar</p>';
    }
  });
}










// Follow
async function followUser(targetUserId, targetUserData) {
  const currentUser = auth.currentUser;
  if (!currentUser || currentUser.uid === targetUserId) return; // tidak bisa follow diri sendiri

  const currentUserRef = doc(db, "userFollows", currentUser.uid);
  const targetUserRef = doc(db, "userFollows", targetUserId);

  try {
    await runTransaction(db, async (transaction) => {
      // ambil snapshot
      const currentSnap = await transaction.get(currentUserRef);
      const targetSnap = await transaction.get(targetUserRef);

      // data default
      const currentData = currentSnap.exists() ? currentSnap.data() : { following: {}, followers: {} };
      const targetData = targetSnap.exists() ? targetSnap.data() : { following: {}, followers: {} };

      // update following user saat ini
      currentData.following[targetUserId] = {
        uid: targetUserId,
        displayName: targetUserData.displayName || "",
        photoURL: targetUserData.photoURL || "",
        createdAt: serverTimestamp(),
      };

      // update followers user target
      targetData.followers[currentUser.uid] = {
        uid: currentUser.uid,
        displayName: currentUser.displayName || "",
        photoURL: currentUser.photoURL || "",
        createdAt: serverTimestamp(),
      };

      transaction.set(currentUserRef, currentData, { merge: true });
      transaction.set(targetUserRef, targetData, { merge: true });
    });

    console.log("Berhasil mengikuti:", targetUserId);
  } catch (err) {
    console.error("Gagal follow:", err);
  }
}

// Unfollow
async function unfollowUser(targetUserId) {
  const currentUser = auth.currentUser;
  if (!currentUser || currentUser.uid === targetUserId) return;

  const currentUserRef = doc(db, "userFollows", currentUser.uid);
  const targetUserRef = doc(db, "userFollows", targetUserId);

  try {
    await runTransaction(db, async (transaction) => {
      const currentSnap = await transaction.get(currentUserRef);
      const targetSnap = await transaction.get(targetUserRef);

      if (!currentSnap.exists() || !targetSnap.exists()) return;

      const currentData = currentSnap.data();
      const targetData = targetSnap.data();

      // hapus dari following
      delete currentData.following[targetUserId];
      // hapus dari followers
      delete targetData.followers[currentUser.uid];

      transaction.set(currentUserRef, currentData, { merge: true });
      transaction.set(targetUserRef, targetData, { merge: true });
    });

    console.log("Berhenti mengikuti:", targetUserId);
  } catch (err) {
    console.error("Gagal unfollow:", err);
  }
}


















// Global supaya bisa unsubscribe listener kalau perlu
let unsubscribeFollowStatus = null;

function checkFollowStatusRealtime(targetUserId, followBtn) {
  const currentUser = auth.currentUser;
  if (!currentUser || !targetUserId || !followBtn) return;

  // stop listener lama kalau ada
  if (unsubscribeFollowStatus) unsubscribeFollowStatus();

  const userRef = doc(db, "userFollows", currentUser.uid);
  unsubscribeFollowStatus = onSnapshot(userRef, (snap) => {
    const data = snap.data() || {};
    const isFollowing = !!data.following?.[targetUserId];

    if (isFollowing) {
      followBtn.textContent = "Berhenti Mengikuti";
      followBtn.classList.add("unfollow-btn");
    } else {
      followBtn.textContent = "Ikuti";
      followBtn.classList.remove("unfollow-btn");
    }
  }, (err) => {
    console.error("Error follow status listener:", err);
  });
}












// Jalankan sistem saat halaman dimuat
document.addEventListener('DOMContentLoaded', () => {
  setupMessagingSystem();
  setupFollowSystem();
  
  // Format tanggal bergabung
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      const userDoc = await getDoc(doc(db, 'users', user.uid));
      if (userDoc.exists()) {
        const joinDate = userDoc.data().joinDate?.toDate();
        if (joinDate) {
          document.getElementById('joinDate').textContent = 
            joinDate.toLocaleDateString('id-ID', { month: 'long', year: 'numeric' });
        }
      }
    }
  });
});







// Initialize all dashboard components
function initializeEnhancedDashboard() {
  setupUserProfileVisibility();
  setupNotificationSettings();
  setupNotifications();
  setupActivityFeed();
  setupDetailedNotifications();
  setupEnhancedActivityFeed();
  trackUserPresence();
   setupMessagingSystem(); // Add this
  setupFollowSystem(); // Add this
      
	  


  
  // Load user profile data on auth state change
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      // Load user profile
      const userDoc = await getDoc(doc(db, 'users', user.uid));
      if (userDoc.exists()) {
        const userData = userDoc.data();
        
        // Update profile display
        document.getElementById('userDisplayName').textContent = userData.displayName || user.displayName || 'Pengguna';
        document.getElementById('userEmail').textContent = user.email;
        
        if (userData.photoURL) {
          document.getElementById('userProfilePicture').src = userData.photoURL;
        }
        
        // Format join date
        if (userData.joinDate) {
          const joinDate = userData.joinDate.toDate();
          document.getElementById('joinDate').textContent = joinDate.toLocaleDateString('id-ID', {
            month: 'long',
            year: 'numeric'
          });
        }
        
        // Display social links
        if (userData.socialLinks) {
          let socialLinksHTML = '';
          if (userData.socialLinks.twitter) {
            socialLinksHTML += `<a href="${userData.socialLinks.twitter}" target="_blank">Twitter</a> `;
          }
          if (userData.socialLinks.instagram) {
            socialLinksHTML += `<a href="${userData.socialLinks.instagram}" target="_blank">Instagram</a> `;
          }
          if (userData.socialLinks.github) {
            socialLinksHTML += `<a href="${userData.socialLinks.github}" target="_blank">GitHub</a>`;
          }
          document.getElementById('socialLinks').innerHTML = socialLinksHTML || 
            '<span style="color: rgba(255,255,255,0.7);">Tidak ada link media sosial</span>';
        }
      }
      
      // Update last login time
      await updateDoc(doc(db, 'users', user.uid), {
        lastLogin: serverTimestamp()
      }, { merge: true });
    }
  });
  
  // Back button functionality
  document.getElementById('backFromDashboard').addEventListener('click', () => {
    // Implement navigation back to previous page
  });
}


// Call this when page11 is loaded
initializeEnhancedDashboard();

























async function createActivityNotification(
  recipientId,
  type,
  senderId,
  senderName,
  content,
  contentType,
  contentId
) {
  try {
    await addDoc(collection(db, "notifications"), {
      userId: recipientId,
      type,
      senderId,
      senderName,
      content,
      contentType,
      contentId,
      read: false,
      timestamp: serverTimestamp()
    });
  } catch (error) {
    console.error("Gagal membuat notifikasi:", error);
  }
}













// Fungsi untuk mengelola komentar dengan notifikasi terintegrasi
function setupComments() {
  const commentsCollection = collection(db, "arduinoHistoryComments");
  const commentsList = document.getElementById("commentsList");
  const commentInput = document.getElementById("commentInput");
  const submitComment = document.getElementById("submitComment");
  const filterButtons = document.querySelectorAll(".filter-btn");
  const totalCommentsSpan = document.getElementById("totalComments");
  const newCommentsSpan = document.getElementById("newComments");
  const oldCommentsSpan = document.getElementById("oldComments");
  
  let currentFilter = "all";
  let commentsData = [];
  let commentCounts = { total: 0, new: 0, old: 0 };
  
  // Format waktu untuk ditampilkan
  function formatTime(timestamp) {
    const now = new Date();
    let commentDate;

    if (!timestamp) return "waktu tidak tersedia";
    if (typeof timestamp.toDate === "function") {
      commentDate = timestamp.toDate();
    } else if (timestamp instanceof Date) {
      commentDate = timestamp;
    } else {
      commentDate = new Date(timestamp);
    }

    const diffInSeconds = Math.floor((now - commentDate) / 1000);

    if (diffInSeconds < 60) return "baru saja";
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit lalu`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam lalu`;
    if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} hari lalu`;

    return commentDate.toLocaleDateString("id-ID", {
      day: "numeric",
      month: "long",
      year: "numeric"
    });
  }

  // Cek apakah komentar termasuk baru (≤ 7 hari)
  function isNewComment(timestamp) {
    if (!timestamp) return false;
    const now = new Date();
    const commentDate = (timestamp.toDate && typeof timestamp.toDate === 'function')
      ? timestamp.toDate()
      : new Date(timestamp);
    const diffInDays = Math.floor((now - commentDate) / (1000 * 60 * 60 * 24));
    return diffInDays <= 7;
  }

  // Fungsi untuk render komentar
  async function renderComments() {
    commentsList.innerHTML = "";
    commentCounts = { total: 0, new: 0, old: 0 };
    
    // Filter komentar berdasarkan kategori
    const filteredComments = commentsData.filter(comment => {
      if (currentFilter === "all") return true;
      if (currentFilter === "new") return isNewComment(comment.timestamp);
      if (currentFilter === "old") return !isNewComment(comment.timestamp);
      return true;
    });
    
    // Urutkan dari yang terbaru
    filteredComments.sort((a, b) => {
      const timeA = a.timestamp?.toDate ? a.timestamp.toDate().getTime() : new Date(a.timestamp).getTime();
      const timeB = b.timestamp?.toDate ? b.timestamp.toDate().getTime() : new Date(b.timestamp).getTime();
      return timeB - timeA;
    });
    
    // Render setiap komentar
    for (const comment of filteredComments) {
      const isNew = isNewComment(comment.timestamp);
      if (isNew) commentCounts.new++;
      else commentCounts.old++;
      commentCounts.total++;
      
      const commentElement = document.createElement("div");
      commentElement.className = "comment-item";
      commentElement.dataset.id = comment.id;
      
      // Dapatkan data pengguna untuk avatar
      let userName = "Pengguna";
      let userInitials = "P";
      try {
        if (comment.userId) {
          const userDoc = await getDoc(doc(db, "users", comment.userId));
          if (userDoc.exists()) {
            userName = userDoc.data().displayName || comment.userName || userDoc.data().email.split("@")[0] || "Pengguna";
          } else {
            userName = comment.userName || "Pengguna";
          }
        } else {
          userName = comment.userName || "Pengguna";
        }
        userInitials = userName.split(" ").map(n => n[0]).join("").substring(0, 2).toUpperCase();
      } catch (error) {
        console.error("Error fetching user data:", error);
      }
      
      commentElement.innerHTML = `
        <div class="comment-header">
          <div class="comment-avatar">${userInitials}</div>
          <div class="comment-user">${userName}</div>
          <div class="comment-time">${formatTime(comment.timestamp)}</div>
          ${isNew ? '<span class="new-badge">BARU</span>' : ''}
        </div>
        <div class="comment-content">${comment.content}</div>
        <div class="comment-actions">
          <div class="comment-action reply-btn" data-id="${comment.id}">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            Balas
          </div>
          <div class="comment-action like-btn" data-id="${comment.id}">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
            </svg>
            <span class="like-count">${comment.likes || 0}</span>
          </div>
        </div>
        <div class="reply-form" id="replyForm-${comment.id}">
          <textarea placeholder="Tulis balasan Anda..." rows="2"></textarea>
          <button class="reply-submit-btn" data-id="${comment.id}">Kirim Balasan</button>
        </div>
        ${comment.replies && comment.replies.length > 0 ? `
          <div class="replies-container" id="replies-${comment.id}">
            ${(await Promise.all(comment.replies.map(async reply => {
              let replyUserName = reply.userName || "Pengguna";
              let replyInitials = replyUserName.split(" ").map(n => n[0]).join("").substring(0, 2).toUpperCase();
              
              try {
                if (reply.userId) {
                  const replyUserDoc = await getDoc(doc(db, "users", reply.userId));
                  if (replyUserDoc.exists()) {
                    replyUserName = replyUserDoc.data().displayName || reply.userName || replyUserDoc.data().email.split("@")[0] || "Pengguna";
                    replyInitials = replyUserName.split(" ").map(n => n[0]).join("").substring(0, 2).toUpperCase();
                  }
                }
              } catch (error) {
                console.error("Error fetching reply user data:", error);
              }
              
              return `
                <div class="comment-item reply-item" data-id="${reply.id}" data-parent="${comment.id}">
                  <div class="comment-header">
                    <div class="comment-avatar">${replyInitials}</div>
                    <div class="comment-user">${replyUserName}</div>
                    <div class="comment-time">${formatTime(reply.timestamp)}</div>
                    ${isNewComment(reply.timestamp) ? '<span class="new-badge">BARU</span>' : ''}
                  </div>
                  <div class="comment-content">${reply.content}</div>
                  <div class="comment-actions">
                    <div class="comment-action like-btn" data-id="${reply.id}" data-parent="${comment.id}">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                      </svg>
                      <span class="like-count">${reply.likes || 0}</span>
                    </div>
                  </div>
                </div>
              `;
            }))).join("")}
          </div>
        ` : ''}
      `;
      
      commentsList.appendChild(commentElement);
    }
    
    // Update counter
    totalCommentsSpan.textContent = commentCounts.total;
    newCommentsSpan.textContent = commentCounts.new;
    oldCommentsSpan.textContent = commentCounts.old;
    
    // Setup event listeners untuk tombol balas
    document.querySelectorAll(".reply-btn").forEach(btn => {
      btn.addEventListener("click", function() {
        const commentId = this.dataset.id;
        const replyForm = document.getElementById(`replyForm-${commentId}`);
        replyForm.classList.toggle("active");
        
        // Auto-focus textarea ketika form dibuka
        if (replyForm.classList.contains("active")) {
          replyForm.querySelector("textarea").focus();
        }
      });
    });
    
    // Setup event listeners untuk tombol kirim balasan
    document.querySelectorAll(".reply-submit-btn").forEach(btn => {
      btn.addEventListener("click", async function() {
        const commentId = this.dataset.id;
        const replyForm = document.getElementById(`replyForm-${commentId}`);
        const textarea = replyForm.querySelector("textarea");
        const content = textarea.value.trim();
        
        if (!content) {
          alert("Balasan tidak boleh kosong");
          return;
        }
        
        const user = auth.currentUser;
        if (!user) {
          alert("Anda harus login untuk membalas komentar");
          return;
        }
        
        // Dapatkan data pengguna
        let userName = "Pengguna";
        try {
          const userDoc = await getDoc(doc(db, "users", user.uid));
          if (userDoc.exists()) {
            userName = userDoc.data().displayName || user.email.split("@")[0];
          } else {
            userName = user.email.split("@")[0];
          }
        } catch (error) {
          console.error("Error getting user data:", error);
          userName = user.email.split("@")[0];
        }
        
        // Buat data balasan
      const replyData = {
  id: doc(commentsCollection).id,
  content,
  userName,
  userId: user.uid,
  likes: 0,
  timestamp: new Date() // ✅ timestamp yang valid untuk arrayUnion
};

        
        try {
          // Tambahkan balasan ke Firestore
          await updateDoc(doc(commentsCollection, commentId), {
            replies: arrayUnion(replyData),
            lastUpdated: serverTimestamp()
          });
          
          // Dapatkan komentar induk untuk notifikasi
          const parentComment = commentsData.find(c => c.id === commentId);
          if (parentComment && parentComment.userId !== user.uid) {
            // Kirim notifikasi ke pemilik komentar
            await createActivityNotification(
              parentComment.userId,
              "reply",
              user.uid,
              userName,
              content,
              "arduino-history",
              commentId
            );
          }
          
          textarea.value = "";
          replyForm.classList.remove("active");
        } catch (error) {
          console.error("Error adding reply:", error);
          alert("Gagal mengirim balasan");
        }
      });
    });
    
    // Setup event listeners untuk tombol like
    document.querySelectorAll(".like-btn").forEach(btn => {
      btn.addEventListener("click", async function() {
        const commentId = this.dataset.id;
        const parentId = this.dataset.parent;
        const user = auth.currentUser;
        
        if (!user) {
          alert("Anda harus login untuk menyukai komentar");
          return;
        }
        
        try {
          if (parentId) {
            // Like pada balasan
            const commentRef = doc(commentsCollection, parentId);
            await runTransaction(db, async (transaction) => {
              const commentDoc = await transaction.get(commentRef);
              const replies = commentDoc.data().replies || [];
              const replyIndex = replies.findIndex(r => r.id === commentId);
              
              if (replyIndex === -1) return;
              
              const updatedReplies = [...replies];
              updatedReplies[replyIndex] = {
                ...updatedReplies[replyIndex],
                likes: (updatedReplies[replyIndex].likes || 0) + 1
              };
              
              transaction.update(commentRef, { replies: updatedReplies });
              
              // Kirim notifikasi like untuk balasan
              const repliedComment = updatedReplies[replyIndex];
              if (repliedComment.userId && repliedComment.userId !== user.uid) {
                await createActivityNotification(
                  repliedComment.userId,
                  "like",
                  user.uid,
                  user.displayName || user.email.split("@")[0],
                  "",
                  "arduino-history",
                  parentId
                );
              }
            });
          } else {
            // Like pada komentar utama
            const commentRef = doc(commentsCollection, commentId);
            await runTransaction(db, async (transaction) => {
              const commentDoc = await transaction.get(commentRef);
              const currentLikes = commentDoc.data().likes || 0;
              
              transaction.update(commentRef, {
                likes: currentLikes + 1
              });
              
              // Kirim notifikasi like untuk komentar utama
              if (commentDoc.data().userId && commentDoc.data().userId !== user.uid) {
                await createActivityNotification(
                  commentDoc.data().userId,
                  "like",
                  user.uid,
                  user.displayName || user.email.split("@")[0],
                  "",
                  "arduino-history",
                  commentId
                );
              }
            });
          }
        } catch (error) {
          console.error("Error liking comment:", error);
          alert("Gagal menyukai komentar");
        }
      });
    });
  }
  
  // Load komentar dari Firestore
  const unsubscribe = onSnapshot(commentsCollection, (snapshot) => {
    commentsData = snapshot.docs.map(doc => ({
      id: doc.id,
      ...doc.data(),
      timestamp: doc.data().timestamp || doc.data().lastUpdated || serverTimestamp()
    }));
    renderComments();
  });
  
  // Event listener untuk submit komentar baru
  submitComment.addEventListener("click", async () => {
    const content = commentInput.value.trim();
    if (!content) {
      alert("Komentar tidak boleh kosong");
      return;
    }
    
    const user = auth.currentUser;
    if (!user) {
      alert("Anda harus login untuk berkomentar");
      return;
    }
    
    // Dapatkan data pengguna
    let userName = "Pengguna";
    try {
      const userDoc = await getDoc(doc(db, "users", user.uid));
      if (userDoc.exists()) {
        userName = userDoc.data().displayName || user.email.split("@")[0];
      } else {
        userName = user.email.split("@")[0];
      }
    } catch (error) {
      console.error("Error getting user data:", error);
      userName = user.email.split("@")[0];
    }
    
    try {
      // Tambahkan komentar baru ke Firestore
      const newCommentRef = await addDoc(commentsCollection, {
        content,
        userName,
        userId: user.uid,
        timestamp: serverTimestamp(),
        likes: 0,
        replies: []
      });
      
      // Kirim notifikasi ke admin/pemilik konten
      // Ganti 'admin-user-id' dengan ID admin/pemilik konten yang sebenarnya
      const contentOwnerId = "9k1G7CiLZWNCkadVn3m8ZZRaQwg1"; 
      if (contentOwnerId !== user.uid) {
        await createActivityNotification(
          contentOwnerId,
          "comment",
          user.uid,
          userName,
          content,
          "arduino-history",
          newCommentRef.id
        );
      }
      
      commentInput.value = "";
      submitComment.disabled = true;
    } catch (error) {
      console.error("Error adding comment:", error);
      alert("Gagal mengirim komentar");
    }
  });
  
  // Event listener untuk filter
  filterButtons.forEach(btn => {
    btn.addEventListener("click", function() {
      filterButtons.forEach(b => b.classList.remove("active"));
      this.classList.add("active");
      currentFilter = this.dataset.filter;
      renderComments();
    });
  });
  
  // Enable/disable submit button berdasarkan input
  commentInput.addEventListener("input", () => {
    submitComment.disabled = commentInput.value.trim() === "";
  });
  
  // Handle Enter key untuk submit komentar
  commentInput.addEventListener("keypress", (e) => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      submitComment.click();
    }
  });
  
  // Return fungsi cleanup
  return () => {
    unsubscribe();
  };
}

// Panggil setupComments saat halaman dimuat dan user login
let commentsUnsubscribe = null;
onAuthStateChanged(auth, (user) => {
  if (commentsUnsubscribe) {
    commentsUnsubscribe();
  }
  
  if (user) {
    commentsUnsubscribe = setupComments();
  } else {
    // Tampilkan pesan login jika belum login
    document.getElementById("commentsList").innerHTML = `
      <div class="login-message">
        <p>Silakan login untuk melihat dan menambahkan komentar</p>
        <button id="loginButton" class="login-btn">Login</button>
      </div>
    `;
    
    document.getElementById("loginButton")?.addEventListener("click", () => {
      // Implementasi login sesuai kebutuhan
      showPageContent(document.getElementById("pageLogin"));
    });
  }
});

	
	




















    
    // DOM Elements
    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const greeting = document.getElementById("greeting");
    const likeBtn = document.getElementById("likeBtn");
    const followBtn = document.getElementById("followBtn");
	
	
	
	
	
	
	
	
	
	
	
	
	
	async function setupEmojiReactions(user, contentId = 'arduino-history') {
    const emojiOptions = document.querySelectorAll('.emoji-option');
    const reactionMessage = document.querySelector('.reaction-message');
    const loginMessage = document.querySelector('.login-message');

    reactionMessage.style.display = 'none';
    loginMessage.style.display = 'none';

    if (!user) {
        loginMessage.style.display = 'block';
        emojiOptions.forEach(option => {
            option.style.opacity = '0.5';
            option.style.cursor = 'not-allowed';
            option.addEventListener('click', e => {
                e.preventDefault();
                loginMessage.style.opacity = 1;
                setTimeout(() => loginMessage.style.opacity = 0.7, 2000);
            });
        });
        return;
    }

    const reactionDocRef = doc(db, 'reactions', contentId);
    const userReactionRef = doc(db, 'userReactions', `${user.uid}_${contentId}`);

    // Realtime listener
    onSnapshot(reactionDocRef, (snapshot) => {
        const data = snapshot.data();
        if (data) {
            Object.keys(data).forEach(emoji => {
                const el = document.getElementById(`${emoji}-count`);
                if (el) el.textContent = data[emoji];
            });
        }
    });

    let userReaction = null;
    const userReactionSnap = await getDoc(userReactionRef);
    if (userReactionSnap.exists()) {
        userReaction = userReactionSnap.data().emojiType;
        const selected = document.querySelector(`.emoji-option[data-emoji="${userReaction}"]`);
        if (selected) selected.classList.add('selected');
    }

    emojiOptions.forEach(option => {
        option.addEventListener('click', async function () {
            const emojiType = this.dataset.emoji;
            if (userReaction === emojiType) return;

            emojiOptions.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');

            const updates = {};
            if (userReaction) updates[userReaction] = increment(-1);
            updates[emojiType] = increment(1);

            await updateDoc(reactionDocRef, updates).catch(async () => {
                await setDoc(reactionDocRef, updates, { merge: true });
            });

            await setDoc(userReactionRef, {
                userId: user.uid,
                contentId,
                emojiType,
                timestamp: Date.now()
            });

            userReaction = emojiType;

          // Di dalam fungsi setupEmojiReactions, ganti bagian createNotification dengan:
await createActivityNotification(
    '9k1G7CiLZWNCkadVn3m8ZZRaQwg1', // Ganti dengan ID pemilik konten yang sebenarnya
    'reaction',
    user.uid,
    user.displayName || 'Pengguna',
    emojiType,
    contentId.includes('arduino') ? 'arduino-history' : 'content',
    contentId
);

            // ✅ Aktivitas pengguna
            await addDoc(collection(db, "activities"), {
                userId: user.uid,
                type: "reaction",
                emojiType,
                contentId,
                timestamp: Date.now()
            });

            // ✅ Pesan sukses
            reactionMessage.style.display = 'block';
            reactionMessage.style.opacity = 1;
            setTimeout(() => reactionMessage.style.opacity = 0.7, 2000);
        });
    });
}
	
	
	
	
	
	



    // Authentication Functions
    if (loginBtn) {
        loginBtn.addEventListener("click", () => {
            signInWithPopup(auth, provider).catch(console.error);
        });
    }

    if (logoutBtn) {
        logoutBtn.addEventListener("click", () => {
            signOut(auth).catch(console.error);
        });
    }

    // Auth State Listener
    onAuthStateChanged(auth, (user) => {
        const greeting = document.getElementById("greeting");
        const loginBtn = document.getElementById("loginBtn");
        const logoutBtn = document.getElementById("logoutBtn");

        if (user) {
            document.getElementById("page1").style.display = "block";
            document.getElementById("page2").style.display = "none";
            document.getElementById("page3").style.display = "none";
			

            const hours = new Date().getHours();
            let greet = "Selamat malam";
            if (hours >= 5 && hours < 11) greet = "Selamat pagi";
            else if (hours >= 11 && hours < 15) greet = "Selamat siang";
            else if (hours >= 15 && hours < 18) greet = "Selamat sore";

            if (greeting) greeting.textContent = `${greet}, ${user.displayName}`;

            const dynamicText = document.getElementById("dynamicText");
            if (dynamicText) {
                const phrases = [
                    `Ada apa kamu di sini, ${user.displayName}?`,
                    `Lagi nyari inspirasi ya, ${user.displayName}?`,
                    `Selamat datang kembali, ${user.displayName}!`,
                    `Semangat belajar, ${user.displayName}!`,
                    `Mau ngoprek Arduino lagi, ${user.displayName}?`
                ];
                let index = 0;
                function changePhrase() {
                    dynamicText.textContent = phrases[index];
                    index = (index + 1) % phrases.length;
                }
                changePhrase();
                setInterval(changePhrase, 20000);
            }

            if (loginBtn) loginBtn.style.display = "none";
            if (logoutBtn) logoutBtn.style.display = "inline-block";
            if (likeBtn) likeBtn.disabled = false;
            if (followBtn) followBtn.disabled = false;
			
			    setupEmojiReactions(user);
			


        } else {
            if (greeting) greeting.textContent = "";
            if (loginBtn) loginBtn.style.display = "inline-block";
            if (logoutBtn) logoutBtn.style.display = "none";
            if (likeBtn) likeBtn.disabled = true;
            if (followBtn) followBtn.disabled = true;

            const dynamicText = document.getElementById("dynamicText");
            if (dynamicText) dynamicText.textContent = "";
			    setupEmojiReactions(null);

        }
    });























    // DOM Elements
    const toggleAdminBtn = document.getElementById('toggleAdminBtn');
    const adminFormContainer = document.getElementById('adminFormContainer');
    const adminOverlay = document.getElementById('adminOverlay');
    const adminAuth = document.getElementById('adminAuth');
    const adminControls = document.getElementById('adminControls');
    const adminEmail = document.getElementById('adminEmail');
    const adminContentEditor = document.getElementById('adminContentEditor');
    const adminStatus = document.getElementById('adminStatus');
    const dataAuthorElement = document.getElementById('dataAuthor');
    const lastUpdatedElement = document.getElementById('lastUpdated');
    const contentSectionSelect = document.getElementById('contentSection');
    const authorInput = document.getElementById('authorInput');
    const changeDescription = document.getElementById('changeDescription');

    // Toggle admin form
    toggleAdminBtn.addEventListener('click', function() {
        adminFormContainer.style.display = adminFormContainer.style.display === 'none' ? 'block' : 'none';
        adminOverlay.style.display = adminOverlay.style.display === 'none' ? 'block' : 'none';
        document.body.style.overflow = adminFormContainer.style.display === 'block' ? 'hidden' : 'auto';
    });

    // Close form when clicking overlay
    adminOverlay.addEventListener('click', function() {
        adminFormContainer.style.display = 'none';
        adminOverlay.style.display = 'none';
        document.body.style.overflow = 'auto';
    });

    // Auth state handler
    onAuthStateChanged(auth, (user) => {
        const isAdmin = user && user.email === ADMIN_EMAIL;
        adminAuth.style.display = isAdmin ? 'none' : 'block';
        adminControls.style.display = isAdmin ? 'block' : 'none';
        adminEmail.textContent = isAdmin ? user.email : '';
        if (isAdmin) {
            authorInput.value = user.email;
            loadPageContent();
        }
        loadMetadata();
    });

    // Login handler
    document.getElementById('adminLoginBtn').addEventListener('click', () => {
        signInWithPopup(auth, provider).catch(handleLoginError);
    });

    function handleLoginError(error) {
        adminStatus.textContent = 'Login gagal: ' + error.message;
        adminStatus.style.color = 'red';
        adminStatus.style.backgroundColor = 'rgba(255,0,0,0.1)';
        setTimeout(() => { 
            adminStatus.textContent = ''; 
            adminStatus.style.backgroundColor = 'transparent'; 
        }, 3000);
    }

    // Logout handler
    document.getElementById('adminLogoutBtn').addEventListener('click', () => {
        signOut(auth);
        closeAdminForm();
    });

    function closeAdminForm() {
        adminFormContainer.style.display = 'none';
        adminOverlay.style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    // Content section handler
    contentSectionSelect.addEventListener('change', function() {
        loadSectionContent(this.value);
    });

    async function loadSectionContent(section) {
        try {
            const docRef = doc(db, "pageContent", CONTENT_DOC_ID);
            const docSnap = await getDoc(docRef);
            
            if (docSnap.exists() && docSnap.data()[section]) {
                adminContentEditor.value = docSnap.data()[section];
                return;
            }
            
            // Fallback to default content
            const pageContent = document.getElementById('page10').outerHTML;
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(pageContent, 'text/html');

            let sectionContent = '';
            const elements = {
                'title': '.title-section h1',
                'timeline': '.history-timeline',
                'video': '.video-container',
                'footnotes': '.footnotes-container',
                'reactions': '.reaction-container',
                'comments': '.comments-container',
                'cards': '.bab-card'
            };

            const element = htmlDoc.querySelector(elements[section]);
            
            if (section === 'cards') {
                const cards = htmlDoc.querySelectorAll(elements[section]);
                sectionContent = cards.length > 0 ? 
                    Array.from(cards).map(card => card.outerHTML).join('\n') : 
                    '<!-- Cards will go here -->';
            } else if (section === 'timeline') {
                sectionContent = element ? element.innerHTML : '<!-- Timeline content will go here -->';
            } else {
                sectionContent = element ? element.outerHTML : `<!-- ${section} content will go here -->`;
            }

            adminContentEditor.value = sectionContent;
        } catch (error) {
            console.error("Error loading section content:", error);
            adminContentEditor.value = `Error loading content: ${error.message}`;
        }
    }

    async function loadPageContent() {
        contentSectionSelect.value = 'title';
        await loadSectionContent('title');
    }

    async function loadMetadata() {
        try {
            const docRef = doc(db, "pageMetadata", CONTENT_DOC_ID);
            const docSnap = await getDoc(docRef);
            
            if (docSnap.exists()) {
                const metadata = docSnap.data();
                const lastUpdated = metadata.lastUpdated?.toDate();
                const formattedDate = lastUpdated.toLocaleString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                document.getElementById('dataAuthor').textContent = metadata.author;
                document.getElementById('lastUpdated').textContent = formattedDate;
                authorInput.value = metadata.author;
            }
        } catch (error) {
            console.error("Error loading metadata:", error);
        }
    }

    // Save handler
    document.getElementById('adminSaveBtn').addEventListener('click', async () => {
        const user = auth.currentUser;
        if (!user || user.email !== ADMIN_EMAIL) {
            showStatus('Error: Akses tidak diizinkan', 'error');
            return;
        }

        showStatus('Menyimpan perubahan...', 'loading');

        try {
            const section = contentSectionSelect.value;
            const content = adminContentEditor.value;
            const changeDesc = changeDescription.value;
            
            // Save content to Firestore
            const contentRef = doc(db, "pageContent", CONTENT_DOC_ID);
            await setDoc(contentRef, {
                [section]: content
            }, { merge: true });
            
            // Update metadata
            const metadataRef = doc(db, "pageMetadata", CONTENT_DOC_ID);
            await setDoc(metadataRef, {
                author: user.email,
                lastUpdated: new Date(),
                lastChangeDescription: changeDesc
            }, { merge: true });
            
            // Update local UI
            updateLocalContent(section, content);
            
            // Update metadata display
            const formattedDate = new Date().toLocaleString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            document.getElementById('dataAuthor').textContent = user.email;
            document.getElementById('lastUpdated').textContent = formattedDate;
            
            showStatus('Perubahan berhasil disimpan!', 'success');
            changeDescription.value = '';
        } catch (error) {
            console.error("Error:", error);
            showStatus('Error: ' + error.message, 'error');
        }
    });

    function updateLocalContent(section, content) {
        const pageContent = document.getElementById('page10');
        const currentHtml = pageContent.outerHTML;
        const parser = new DOMParser();
        const htmlDoc = parser.parseFromString(currentHtml, 'text/html');

        const updateContent = (selector, newContent, isInner = false) => {
            const element = htmlDoc.querySelector(selector);
            if (!element) {
                if (selector === '.title-section h1') {
                    const titleSection = htmlDoc.querySelector('.title-section') || htmlDoc.createElement('div');
                    titleSection.className = 'title-section';
                    const h1 = htmlDoc.createElement('h1');
                    h1.innerHTML = newContent;
                    titleSection.appendChild(h1);
                    htmlDoc.body.appendChild(titleSection);
                    return;
                }
                throw new Error(`Element ${selector} tidak ditemukan`);
            }
            isInner ? element.innerHTML = newContent : element.outerHTML = newContent;
        };

        switch(section) {
            case 'title': updateContent('.title-section h1', content); break;
            case 'timeline': updateContent('.history-timeline', content, true); break;
            case 'video': updateContent('.video-container', content); break;
            case 'footnotes': updateContent('.footnotes-container', content); break;
            case 'reactions': updateContent('.reaction-container', content); break;
            case 'comments': updateContent('.comments-container', content); break;
            case 'cards': 
                const container = htmlDoc.querySelector('.page10-container');
                if (!container) throw new Error('Container tidak ditemukan');
                container.querySelectorAll('.bab-card').forEach(card => card.remove());
                const newCardsDoc = parser.parseFromString(content, 'text/html');
                Array.from(newCardsDoc.body.children)
                    .filter(card => card.classList.contains('bab-card'))
                    .forEach(card => container.appendChild(card));
                break;
            default: throw new Error('Bagian tidak valid');
        }

        pageContent.outerHTML = htmlDoc.documentElement.outerHTML;
    }

    function showStatus(message, type) {
        adminStatus.textContent = message;
        const styles = {
            error: { color: 'red', bg: 'rgba(255,0,0,0.1)' },
            success: { color: 'lightgreen', bg: 'rgba(0,255,0,0.1)' },
            loading: { color: 'white', bg: 'rgba(0,0,0,0.3)' }
        };
        
        adminStatus.style.color = styles[type]?.color || 'white';
        adminStatus.style.backgroundColor = styles[type]?.bg || 'transparent';
        
        if (type === 'success') {
            setTimeout(() => { 
                adminStatus.textContent = '';
                adminStatus.style.backgroundColor = 'transparent';
            }, 2000);
        }
    }

    // Initial load
    document.addEventListener('DOMContentLoaded', async () => {
        // Load all content from Firestore
        try {
            const docRef = doc(db, "pageContent", CONTENT_DOC_ID);
            const docSnap = await getDoc(docRef);
            
            if (docSnap.exists()) {
                const contentData = docSnap.data();
                
                // Apply content to the page
                if (contentData.title) {
                    document.querySelector('.title-section h1').innerHTML = contentData.title;
                }
                if (contentData.timeline) {
                    document.querySelector('.history-timeline').innerHTML = contentData.timeline;
                }
                if (contentData.video) {
                    const videoContainer = document.querySelector('.video-container');
                    if (videoContainer) videoContainer.outerHTML = contentData.video;
                }
                if (contentData.footnotes) {
                    const footnotesContainer = document.querySelector('.footnotes-container');
                    if (footnotesContainer) footnotesContainer.outerHTML = contentData.footnotes;
                }
                if (contentData.reactions) {
                    const reactionContainer = document.querySelector('.reaction-container');
                    if (reactionContainer) reactionContainer.outerHTML = contentData.reactions;
                }
                if (contentData.comments) {
                    const commentsContainer = document.querySelector('.comments-container');
                    if (commentsContainer) commentsContainer.outerHTML = contentData.comments;
                }
                if (contentData.cards) {
                    const container = document.querySelector('.page10-container');
                    if (container) {
                        container.querySelectorAll('.bab-card').forEach(card => card.remove());
                        const parser = new DOMParser();
                        const newCardsDoc = parser.parseFromString(contentData.cards, 'text/html');
                        Array.from(newCardsDoc.body.children)
                            .filter(card => card.classList.contains('bab-card'))
                            .forEach(card => container.appendChild(card));
                    }
                }
            }
        } catch (error) {
            console.error("Error loading initial content:", error);
        }
        
        // Load metadata
        loadMetadata();
    });















































    // Page Management
    window.onload = function() {
        const page1 = document.getElementById("page1");
        const page2 = document.getElementById("page2");
        const page3 = document.getElementById("page3");
        const page4 = document.getElementById("page4");
        const page5 = document.getElementById("page5");
        const page6 = document.getElementById("page6");
        const page7 = document.getElementById("page7");
		  const page8 = document.getElementById("page8");
		    const page9 = document.getElementById("page9");
			const page10 = document.getElementById("page10");


        // Format waktu lengkap
        function formatTanggalLengkap(date) {
            const hari = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
            const bulan = ["Januari", "Februari", "Maret", "April", "Mei", "Juni",
                        "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            return `${hari[date.getDay()]}, ${date.getDate()} ${bulan[date.getMonth()]} ${date.getFullYear()}`;
        }

        // Waktu terakhir update disimpan di localStorage
        let lastUpdatedTentang = localStorage.getItem("tentangLastUpdated");

        if (!lastUpdatedTentang) {
            lastUpdatedTentang = new Date("2025-07-14T00:00:00Z").toISOString();
            localStorage.setItem("tentangLastUpdated", lastUpdatedTentang);
        }

        function updateTentangRelativeTime() {
            const now = new Date();
            const updatedDate = new Date(localStorage.getItem("tentangLastUpdated"));
            const diffSec = Math.floor((now - updatedDate) / 1000);
            let waktu = "baru saja";

            if (diffSec >= 60 && diffSec < 3600)
                waktu = `${Math.floor(diffSec / 60)} menit yang lalu`;
            else if (diffSec >= 3600 && diffSec < 86400)
                waktu = `${Math.floor(diffSec / 3600)} jam yang lalu`;
            else if (diffSec >= 86400)
                waktu = `${Math.floor(diffSec / 86400)} hari yang lalu`;

            const lengkap = formatTanggalLengkap(updatedDate);
            const span = document.getElementById("tentangKamiTime");
            if (span) span.innerHTML = `${waktu} • ${lengkap}`;
        }

        // Update terus setiap 10 detik
        setInterval(updateTentangRelativeTime, 10000);
        updateTentangRelativeTime();
		
		
		
		
	 
	 // Fungsi utama untuk menampilkan halaman
function showPageContent(pageElement) {
  const pageIds = ["page1", "page2", "page3", "page4", "page5", "page6", "page7", "page8", "page9, page10"];
  
  // Sembunyikan semua halaman
  pageIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.style.display = "none";
  });

  // Tampilkan halaman yang dipilih
  if (pageElement) {
    pageElement.style.display = "block";
    
    // Jika page7, muat pengumuman dan masukan
    if (pageElement.id === "page7") {
      loadPinnedAnnouncements();
      loadFeedback().catch(console.error);
    }
  }
  
  window.scrollTo(0, 0);
}










// Fungsi untuk update sidebar dan scroll indicator
function updateScrollTracking() {
  const timelineItems = document.querySelectorAll('.timeline-item');
  const contentLinks = document.querySelectorAll('.content-link');
  const scrollIndicator = document.getElementById('scrollIndicator');
  const timeline = document.querySelector('.history-timeline');
  
  // Hitung posisi dan tinggi
  const timelineRect = timeline.getBoundingClientRect();
  const timelineStart = timelineRect.top + window.scrollY;
  const timelineEnd = timelineStart + timeline.offsetHeight;
  const scrollPosition = window.scrollY;
  
  // Update scroll indicator
  if (scrollPosition >= timelineStart && scrollPosition <= timelineEnd) {
    const scrollPercent = (scrollPosition - timelineStart) / timeline.offsetHeight;
    scrollIndicator.style.height = `${scrollPercent * 100}%`;
  } else if (scrollPosition < timelineStart) {
    scrollIndicator.style.height = '0%';
  } else {
    scrollIndicator.style.height = '100%';
  }
  
  // Update active link di sidebar
  timelineItems.forEach((item, index) => {
    const itemRect = item.getBoundingClientRect();
    const itemStart = itemRect.top + window.scrollY;
    const itemEnd = itemStart + item.offsetHeight;
    
    if (scrollPosition >= itemStart - 200 && scrollPosition < itemEnd - 200) {
      // Hapus class active dari semua link
      contentLinks.forEach(link => link.classList.remove('active'));
      
      // Tambah class active ke link yang sesuai
      contentLinks[index].classList.add('active');
      
      // Highlight item timeline
      item.style.background = 'rgba(255, 255, 255, 0.15)';
      item.style.borderColor = 'rgba(255, 255, 255, 0.5)';
    } else {
      item.style.background = 'rgba(0, 0, 0, 0.3)';
      item.style.borderColor = 'rgba(255, 255, 255, 0.2)';
    }
  });
}

// Event listener untuk scroll
window.addEventListener('scroll', updateScrollTracking);
window.addEventListener('load', updateScrollTracking);

// Smooth scroll untuk link di sidebar
document.querySelectorAll('.content-link').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    const targetId = this.getAttribute('href');
    const targetElement = document.querySelector(targetId);
    
    if (targetElement) {
      window.scrollTo({
        top: targetElement.offsetTop - 120,
        behavior: 'smooth'
      });
    }
  });
});

// Fungsi untuk navigasi halaman
function navigateToPage(pageNumber) {
  const pageElement = document.getElementById(`page${pageNumber}`);
  if (pageElement) {
    showPageContent(pageElement);
    history.pushState({ page: `page${pageNumber}` }, `Page ${pageNumber}`, `/halaman-${pageNumber}`);
  }
}





// Tambahkan ini di bagian JavaScript
document.querySelectorAll('.footnote-link').forEach(link => {
  link.addEventListener('click', function(e) {
    if(this.hash.startsWith('#footnote')) {
      e.preventDefault();
      const target = document.querySelector(this.hash);
      if(target) {
        window.scrollTo({
          top: target.offsetTop - 100,
          behavior: 'smooth'
        });
        
        // Highlight sementara
        target.style.backgroundColor = 'rgba(255,255,255,0.1)';
        setTimeout(() => {
          target.style.backgroundColor = 'transparent';
        }, 2000);
      }
    }
  });
});



	
	
	
	
	
	





























// Tambahkan event listener untuk card dashboard
  document.getElementById('dashboardCard')?.addEventListener('click', function() {
    showPageContent(document.getElementById("page11"));
    history.pushState({ page: "dashboard" }, "Dashboard", "/dashboard");
  });









// Tambahkan event listener untuk card sejarah
document.querySelectorAll('.sejarah-card').forEach(card => {
    card.addEventListener('click', function(e) {
        e.preventDefault();
        showPageContent(document.getElementById("page10"));
        history.pushState({ page: "sejarah" }, "Sejarah Arduino", "/halaman-sejarah");
    });
});




	 // Tambahkan event listener untuk tombol back di halaman 10
document.getElementById('back')?.addEventListener('click', function(e) {
  e.preventDefault();
  showPageContent(document.getElementById("page1"));
  history.pushState({ page: "home" }, "Beranda", "/");
});


        // Event listeners for navigation
        if (document.getElementById("card-arduino")) {
            document.getElementById("card-arduino").addEventListener("click", function() {
			 showPageContent(document.getElementById("page2"));
                history.pushState({ page: "arduino" }, "Arduino", "/halaman-arduino");
            });
        }

        if (document.getElementById("card-iot")) {
            document.getElementById("card-iot").addEventListener("click", function() {
                       showPageContent(document.getElementById("page3"));
                history.pushState({ page: "iot" }, "IoT", "/halaman-iot");
            });
        }

        if (document.getElementById("back")) {
            document.getElementById("back").addEventListener("click", function(e) {
                e.preventDefault();
				showPageContent(document.getElementById("page1"));
                
                history.pushState({ page: "home" }, "Beranda", "/");
            });
        }

        if (document.getElementById("back-iot")) {
            document.getElementById("back-iot").addEventListener("click", function(e) {
                e.preventDefault();
              showPageContent(document.getElementById("page1"));
                history.pushState({ page: "home" }, "Beranda", "/");
            });
        }

        if (document.getElementById("card-blog")) {
            document.getElementById("card-blog").addEventListener("click", function() {
                       showPageContent(document.getElementById("page4"));
                history.pushState({ page: "blog" }, "Blog", "/halaman-blog");
            });
        }

        if (document.getElementById("back-blog")) {
            document.getElementById("back-blog").addEventListener("click", function(e) {
                e.preventDefault();
              showPageContent(document.getElementById("page1"));
                history.pushState({ page: "home" }, "Beranda", "/");
            });
        }

        if (document.getElementById("lihatSemuaBlog")) {
            document.getElementById("lihatSemuaBlog").addEventListener("click", function(e) {
                e.preventDefault();
                showPageContent(document.getElementById("page5"));
                updateBlogCount();
                history.pushState({ page: "kumpulan-blog" }, "Kumpulan Blog", "/halaman-kumpulan-blog");
            });
        }

        if (document.getElementById("back-page5")) {
            document.getElementById("back-page5").addEventListener("click", function(e) {
                e.preventDefault();
               showPageContent(document.getElementById("page4"));
                history.pushState({ page: "blog" }, "Blog", "/halaman-blog");
            });
        }

        // Tentang kami navigation
        document.querySelectorAll('.tentangLink').forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                showPageContent(document.getElementById("page6"));
            });
        });

        if (document.getElementById('back-tentang')) {
            document.getElementById('back-tentang').addEventListener('click', e => {
                e.preventDefault();
                showPageContent(document.getElementById("page1"));
            });
        }

        // Masukan navigation
        document.querySelectorAll('.masukanLink').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
               showPageContent(document.getElementById("page7"));
                history.pushState({ page: "masukan" }, "Masukan", "/halaman-masukan");
                loadFeedback();
            });
        });

        if (document.getElementById('back-masukan')) {
            document.getElementById('back-masukan').addEventListener('click', function(e) {
                e.preventDefault();
               showPageContent(document.getElementById("page1"));
                history.pushState({ page: "home" }, "Beranda", "/");
            });
        }

        // Feedback form
        if (document.getElementById('masukanForm')) {
            document.getElementById('masukanForm').addEventListener('submit', submitFeedback);
        }

        // Like and Follow buttons
        if (likeBtn) {
            likeBtn.addEventListener('click', () => {
                alert("Kamu menyukai halaman ini!");
            });
        }

        if (followBtn) {
            followBtn.addEventListener('click', () => {
                alert("Kamu mengikuti halaman ini!");
            });
        }
		
		// Forum Diskusi navigation
document.querySelectorAll('.forumLink').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
       showPageContent(document.getElementById("page8"));
        history.pushState({ page: "forum" }, "Forum", "/halaman-forum");
		initializeForumPage();
    });
});

if (document.getElementById('back-forum')) {
    document.getElementById('back-forum').addEventListener('click', function(e) {
        e.preventDefault();
        showPageContent(document.getElementById("page1"));
        history.pushState({ page: "home" }, "Beranda", "/");
    });
}
		
		
		
		window.addEventListener('load', function() {
    handleInitialNavigation();
    setupAnnouncementEventListeners();

    // Setup event listener untuk tombol kembali di halaman 9
    document.getElementById('backToAnnouncements')?.addEventListener('click', function() {
        showPageContent(document.getElementById("page7"));
        history.pushState({ page: "masukan" }, "Masukan", "/halaman-masukan");
    });
});




// Navigasi manual ke halaman 9 dari tombol, card, atau link (jika ada)
document.querySelectorAll('.detail-pengumuman').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        const id = this.getAttribute('data-id');
        if (id) {
            showAnnouncementDetailById(id);
            showPageContent(document.getElementById("page9"));
            history.pushState({ page: "detail-pengumuman", id }, "Detail Pengumuman", `/halaman-masukan-${id}`);
        }
    });
});

		
		
		
		
// JavaScript untuk mengontrol tampilan teks saat video diputar
document.addEventListener('DOMContentLoaded', function() {
  const videos = document.querySelectorAll('.sponsor-video');
  
  videos.forEach(video => {
    const caption = video.parentElement.querySelector('.video-caption');
    
    video.addEventListener('play', function() {
      caption.style.display = 'block';
    });
    
    video.addEventListener('pause', function() {
      caption.style.display = 'none';
    });
    
    video.addEventListener('ended', function() {
      caption.style.display = 'none';
    });
  });
  
  // Tombol kembali
  document.getElementById('back-sponsor').addEventListener('click', function(e) {
    e.preventDefault();
    document.getElementById('page12').style.display = 'none';
    document.getElementById('page1').style.display = 'block';
  });
  
  // Tombol hubungi sponsor
  document.getElementById('contactSponsorBtn').addEventListener('click', function() {
    alert('Silahkan hubungi kami melalui email: sponsor@lifeiswhatitislearn.com');
  });
});		
		
		
	// Di bagian JavaScript yang sudah ada, tambahkan:
document.querySelectorAll('.sponsorLink').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    // Sembunyikan semua halaman
    document.querySelectorAll('div[id^="page"]').forEach(page => {
      page.style.display = 'none';
    });
    // Tampilkan halaman sponsor
    document.getElementById('page12').style.display = 'block';
  });
});	
		
		
		
		
		
		
		
		
document.getElementById('announcementForm')?.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const title = document.getElementById('announcementTitle').value.trim();
    const content = document.getElementById('announcementContent').value.trim();
    
    if (!title || !content) {
        alert('Judul dan isi pengumuman tidak boleh kosong!');
        return;
    }
    
    const user = auth.currentUser;
    if (!user || !isUserAdmin(user)) {
        alert('Anda tidak memiliki izin untuk membuat pengumuman!');
        return;
    }
    
    const submitBtn = document.getElementById('submitAnnouncement');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Mengirim...';
    
    try {
        const announcementData = {
    title,
    content,
    userEmail: user.email,
    userName: user.displayName || 'Admin',
    timestamp: serverTimestamp(),
    type: 'announcement',
    pinned: true,
    pinnedAt: serverTimestamp(),
    views: 0,
    likesCount: 0,
    repliesCount: 0
    // Tidak perlu slug
};

        const announcementsRef = collection(db, "announcements");
        await addDoc(announcementsRef, announcementData);

        // Reset form
        e.target.reset();
        alert('Pengumuman berhasil diposting!');
        
        // Muat ulang daftar pengumuman
        await loadPinnedAnnouncements();
        
    } catch (error) {
        console.error('Error submitting announcement:', error);
        alert('Gagal mengirim pengumuman: ' + error.message);
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
});
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		

        // Blog functions
        function updateBlogCount() {
            const blogList = document.getElementById('blogList');
            if (!blogList) return;
            
            const visibleBlogs = document.querySelectorAll('#blogList .blog-item:not([style*="display: none"])').length;
            const totalBlog = document.querySelectorAll('#blogList .blog-item').length;
            
            const blogCountDisplay = document.getElementById('blogCountDisplay');
            if (blogCountDisplay) {
                blogCountDisplay.textContent = `Menampilkan ${visibleBlogs} dari ${totalBlog} Blog`;
            }
        }

        function searchBlogs() {
            const searchInput = document.getElementById('blogSearch');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            const blogItems = document.querySelectorAll('.blog-item');
            
            blogItems.forEach(item => {
                const title = item.getAttribute('data-title')?.toLowerCase() || '';
                const category = item.getAttribute('data-category')?.toLowerCase() || '';
                const tags = item.getAttribute('data-tags')?.toLowerCase() || '';
                
                if (title.includes(searchTerm) || category.includes(searchTerm) || tags.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
            
            updateBlogCount();
        }

        // Time formatting functions
        function formatTimeAgo(timestamp) {
            if (!timestamp) return 'baru saja';
            
            const now = new Date();
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            const options = { 
                day: 'numeric', 
                month: 'long', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const fullDate = date.toLocaleDateString('id-ID', options);
            
            if (diffInSeconds < 60) return `baru saja • ${fullDate}`;
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit yang lalu • ${fullDate}`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam yang lalu • ${fullDate}`;
            
            return fullDate;
        }
		

     
	 
	 
	 
	 
	 
	 


// Fungsi untuk mendapatkan jumlah replies
async function getRepliesCount(feedbackId) {
    try {
        const repliesRef = collection(db, "feedback", feedbackId, "replies");
        const snapshot = await getCountFromServer(repliesRef);
        return snapshot.data().count;
    } catch (error) {
        console.error("Error getting replies count:", error);
        return 0;
    }
}

// Fungsi untuk mendapatkan jumlah likes
async function getLikesCount(feedbackId) {
    try {
        const likesRef = collection(db, "feedback", feedbackId, "likes");
        const snapshot = await getCountFromServer(likesRef);
        return snapshot.data().count;
    } catch (error) {
        console.error("Error getting likes count:", error);
        return 0;
    }
}

// Fungsi untuk memeriksa apakah user sudah like
async function checkUserLiked(feedbackId) {
    const user = auth.currentUser;
    if (!user) return false;
    
    try {
        const likeDoc = doc(db, "feedback", feedbackId, "likes", user.uid);
        const docSnap = await getDoc(likeDoc);
        return docSnap.exists();
    } catch (error) {
        console.error("Error checking user like:", error);
        return false;
    }
}













	 
	 
	 
	 // Fungsi untuk menampilkan masukan dari cache
function displayCachedFeedback() {
    const feedbackList = document.getElementById('feedbackListContainer');
    if (!feedbackList) return;
    
    const cachedFeedback = JSON.parse(localStorage.getItem('cachedFeedback') || "[]");
    
    if (cachedFeedback.length === 0) {
        feedbackList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Belum ada masukan yang dikirim</div>';
        return;
    }
    
    feedbackList.innerHTML = '';
    cachedFeedback.forEach(item => {
        renderFeedbackItem(item.id, item);
    });
    
    updateFeedbackCount(cachedFeedback.length, true);
}
	 
	 
	 
	 // Event listener untuk form pengumuman
document.getElementById('announcementForm')?.addEventListener('submit', submitAnnouncement);

// Panggil saat auth state berubah
auth.onAuthStateChanged((user) => {
  toggleAdminForms();
  checkAndLoadFeedback();
});
	 
	 
	 
	 function showNotification(message, type = "info") {
  alert(`${type.toUpperCase()}: ${message}`);
}

	 
	 // Fungsi untuk merender item masukan dengan fitur tambahan (VERSI DIPERBAIKI)
function renderFeedbackItem(feedback, repliesCount = 0, likesCount = 0, userLiked = false) {
    const feedbackList = document.getElementById('feedbackListContainer');
    if (!feedbackList) return;
    
    
    // Pastikan kategori yang ditampilkan sesuai dengan yang disimpan
    const validCategories = ['design', 'feature', 'content', 'bug', 'arduino', 'other'];
    const category = feedback.category && validCategories.includes(feedback.category.toLowerCase()) 
        ? feedback.category.toLowerCase() 
        : 'other';
    const categoryClass = validCategories.includes(category) ? category : 'other';
    const categoryLabel = getCategoryLabel(category); // Gunakan fungsi getCategoryLabel
    


    const waktu = feedback.timestamp?.toDate ? feedback.timestamp.toDate() : new Date(feedback.timestamp || Date.now());
    const initials = feedback.userName ? feedback.userName.charAt(0).toUpperCase() : 'A';

    const feedbackItem = document.createElement('div');
    feedbackItem.className = 'feedback-item';
    feedbackItem.setAttribute('data-id', feedback.id);
    
    // Tambahkan class khusus untuk pengumuman
    if (feedback.type === 'announcement' || feedback.category === 'announcement') {
        feedbackItem.classList.add('announcement-item');
        feedbackItem.style.borderLeft = '4px solid #ff6b6b';
        feedbackItem.style.background = 'rgba(255, 107, 107, 0.05)';
    }
    
    feedbackItem.innerHTML = `
        <div class="feedback-header">
            <div class="feedback-user">
                <div class="feedback-avatar">${initials}</div>
                <div>
                    <div style="color: white; font-weight: 500;">${feedback.userName || 'Anonymous'}</div>
                    <div style="color: #aaa; font-size: 12px;">${feedback.userEmail || ''}</div>
                </div>
            </div>
            <div class="feedback-time" style="white-space: nowrap;">${formatTimeAgo(waktu)}${feedback.isCached ? ' (offline)' : ''}</div>
        </div>
        <div class="feedback-title">${feedback.title || 'Tanpa judul'}</div>
		<span class="feedback-category category-${categoryClass}">${categoryLabel}</span>
        <div class="feedback-content">${feedback.content || 'Tidak ada konten'}</div>
        
        <!-- Action buttons -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
            <div style="display: flex; gap: 15px;">
                <button class="like-btn" style="display: flex; align-items: center; background: none; border: none; color: ${userLiked ? '#4ea1ff' : '#ccc'}; cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="${userLiked ? '#4ea1ff' : 'none'}" stroke="${userLiked ? '#4ea1ff' : '#ccc'}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                    </svg>
                    <span class="like-count" style="margin-left: 5px;">${likesCount}</span>
                </button>
                <button class="reply-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span class="reply-count" style="margin-left: 5px;">${repliesCount}</span>
                </button>
				
				 <div style="color:#ccc; display:flex; align-items:center;">
    👁️ <span class="view-count">${feedback.views || 0}</span>
  </div>
            </div>
            <button class="view-details-btn" style="background: none; border: none; color: #4ea1ff; cursor: pointer; font-size: 14px;">
                Lihat Detail
            </button>
        </div>
    `;

    feedbackList.appendChild(feedbackItem);
    
    // Add event listeners
    const likeBtn = feedbackItem.querySelector('.like-btn');
    const replyBtn = feedbackItem.querySelector('.reply-btn');
    const viewDetailsBtn = feedbackItem.querySelector('.view-details-btn');
    
    if (likeBtn) likeBtn.addEventListener('click', () => toggleLike(feedback.id));
    if (replyBtn) replyBtn.addEventListener('click', () => openReplyModal(feedback));
    if (viewDetailsBtn) viewDetailsBtn.addEventListener('click', () => viewFeedbackDetails(feedback.id));
    
    // Increment view count
    if (feedback.id) incrementViewCount(feedback.id);
}

	 
	 
	 
	 
	 
	 
	 
	 
// Fungsi untuk memeriksa dan memuat masukan saat halaman dimuat
function checkAndLoadFeedback() {
    const path = window.location.pathname || "/";
    if (path.includes("halaman-masukan") || 
        (window.history.state && window.history.state.page === "masukan")) {
        
        // Coba muat dari cache dulu untuk UX yang lebih cepat
        displayCachedFeedback();
        
        // Kemudian coba update dari Firebase
        loadFeedback().catch(console.error);
    }
}

	 
	 
	 // Fungsi untuk menambah jumlah view
async function incrementViewCount(feedbackId) {
    try {
        const feedbackRef = doc(db, "feedback", feedbackId);
        await updateDoc(feedbackRef, {
            views: increment(1)
        });
    } catch (error) {
        console.error("Error incrementing view count:", error);
    }
}

// Fungsi untuk like/unlike
async function toggleLike(feedbackId) {
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login terlebih dahulu untuk memberikan like');
        return;
    }
    
    try {
        const likeRef = doc(db, "feedback", feedbackId, "likes", user.uid);
        const likeDoc = await getDoc(likeRef);
        
        if (likeDoc.exists()) {
            // Unlike
            await deleteDoc(likeRef);
        } else {
            // Like
            await setDoc(likeRef, {
                userId: user.uid,
                timestamp: serverTimestamp()
            });
        }
        
        // Update UI
        const feedbackItem = document.querySelector(`.feedback-item[data-id="${feedbackId}"]`);
        if (feedbackItem) {
            const likeBtn = feedbackItem.querySelector('.like-btn');
            const likeCount = feedbackItem.querySelector('.like-count');
            const likeSvg = likeBtn.querySelector('svg');
            
            const currentCount = parseInt(likeCount.textContent);
            const isLiked = likeSvg.getAttribute('fill') === '#4ea1ff';
            
            if (isLiked) {
                // Unlike
                likeSvg.setAttribute('fill', 'none');
                likeSvg.setAttribute('stroke', '#ccc');
                likeBtn.style.color = '#ccc';
                likeCount.textContent = currentCount - 1;
            } else {
                // Like
                likeSvg.setAttribute('fill', '#4ea1ff');
                likeSvg.setAttribute('stroke', '#4ea1ff');
                likeBtn.style.color = '#4ea1ff';
                likeCount.textContent = currentCount + 1;
            }
        }
    } catch (error) {
        console.error("Error toggling like:", error);
        alert('Gagal mengupdate like. Silakan coba lagi nanti.');
    }
}

// Fungsi untuk membuka modal reply
function openReplyModal(feedback) {
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login terlebih dahulu untuk membalas masukan');
        return;
    }
    
    const modal = document.getElementById('replyModal');
    const originalFeedback = document.getElementById('originalFeedback');
    
    // Tampilkan feedback asli
    originalFeedback.innerHTML = `
        <div style="margin-bottom: 10px;">
            <strong style="color: white;">${feedback.userName || 'Anonymous'}</strong>
            <span style="color: #aaa; font-size: 12px; margin-left: 10px;">${formatTimeAgo(feedback.timestamp?.toDate?.() || new Date(feedback.timestamp))}</span>
        </div>
        <div style="color: white; font-weight: 500; margin-bottom: 5px;">${feedback.title}</div>
        <div style="color: #ddd;">${feedback.content}</div>
    `;
    
    // Reset form
    document.getElementById('replyContent').value = '';
    
    // Simpan feedback ID di modal
    modal.setAttribute('data-feedback-id', feedback.id);
    
    // Tampilkan modal
    modal.style.display = 'flex';
}

// Fungsi untuk menutup modal reply
function closeReplyModal() {
    document.getElementById('replyModal').style.display = 'none';
}
async function submitReply(e) {
    e.preventDefault();
    
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login terlebih dahulu untuk membalas masukan');
        return;
    }
    
    const feedbackId = document.getElementById('replyModal').getAttribute('data-feedback-id');
    const content = document.getElementById('replyContent').value.trim();
    
    if (!content) {
        alert('Isi balasan tidak boleh kosong');
        return;
    }
    
    const submitBtn = document.getElementById('submitReply');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Mengirim... <span class="loading-spinner"></span>';
    
    try {
        // Tambahkan reply ke subcollection
        const repliesRef = collection(db, "feedback", feedbackId, "replies");
        const replyDoc = await addDoc(repliesRef, {
            content,
            userId: user.uid,
            userName: user.displayName || 'Anonymous',
            userEmail: user.email,
            timestamp: serverTimestamp()
        });
        
        // Update reply count di feedback utama
        const feedbackRef = doc(db, "feedback", feedbackId);
        await updateDoc(feedbackRef, {
            replyCount: increment(1)
        });
        
        // Get feedback details to notify the author
        const feedbackDoc = await getDoc(feedbackRef);
        if (feedbackDoc.exists() && feedbackDoc.data().userId !== user.uid) {
            await createNotification(
                feedbackDoc.data().userId,
                'reply',
                `${user.displayName || 'Seseorang'} membalas masukan Anda`,
                replyDoc.id,
                `/feedback/${feedbackId}#reply-${replyDoc.id}`
            );
        }
        
        // Update UI
        const feedbackItem = document.querySelector(`.feedback-item[data-id="${feedbackId}"]`);
        if (feedbackItem) {
            const replyCount = feedbackItem.querySelector('.reply-count');
            const currentCount = parseInt(replyCount.textContent);
            replyCount.textContent = currentCount + 1;
        }
        
        closeReplyModal();
        alert('Balasan berhasil dikirim!');
        
    } catch (error) {
        console.error("Error submitting reply:", error);
        alert('Gagal mengirim balasan. Silakan coba lagi nanti.');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
}

// Fungsi untuk melihat detail feedback dan replies
async function viewFeedbackDetails(feedbackId) {
    // Implementasi halaman detail feedback
    alert(`Membuka detail feedback dengan ID: ${feedbackId}`);
    // Anda bisa mengarahkan ke halaman baru atau membuka modal yang lebih besar
}

// Event listeners untuk modal reply
document.getElementById('closeReplyModal').addEventListener('click', closeReplyModal);
document.getElementById('cancelReply').addEventListener('click', closeReplyModal);
document.getElementById('replyForm').addEventListener('submit', submitReply);

// Event listeners untuk sorting
document.getElementById('sortNewest').addEventListener('click', function() {
    this.style.background = 'rgba(78, 161, 255, 0.2)';
    this.style.border = '1px solid rgba(78, 161, 255, 0.5)';
    this.style.color = '#4ea1ff';
    
    document.getElementById('sortPopular').style.background = 'rgba(255,255,255,0.05)';
    document.getElementById('sortPopular').style.border = '1px solid rgba(255,255,255,0.2)';
    document.getElementById('sortPopular').style.color = 'white';
    
    // Implementasi sorting terbaru
    loadFeedback();
});

document.getElementById('sortPopular').addEventListener('click', function() {
    this.style.background = 'rgba(78, 161, 255, 0.2)';
    this.style.border = '1px solid rgba(78, 161, 255, 0.5)';
    this.style.color = '#4ea1ff';
    
    document.getElementById('sortNewest').style.background = 'rgba(255,255,255,0.05)';
    document.getElementById('sortNewest').style.border = '1px solid rgba(255,255,255,0.2)';
    document.getElementById('sortNewest').style.color = 'white';
    
    // Implementasi sorting populer (berdasarkan jumlah like + reply)
    // Anda perlu memodifikasi query Firebase atau melakukan sorting client-side
    alert('Fitur sorting populer akan segera tersedia!');
});
	 
	 
	 
	 
	

// Event listener untuk form
document.getElementById('masukanForm')?.addEventListener('submit', submitFeedback);
// Panggil saat halaman dimuat dan setiap kali ada perubahan state
window.addEventListener('load', checkAndLoadFeedback);
window.addEventListener('popstate', checkAndLoadFeedback);

// Deteksi perubahan koneksi untuk refresh data
window.addEventListener('online', () => {
    if (window.location.pathname.includes("halaman-masukan")) {
        loadFeedback().catch(console.error);
    }
});
	 
	 

// Event listener untuk form
document.getElementById('masukanForm')?.addEventListener('submit', async function(e) {
    e.preventDefault();
  
     
    // Deklarasi semua variabel yang dibutuhkan
    const title = document.getElementById('feedbackTitle').value.trim();
    const category = document.getElementById('feedbackCategory').value;
    const content = document.getElementById('feedbackContent').value.trim();
    
    
    if (!title || !content) {
        alert('Judul dan isi masukan tidak boleh kosong!');
        return;
    }
    
    const submitBtn = document.getElementById('submitFeedback');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Mengirim... <span class="loading-spinner"></span>';
    
    const user = auth.currentUser;
    const feedbackData = {
        title,
        category,
        content,
        userName: user?.displayName || 'Anonymous',
        userEmail: user?.email || null,
        userId: user?.uid || null,
        timestamp: serverTimestamp()
    };

    try {
        // Simpan ke Firebase
        const feedbackRef = collection(db, "feedback");
        await addDoc(feedbackRef, feedbackData);
        
        // Reset form
        e.target.reset();
        
        // Perbarui tampilan
        await loadFeedback();
        
    } catch (error) {
        console.error('Error submitting feedback:', error);
        alert('Gagal mengirim masukan. Pastikan Anda terhubung ke internet.');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
});



function getCategoryLabel(category) {
    const categoryMap = {
        'design': 'Desain',
        'feature': 'Fitur',
        'content': 'Konten',
        'bug': 'Bug/Masalah',
        'arduino': 'Arduino',
        'other': 'Lainnya'
    };
    
    const normalizedCategory = String(category).toLowerCase().trim();
    return categoryMap[normalizedCategory] || categoryMap['other'];
}




function renderPinnedAnnouncementItem(announcement) {
  const item = document.createElement("div");
  item.classList.add("announcement-item");

  // Pastikan judul bisa diklik dan memuat detail
  item.innerHTML = `
    <div class="announcement-title" style="cursor: pointer; color: yellow;" data-id="${announcement.id}">
      ${announcement.title}
    </div>
    <div class="announcement-date">${announcement.date}</div>
  `;

  item.querySelector(".announcement-title").addEventListener("click", () => {
    loadAnnouncementDetail(announcement.id);
  });

  return item;
}











async function submitFeedback(e) {
    e.preventDefault();
    
    const title = document.getElementById('feedbackTitle').value.trim();
    const category = document.getElementById('feedbackCategory').value;
    const validCategories = ['design', 'feature', 'content', 'bug', 'arduino', 'other'];
    const normalizedCategory = validCategories.includes(category) ? category : 'other';
    const content = document.getElementById('feedbackContent').value.trim();
    
    // Validasi input
    if (!title || !content) {
        showNotification('Judul dan isi masukan tidak boleh kosong!', 'error');
        return;
    }
    
    const submitBtn = document.getElementById('submitFeedback');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Mengirim... <span class="loading-spinner"></span>';
    
    const user = auth.currentUser;
    const feedbackData = {
        title,
        category: normalizedCategory,
        content,
        userName: user?.displayName || 'Anonymous',
        userEmail: user?.email || null,
        userId: user?.uid || null,
        timestamp: serverTimestamp(),
        status: 'new',
        likesCount: 0,
        repliesCount: 0,
        viewsCount: 0,
        isCached: false
    };

    try {
        const feedbackRef = collection(db, "feedback");
        const docRef = await addDoc(feedbackRef, feedbackData);
        
        // Create notification for admin
await createNotification(
    '9k1G7CiLZWNCkadVn3m8ZZRaQwg1', // Admin ID
    'feedback',
    `Feedback baru: ${title}`,
    docRef.id,
    `/feedback/${docRef.id}`
);

        
        // Update UI
        const feedbackWithId = { ...feedbackData, id: docRef.id };
        const [repliesCount, likesCount, userLiked] = await Promise.all([
            getRepliesCount(docRef.id),
            getLikesCount(docRef.id),
            checkUserLiked(docRef.id)
        ]);
        
        renderFeedbackItem(feedbackWithId, repliesCount, likesCount, userLiked);
        e.target.reset();
        showNotification('Masukan berhasil dikirim!', 'success');
        
    } catch (error) {
        console.error('Error submitting feedback:', error);
        if (error.code === 'unavailable') {
            try {
                const cachedFeedback = JSON.parse(localStorage.getItem('pendingFeedback') || "[]");
                cachedFeedback.push({
                    ...feedbackData,
                    timestamp: new Date().toISOString(),
                    category: category
                });
                localStorage.setItem('pendingFeedback', JSON.stringify(cachedFeedback));
                showNotification('Masukan disimpan secara offline dan akan dikirim ketika online', 'warning');
            } catch (cacheError) {
                console.error('Error saving to cache:', cacheError);
                showNotification('Gagal mengirim masukan. Silakan coba lagi saat online.', 'error');
            }
        } else {
            showNotification('Gagal mengirim masukan: ' + error.message, 'error');
        }
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
}













// Fungsi pembantu untuk format waktu
function formatTimeAgo(timestamp) {
    if (!timestamp) return 'baru saja';
    
    const now = new Date();
    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
    const diffInSeconds = Math.floor((now - date) / 1000);
    
    const options = { 
        day: 'numeric', 
        month: 'long', 
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    };
    const fullDate = date.toLocaleDateString('id-ID', options);
    
    if (diffInSeconds < 60) return `baru saja • ${fullDate}`;
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit yang lalu • ${fullDate}`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam yang lalu • ${fullDate}`;
    
    return fullDate;
}


	 
	 
	 
	 // Fungsi untuk update jumlah masukan
function updateFeedbackCount(count, isCached = false) {
    const feedbackCountDisplay = document.getElementById('feedbackCountDisplay');
    if (feedbackCountDisplay) {
        feedbackCountDisplay.textContent = isCached 
            ? `Menampilkan ${count} masukan (data offline)` 
            : `Menampilkan ${count} masukan terbaru`;
    }
}





async function loadFeedback() {
    const feedbackList = document.getElementById('feedbackListContainer');
    if (!feedbackList) return;

    try {
        // Tampilkan loading state
        feedbackList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Memuat masukan...</div>';

        // Ambil data dari Firebase dengan sorting berdasarkan timestamp
        const q = query(
            collection(db, "feedback"), 
            orderBy("timestamp", "desc"),
            limit(50)
        );
        
        const querySnapshot = await getDocs(q);
        
        if (querySnapshot.empty) {
            feedbackList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Belum ada masukan yang dikirim</div>';
            return;
        }

        // Render feedback dari Firebase
        feedbackList.innerHTML = '';
        const feedbackItems = [];
        
        // Gunakan Promise.all untuk menunggu semua operasi async selesai
        await Promise.all(querySnapshot.docs.map(async (doc) => {
            const feedback = doc.data();
            feedback.id = doc.id;
            feedbackItems.push(feedback);
            
            const [repliesCount, likesCount, userLiked] = await Promise.all([
                getRepliesCount(doc.id),
                getLikesCount(doc.id),
                checkUserLiked(doc.id)
            ]);
            
            renderFeedbackItem(feedback, repliesCount, likesCount, userLiked);
        }));

        // Simpan ke cache
        localStorage.setItem('cachedFeedback', JSON.stringify(feedbackItems));
        updateFeedbackCount(querySnapshot.size);

    } catch (error) {
        console.error("Error loading feedback:", error);
        displayCachedFeedback();
    }
}







// Daftar email yang diizinkan (admin/contributor)
const ALLOWED_EMAILS = ['faridardiansyah061@gmail.com'];


// Fungsi untuk mengecek apakah user adalah admin/contributor
function checkAdminStatus(user) {
  if (!user || !user.email) return false;
  return ALLOWED_EMAILS.includes(user.email.toLowerCase());
}









function toggleAdminForms() {
    const user = auth.currentUser;
    const isAdmin = isUserAdmin(user);
    
    // Toggle form admin di halaman 7
    const adminFormPage7 = document.getElementById('adminAnnouncementForm');
    if (adminFormPage7) {
        adminFormPage7.style.display = isAdmin ? 'block' : 'none';
    }
    
    // Toggle form admin di halaman 9
    const adminFormPage9 = document.querySelector('#page9 #adminAnnouncementForm');
    if (adminFormPage9) {
        adminFormPage9.style.display = isAdmin ? 'block' : 'none';
    }
}












// Fungsi untuk mengecek status admin dan menampilkan form edit jika admin
function setupAdminFormForAnnouncement(announcementId, announcement) {
  const user = auth.currentUser;
  const isAdmin = isUserAdmin(user);
  const adminForm = document.getElementById('adminAnnouncementForm');
  
  if (isAdmin && adminForm) {
    adminForm.style.display = 'block';

    // Isi form edit dengan data pengumuman
    document.getElementById('editAnnouncementTitle').value = announcement.title;
    document.getElementById('editAnnouncementContent').value = announcement.content;

    // Setup event listeners untuk form edit
    document.getElementById('editAnnouncementForm').onsubmit = (e) => {
      e.preventDefault();
      updateAnnouncement(announcementId);
    };

    document.getElementById('cancelEditAnnouncement').onclick = () => {
      adminForm.style.display = 'none';
    };

    document.getElementById('deleteAnnouncement').onclick = () => {
      if (confirm('Apakah Anda yakin ingin menghapus pengumuman ini?')) {
        deleteAnnouncement(announcementId);
      }
    };
  } else if (adminForm) {
    adminForm.style.display = 'none';
  }
}

// Panggil toggleAdminForms saat auth state berubah
auth.onAuthStateChanged((user) => {
  toggleAdminForms();
  checkAndLoadFeedback();
});







async function submitAnnouncement(e) {
    e.preventDefault();

    const title = document.getElementById('announcementTitle').value.trim();
    const content = document.getElementById('announcementContent').value.trim();

    if (!title || !content) {
        showNotification('Judul dan isi pengumuman tidak boleh kosong!', 'error');
        return;
    }

    const user = auth.currentUser;
    if (!user || !checkAdminStatus(user)) {
        showNotification('Anda tidak memiliki izin untuk membuat pengumuman!', 'error');
        return;
    }

    const submitBtn = document.getElementById('submitAnnouncement');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Mengirim... <span class="loading-spinner"></span>';

    try {
        const announcementData = {
            title,
            content,
            userEmail: user.email,
            userName: user.displayName || 'Admin',
            timestamp: serverTimestamp(),
            type: 'announcement',
            pinned: true,
            pinnedAt: serverTimestamp(),
            views: 0,
            likesCount: 0,
            repliesCount: 0
        };

        // Add to Firestore
        const announcementsRef = collection(db, "announcements");
        const docRef = await addDoc(announcementsRef, announcementData);

        // Reset form
        e.target.reset();
        showNotification('Pengumuman berhasil diposting!', 'success');

        // Update cache
        const cachedAnnouncements = JSON.parse(localStorage.getItem('cachedAnnouncements') || '[]');
        cachedAnnouncements.unshift({
            ...announcementData,
            id: docRef.id
        });
        localStorage.setItem('cachedAnnouncements', JSON.stringify(cachedAnnouncements));

        // Reload announcements
        await loadPinnedAnnouncements();

    } catch (error) {
        console.error('Error submitting announcement:', error);
        showNotification('Gagal mengirim pengumuman: ' + error.message, 'error');
        
        // Try to save locally if offline
        if (error.code === 'unavailable') {
            const pendingAnnouncements = JSON.parse(localStorage.getItem('pendingAnnouncements') || '[]');
            pendingAnnouncements.push({
                title,
                content,
                timestamp: new Date().toISOString(),
                userName: user?.displayName || 'Admin'
            });
            localStorage.setItem('pendingAnnouncements', JSON.stringify(pendingAnnouncements));
            showNotification('Pengumuman disimpan offline dan akan dikirim ketika online', 'warning');
        }
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
}




async function loadPinnedAnnouncements() {
    const pinnedContainer = document.getElementById('pinnedAnnouncementsList');
    if (!pinnedContainer) return;

    try {
        // Tampilkan loading state
        pinnedContainer.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Memuat pengumuman...</div>';

        // Query untuk mendapatkan pengumuman yang dipin
        const q = query(
            collection(db, "announcements"),
            where("pinned", "==", true),
            orderBy("pinnedAt", "desc"),
            limit(25)
        );
        
        const querySnapshot = await getDocs(q);
        
        if (querySnapshot.empty) {
            console.warn('Pengumuman kosong dari Firebase, coba tampilkan cache');
            displayCachedAnnouncements();
            return;
        }

        const announcements = [];
        
        // Gunakan Promise.all untuk parallel processing
        await Promise.all(querySnapshot.docs.map(async (doc) => {
            const announcement = doc.data();
            announcement.id = doc.id;
            
            // Dapatkan jumlah like dan reply
            const [likesCount, repliesCount] = await Promise.all([
                getAnnouncementLikesCount(doc.id),
                getAnnouncementRepliesCount(doc.id)
            ]);
            
            announcement.likesCount = likesCount;
            announcement.repliesCount = repliesCount;
            announcements.push(announcement);
            
            // Update view count
            await incrementAnnouncementViews(doc.id);
        }));

        // Simpan ke cache dengan timestamp
        const cacheData = {
            data: announcements,
            timestamp: new Date().getTime(),
            source: 'firebase'
        };
        localStorage.setItem('cachedAnnouncements', JSON.stringify(cacheData));
        
        // Render pengumuman
        renderAnnouncements(announcements);

    } catch (error) {
        console.error("Error loading pinned announcements:", error);
        // Fallback ke cache jika error
        displayCachedAnnouncements();
    }
}






















	 
	 
	 // Fungsi untuk toggle pin pengumuman
async function togglePinAnnouncement(announcementId, currentlyPinned) {
    const user = auth.currentUser;
    if (!checkAdminStatus(user)) {
        alert('Hanya admin yang dapat mem-pin pengumuman!');
        return;
    }

    try {
        const announcementRef = doc(db, "announcements", announcementId);
        
        if (currentlyPinned) {
            // Unpin
            await updateDoc(announcementRef, {
                pinned: false,
                pinnedAt: null
            });
        } else {
            // Pin
            await updateDoc(announcementRef, {
                pinned: true,
                pinnedAt: serverTimestamp()
            });
        }
        
        // Refresh daftar pengumuman
        await loadPinnedAnnouncements();
        
    } catch (error) {
        console.error("Error toggling pin:", error);
        alert('Gagal mengubah status pin. Silakan coba lagi.');
    }
}
	 
	 
	 
	 
	 
	 // Fungsi untuk mencoba mengirim pending feedback saat online
async function sendPendingFeedback() {
    const pendingFeedback = JSON.parse(localStorage.getItem('pendingFeedback') || "[]");
    if (pendingFeedback.length === 0) return;

    try {
        const feedbackRef = collection(db, "feedback");
        
        for (const feedback of pendingFeedback) {
            await addDoc(feedbackRef, {
                ...feedback,
                timestamp: serverTimestamp(),
                isCached: true
            });
        }
        
        // Kosongkan cache setelah berhasil dikirim
        localStorage.removeItem('pendingFeedback');
        showNotification(`${pendingFeedback.length} masukan offline berhasil dikirim`, 'success');
        
    } catch (error) {
        console.error('Error sending pending feedback:', error);
    }
}

// Panggil saat online
window.addEventListener('online', sendPendingFeedback);






async function renderAnnouncements(announcements) {
  const pinnedContainer = document.getElementById('pinnedAnnouncementsList');
  if (!pinnedContainer) return;

  pinnedContainer.innerHTML = '';

  for (const announcement of announcements) {
    const waktu = announcement.timestamp?.toDate ? announcement.timestamp.toDate() : new Date(announcement.timestamp);

    // Ambil daftar user yang reply
    const repliers = await getRepliersInfo(announcement.id);
    const avatarListHTML = repliers.map(u => `
      <img src="${u.userPhoto || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(u.userName || 'U')}" 
           alt="${u.userName}" title="${u.userName}" 
           style="width: 28px; height: 28px; border-radius: 50%; border: 2px solid #fff; object-fit: cover; margin-left: -8px;">
    `).join('');

    const announcementItem = document.createElement('div');
    announcementItem.className = 'pinned-item';
    announcementItem.setAttribute('data-id', announcement.id);

    announcementItem.style.cssText = `
        margin-bottom: 15px;
        padding: 15px;
        border-radius: 10px;
        background: rgba(255, 107, 107, 0.1);
        border-left: 4px solid #ff6b6b;
        cursor: pointer;
    `;

    announcementItem.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
            <h3 style="color: #ff6b6b; margin: 0; font-size: 18px; display: flex; align-items: center; gap: 8px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="#ff6b6b">
                    <path d="M16 12V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v8l-2 2v1h15v-1l-2-2z"/>
                </svg>
                ${announcement.title}
            </h3>
            <div style="color: #aaa; font-size: 12px;">${formatTimeAgo(waktu)}</div>
        </div>

        <div style="margin-top: 10px; display: flex; align-items: center;">
          <div style="display: flex; margin-left: -4px;">
            ${avatarListHTML}
          </div>
          <span style="color: #aaa; font-size: 12px; margin-left: 8px;">
            Telah dibalas oleh ${avatarListHTML ? 'pengguna' : 'tidak ada balasan'}
          </span>
        </div>

        <div style="color: #ddd; margin-top: 8px; line-height: 1.5;">
            ${announcement.content.substring(0, 150)}${announcement.content.length > 150 ? '...' : ''}
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="color: #aaa; font-size: 12px; font-style: italic;">
                Diposting oleh: ${announcement.userName || 'Admin'}
            </div>
            <div style="display: flex; gap: 10px;">
                <span style="color: #ccc; font-size: 12px; display: flex; align-items: center;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <span class="view-count" style="margin-left: 5px;">${announcement.views || 0}</span>
                </span>
                <button class="like-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                    </svg>
                    <span class="like-count" style="margin-left: 5px;">${announcement.likesCount || 0}</span>
                </button>
                <button class="reply-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span class="reply-count" style="margin-left: 5px;">${announcement.repliesCount || 0}</span>
                </button>
            </div>
        </div>
        <button class="view-announcement-btn" style="background: none; border: none; color: #4ea1ff; cursor: pointer; font-size: 14px;">
            Baca Selengkapnya
        </button>
    `;

    // Event listeners
    announcementItem.addEventListener('click', async (e) => {
      if (!e.target.closest('.like-btn, .reply-btn, .view-announcement-btn')) {
        e.preventDefault();
        const id = announcementItem.getAttribute('data-id');
        if (id) {
          history.pushState({ page: "detail-pengumuman" }, "", `/halaman-masukan-${id}`);
          await showAnnouncementDetailById(id);
        }
      }
    });

    const likeBtn = announcementItem.querySelector('.like-btn');
    if (likeBtn) {
      likeBtn.addEventListener('click', async (event) => {
        event.stopPropagation();
        await toggleAnnouncementLike(announcement.id);
        const updatedLikes = await getAnnouncementLikesCount(announcement.id);
        announcementItem.querySelector('.like-count').textContent = updatedLikes;
      });
    }

    const replyBtn = announcementItem.querySelector('.reply-btn');
    if (replyBtn) {
      replyBtn.addEventListener('click', (event) => {
        event.stopPropagation();
        viewAnnouncementDetails(announcement.id);
      });
    }

    const viewBtn = announcementItem.querySelector('.view-announcement-btn');
    if (viewBtn) {
      viewBtn.addEventListener('click', async (event) => {
        event.stopPropagation();
        await viewAnnouncementDetails(announcement.id);
      });
    }

    pinnedContainer.appendChild(announcementItem);
  }
}












// Function to increment announcement views
async function incrementAnnouncementViews(announcementId) {
    try {
        const announcementRef = doc(db, "announcements", announcementId);
        await updateDoc(announcementRef, {
            views: increment(1),
            lastViewed: serverTimestamp()
        });
    } catch (error) {
        console.error("Error incrementing announcement views:", error);
    }
}






// Fungsi untuk toggle like pengumuman
async function toggleAnnouncementLike(announcementId) {
  const user = auth.currentUser;
  if (!user) {
    alert('Silakan login terlebih dahulu untuk memberikan like');
    return;
  }
  
  try {
    const likeRef = doc(db, "announcements", announcementId, "likes", user.uid);
    const likeDoc = await getDoc(likeRef);
    
    if (likeDoc.exists()) {
      // Unlike
      await deleteDoc(likeRef);
      await updateDoc(doc(db, "announcements", announcementId), {
        likesCount: increment(-1)
      });
    } else {
      // Like
      await setDoc(likeRef, {
        userId: user.uid,
        timestamp: serverTimestamp()
      });
      await updateDoc(doc(db, "announcements", announcementId), {
        likesCount: increment(1)
      });
    }
    
  } catch (error) {
    console.error("Error toggling announcement like:", error);
    throw error;
  }
}

// Fungsi untuk mendapatkan jumlah like pengumuman
async function getAnnouncementLikesCount(announcementId) {
  try {
    const docSnap = await getDoc(doc(db, "announcements", announcementId));
    return docSnap.data()?.likesCount || 0;
  } catch (error) {
    console.error("Error getting announcement likes count:", error);
    return 0;
  }
}









	 
	 function loadAnnouncements() {
  const container = document.getElementById("announcementContainer");
  container.innerHTML = "";

  firebase.database().ref('announcements').once('value', snapshot => {
    snapshot.forEach(child => {
      const data = child.val();
      const div = document.createElement("div");
      div.className = "feedback-item announcement-item";
      div.innerHTML = `
        <div class="feedback-title">${data.title}</div>
        <div class="feedback-content">${data.content}</div>
        <div style="margin-top:10px;">
          👁️ <span>${data.views || 0}</span>
          ❤️ <span>${data.likes || 0}</span>
          💬 <span>${(data.replies || []).length}</span>
        </div>
        <button onclick="likeAnnouncement('${child.key}')">Like</button>
        <button onclick="replyToAnnouncement('${child.key}')">Reply</button>
      `;
      container.appendChild(div);

      // Tambah view otomatis
      firebase.database().ref(`announcements/${child.key}/views`).transaction(v => (v || 0) + 1);
    });
  });
}














// Fungsi untuk render balasan terpisah
function renderAnnouncementReplies(replies) {
  const repliesList = document.getElementById('announcementRepliesList');
  if (!repliesList) return;

  repliesList.innerHTML = '';

  if (replies.length === 0) {
    repliesList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Belum ada balasan</div>';
    return;
  }

  replies.forEach(reply => {
    const replyElement = document.createElement('div');
    replyElement.style.cssText = 'padding: 15px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-bottom: 10px;';
    
    replyElement.innerHTML = `
      <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
        <div style="width: 30px; height: 30px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; color: white;">
          ${reply.userName?.charAt(0).toUpperCase() || 'U'}
        </div>
        <div>
          <div style="color: white; font-size: 14px; font-weight: 500;">${reply.userName || 'User'}</div>
          <div style="color: #aaa; font-size: 12px;">${formatTimeAgo(reply.timestamp)}</div>
        </div>
      </div>
      <div style="margin-top: 10px; font-size: 15px; line-height: 1.5; color: #ddd;">
        ${reply.content}
      </div>
    `;
    
    repliesList.appendChild(replyElement);
  });

  // Update jumlah balasan
  document.getElementById('repliesCount').textContent = replies.length;
  
 const uniqueRepliers = new Map();
replies.forEach(data => {
  if (!uniqueRepliers.has(data.userEmail)) {
    uniqueRepliers.set(data.userEmail, {
      userName: data.userName,
      userPhoto: data.userPhoto || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(data.userName || 'U')
    });
  }
});


const repliersContainer = document.createElement('div');
repliersContainer.style.cssText = 'margin-top: 20px; display: flex; flex-wrap: wrap; gap: 8px; align-items: center;';

uniqueRepliers.forEach(user => {
  const avatar = document.createElement('img');
  avatar.src = user.userPhoto;
  avatar.alt = user.userName;
  avatar.title = user.userName;
  avatar.style.cssText = 'width: 32px; height: 32px; border-radius: 50%; border: 2px solid #fff; object-fit: cover;';
  repliersContainer.appendChild(avatar);
});

const container = document.getElementById("announcementRepliesContainer");
if (container) container.insertBefore(repliersContainer, container.children[1]);
}





















async function loadAnnouncementDetail(announcementId) {
    try {
        const container = document.getElementById('announcementDetailContainer');
        container.innerHTML = '<div style="color:#ccc; text-align:center; padding:30px;">Memuat pengumuman...</div>';
        
        const docRef = doc(db, "announcements", announcementId);
        const docSnap = await getDoc(docRef);
        
        if (!docSnap.exists()) {
            throw new Error("Pengumuman tidak ditemukan");
        }
        
        const announcement = docSnap.data();
        const waktu = announcement.timestamp?.toDate ? announcement.timestamp.toDate() : new Date();
        
        // Render the announcement
        container.innerHTML = `
            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                    <h2 style="color: #ff6b6b; font-size: 28px; margin: 0;">${announcement.title}</h2>
                    <div style="color: #aaa; font-size: 14px;">${formatTimeAgo(waktu)}</div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div class="feedback-avatar" style="width: 40px; height: 40px; font-size: 18px;">
                        ${announcement.userName?.charAt(0).toUpperCase() || 'A'}
                    </div>
                    <div>
                        <div style="color: white; font-weight: 500;">${announcement.userName || 'Admin'}</div>
                        <div style="color: #aaa; font-size: 12px;">${announcement.userEmail || ''}</div>
                    </div>
                </div>
                
                <div style="color: #ddd; font-size: 16px; line-height: 1.6; white-space: pre-line; margin-bottom: 20px;">
                    ${announcement.content}
                </div>
                
                <div style="display: flex; gap: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                    <button class="like-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                        </svg>
                        <span class="like-count" style="margin-left: 5px;">${announcement.likesCount || 0}</span>
                    </button>
                    
                    <div style="display: flex; align-items: center; color: #ccc;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span class="view-count" style="margin-left: 5px;">${announcement.views || 0}</span>
                    </div>
                </div>
            </div>
        `;
        
        // Load replies
        await loadAnnouncementReplies(announcementId);
        
        // Setup admin controls if user is admin
        if (isUserAdmin(auth.currentUser)) {
            setupAdminAnnouncementUI(auth.currentUser, announcementId, announcement);
        }
        
    } catch (error) {
        console.error("Error loading announcement:", error);
        const container = document.getElementById('announcementDetailContainer');
        container.innerHTML = `
            <div style="color:#ff6b6b; text-align:center; padding:30px;">
                Gagal memuat pengumuman: ${error.message}
                <button onclick="backToFeedbackPage()" style="margin-top: 15px; padding: 8px 16px; background: none; border: 1px solid #ff6b6b; color: #ff6b6b; cursor: pointer;">
                    Kembali ke Halaman Masukan
                </button>
            </div>
        `;
    }
}






// Fungsi untuk memuat balasan
async function loadAnnouncementReplies(announcementId) {
  const repliesList = document.getElementById('announcementRepliesList');
  if (!repliesList) return;

  repliesList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Memuat balasan...</div>';

  try {
    const q = query(
      collection(db, "announcements", announcementId, "replies"),
      orderBy("timestamp", "asc")
    );
    
    const querySnapshot = await getDocs(q);
    
    repliesList.innerHTML = '';
    
    if (querySnapshot.empty) {
      repliesList.innerHTML = '<div style="color:#ccc; text-align:center; padding:20px;">Belum ada balasan</div>';
      return;
    }
    
    querySnapshot.forEach(doc => {
      const reply = doc.data();
      const waktu = reply.timestamp?.toDate ? reply.timestamp.toDate() : new Date();
      
      const replyElement = document.createElement('div');
      replyElement.style.cssText = 'padding: 15px; background: rgba(255,255,255,0.03); border-radius: 10px;';
      
      replyElement.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
          <div style="width: 30px; height: 30px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; color: white;">
            ${reply.userName?.charAt(0).toUpperCase() || 'U'}
          </div>
          <div>
            <div style="color: white; font-size: 14px; font-weight: 500;">${reply.userName || 'User'}</div>
            <div style="color: #aaa; font-size: 12px;">${formatTimeAgo(waktu)}</div>
          </div>
        </div>
        <div style="margin-top: 10px; font-size: 15px; line-height: 1.5; color: #ddd;">
          ${reply.content}
        </div>
      `;
      
      repliesList.appendChild(replyElement);
    });
    
    // Update jumlah balasan
    document.getElementById('repliesCount').textContent = querySnapshot.size;

  } catch (error) {
    console.error("Error loading replies:", error);
    repliesList.innerHTML = '<div style="color:#ff6b6b; text-align:center; padding:20px;">Gagal memuat balasan</div>';
  }
}







async function getAnnouncementLikesCount(announcementId) {
    try {
        const likesRef = collection(db, "announcements", announcementId, "likes");
        const snapshot = await getCountFromServer(likesRef);
        return snapshot.data().count;
    } catch (error) {
        console.error("Error getting likes count:", error);
        return 0;
    }
}

async function toggleAnnouncementLike(announcementId) {
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login untuk memberikan like');
        return;
    }
    
    try {
        const likeRef = doc(db, "announcements", announcementId, "likes", user.uid);
        const likeDoc = await getDoc(likeRef);
        
        if (likeDoc.exists()) {
            await deleteDoc(likeRef);
        } else {
            await setDoc(likeRef, {
                userId: user.uid,
                timestamp: serverTimestamp()
            });
        }
        
        // Update UI
        const likeBtn = document.querySelector('#page9 .like-btn');
        const likeCount = document.querySelector('#page9 .like-count');
        
        if (likeBtn && likeCount) {
            const currentCount = parseInt(likeCount.textContent);
            const isLiked = likeBtn.querySelector('svg').getAttribute('fill') !== 'none';
            
            likeBtn.querySelector('svg').setAttribute('fill', isLiked ? 'none' : 'currentColor');
            likeCount.textContent = isLiked ? currentCount - 1 : currentCount + 1;
        }
    } catch (error) {
        console.error("Error toggling announcement like:", error);
    }
}




// Fungsi untuk menambahkan history edit
async function addEditHistory(announcementId, editedBy, changes) {
  try {
    const historyRef = collection(db, "announcements", announcementId, "editHistory");
    await addDoc(historyRef, {
      editedBy: editedBy,
      changes: changes,
      timestamp: serverTimestamp(),
      userEmail: auth.currentUser.email,
      userName: auth.currentUser.displayName || 'Admin'
    });
  } catch (error) {
    console.error("Error adding edit history:", error);
  }
}

// Fungsi untuk memuat history edit
async function loadEditHistory(announcementId) {
  const historyContainer = document.getElementById('editHistoryContainer');
  const historyList = document.getElementById('editHistoryList');
  
  if (!historyContainer || !historyList) return;

  try {
    const q = query(
      collection(db, "announcements", announcementId, "editHistory"),
      orderBy("timestamp", "desc"),
      limit(5)
    );
    
    const querySnapshot = await getDocs(q);
    historyList.innerHTML = '';
    
    if (querySnapshot.empty) {
      historyList.innerHTML = '<div style="color:#ccc; text-align:center; padding:10px;">Belum ada riwayat perubahan</div>';
      return;
    }

    querySnapshot.forEach(doc => {
      const history = doc.data();
      const waktu = history.timestamp?.toDate ? history.timestamp.toDate() : new Date();
      
      const historyItem = document.createElement('div');
      historyItem.style.cssText = 'padding: 10px; margin-bottom: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;';
      
      historyItem.innerHTML = `
        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
          <div style="color: #4ea1ff; font-weight: 500;">${history.userName || 'Admin'}</div>
          <div style="color: #aaa; font-size: 12px;">${formatTimeAgo(waktu)}</div>
        </div>
        <div style="color: #ddd; font-size: 14px;">
          ${renderChanges(history.changes)}
        </div>
      `;
      
      historyList.appendChild(historyItem);
    });
    
    historyContainer.style.display = 'block';
    
  } catch (error) {
    console.error("Error loading edit history:", error);
    historyList.innerHTML = '<div style="color:#ff6b6b; text-align:center; padding:10px;">Gagal memuat riwayat</div>';
  }
}

// Fungsi untuk merender perubahan
function renderChanges(changes) {
  let html = '';
  for (const [field, value] of Object.entries(changes)) {
    html += `
      <div style="margin-bottom: 5px;">
        <span style="color: #ff6b6b;">${fieldToLabel(field)}:</span>
        <div style="background: rgba(255,107,107,0.1); padding: 5px 8px; border-radius: 4px; margin-top: 3px;">
          ${value}
        </div>
      </div>
    `;
  }
  return html || '<span style="color:#aaa;">Tidak ada detail perubahan</span>';
}

// Fungsi untuk mengubah nama field menjadi label
function fieldToLabel(field) {
  const labels = {
    'title': 'Judul',
    'content': 'Isi',
    'pinned': 'Status Pin'
  };
  return labels[field] || field;
}














// Fungsi untuk memuat pengumuman terkait
async function loadRelatedAnnouncements(announcementId) {
  const relatedList = document.getElementById('relatedAnnouncementsList');
  if (!relatedList) return;

  relatedList.innerHTML = '<div style="color:#ccc; text-align:center; padding:10px;">Memuat pengumuman terkait...</div>';

  try {
    const q = query(
      collection(db, "announcements"),
      where("pinned", "==", true),
      orderBy("timestamp", "desc"),
      limit(3)
    );
    
    const querySnapshot = await getDocs(q);
    relatedList.innerHTML = '';
    
    let addedCount = 0;
    querySnapshot.forEach(doc => {
      if (doc.id === announcementId || addedCount >= 3) return;
      
      addedCount++;
      const announcement = doc.data();
      const waktu = announcement.timestamp?.toDate ? announcement.timestamp.toDate() : new Date();
      
      const item = document.createElement('div');
      item.style.cssText = 'padding: 15px; background: rgba(255,255,255,0.03); border-radius: 10px; cursor: pointer;';
      item.onclick = () => showAnnouncementDetailById(doc.id);
      
      item.innerHTML = `
        <h3 style="color: #4ea1ff; font-size: 16px; margin-bottom: 5px;">
          ${announcement.title.substring(0, 50)}${announcement.title.length > 50 ? '...' : ''}
        </h3>
        <div style="color: #aaa; font-size: 14px;">
          ${announcement.content.substring(0, 80)}${announcement.content.length > 80 ? '...' : ''}
        </div>
        <div style="color: #666; font-size: 12px; margin-top: 5px;">${formatTimeAgo(waktu)}</div>
      `;
      
      relatedList.appendChild(item);
    });
    
    if (addedCount === 0) {
      relatedList.innerHTML = '<div style="color:#ccc; text-align:center; padding:10px;">Tidak ada pengumuman terkait</div>';
    }
  } catch (error) {
    console.error("Error loading related announcements:", error);
    relatedList.innerHTML = '<div style="color:#ff6b6b; text-align:center; padding:10px;">Gagal memuat pengumuman terkait</div>';
  }
}












// Fungsi untuk mendapatkan jumlah balasan
async function getAnnouncementRepliesCount(announcementId) {
  try {
    const repliesRef = collection(db, "announcements", announcementId, "replies");
    const snapshot = await getCountFromServer(repliesRef);
    return snapshot.data().count;
  } catch (error) {
    console.error("Error getting replies count:", error);
    return 0;
  }
}




async function viewAnnouncementDetails(announcementId) {
    try {
        // Ambil data pengumuman dari Firestore
        const docRef = doc(db, "announcements", announcementId);
        const docSnap = await getDoc(docRef);
        
        if (!docSnap.exists()) {
            throw new Error("Pengumuman tidak ditemukan");
        }
        
        const announcement = docSnap.data();
        const waktu = announcement.timestamp?.toDate ? announcement.timestamp.toDate() : new Date();
        
        // Render ke dalam container yang sama dengan halaman masukan
        const feedbackList = document.getElementById('feedbackListContainer');
        feedbackList.innerHTML = `
            <div class="feedback-item announcement-item" style="border-left: 4px solid #ff6b6b;">
                <div class="feedback-header">
                    <div class="feedback-user">
                        <div class="feedback-avatar">${announcement.userName?.charAt(0).toUpperCase() || 'A'}</div>
                        <div>
                            <div style="color: white; font-weight: 500;">${announcement.userName || 'Admin'}</div>
                            <div style="color: #aaa; font-size: 12px;">${announcement.userEmail || ''}</div>
                        </div>
                    </div>
                    <div class="feedback-time">${formatTimeAgo(waktu)}</div>
                </div>
                
                <div class="feedback-title">${announcement.title}</div>
                <div class="feedback-content" style="white-space: pre-line;">${announcement.content}</div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button id="backToAnnouncements" style="background: none; border: none; color: #4ea1ff; cursor: pointer;">
                        ← Kembali ke Daftar Pengumuman
                    </button>
                </div>
            </div>
            
            <!-- Bagian untuk replies -->
            <div id="announcementRepliesContainer" style="margin-top: 30px;">
                <h3 style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
                    Balasan (${announcement.repliesCount || 0})
                </h3>
                <div id="announcementRepliesList"></div>
                
                <form id="announcementReplyForm" style="margin-top: 20px;">
                    <textarea id="announcementReplyContent" rows="3" placeholder="Tulis balasan Anda..." 
                              style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); 
                                     border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; 
                                     color: white; margin-bottom: 10px;"></textarea>
                    <button type="submit" style="padding: 8px 15px; background: #4ea1ff; border: none; 
                                                border-radius: 8px; color: white; cursor: pointer;">
                        Kirim Balasan
                    </button>
                </form>
            </div>
        `;
        
        // Load replies
        await loadAnnouncementReplies(announcementId);
        
        // Tambahkan event listener untuk tombol kembali
        document.getElementById('backToAnnouncements').addEventListener('click', () => {
            loadPinnedAnnouncements();
        });
        
        // Tambahkan event listener untuk form reply
        document.getElementById('announcementReplyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            await submitAnnouncementReply(announcementId);
        });
        
    } catch (error) {
        console.error("Error loading announcement:", error);
        const feedbackList = document.getElementById('feedbackListContainer');
        feedbackList.innerHTML = `
            <div class="feedback-item" style="color: #ff6b6b; text-align: center; padding: 30px;">
                Gagal memuat pengumuman: ${error.message}
                <button id="backToAnnouncements" style="display: block; margin: 20px auto; padding: 8px 15px; 
                                                     background: none; border: 1px solid #ff6b6b; 
                                                     color: #ff6b6b; cursor: pointer;">
                    Kembali ke Daftar Pengumuman
                </button>
            </div>
        `;
        document.getElementById('backToAnnouncements').addEventListener('click', () => {
            loadPinnedAnnouncements();
        });
    }
}






// Fungsi untuk render detail pengumuman
function renderAnnouncementDetail(announcement, waktu) {
  const container = document.getElementById('announcementDetailContainer');
  
  container.innerHTML = `
    <div style="margin-bottom: 20px;">
      <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
        <h2 style="color: #ff6b6b; font-size: 28px; margin: 0;">${announcement.title}</h2>
        <div style="color: #aaa; font-size: 14px;">${formatTimeAgo(waktu)}</div>
      </div>
      
      <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
        <div class="feedback-avatar" style="width: 40px; height: 40px; font-size: 18px;">
          ${announcement.userName?.charAt(0).toUpperCase() || 'A'}
        </div>
        <div>
          <div style="color: white; font-weight: 500;">${announcement.userName || 'Admin'}</div>
          <div style="color: #aaa; font-size: 12px;">${announcement.userEmail || ''}</div>
        </div>
      </div>
      
      <div style="color: #ddd; font-size: 16px; line-height: 1.6; white-space: pre-line; margin-bottom: 20px;">
        ${announcement.content}
      </div>
      
      <div style="display: flex; gap: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
        <button class="like-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
          </svg>
          <span class="like-count" style="margin-left: 5px;">${announcement.likesCount || 0}</span>
        </button>
        
        <div style="display: flex; align-items: center; color: #ccc;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          <span class="view-count" style="margin-left: 5px;">${announcement.views || 0}</span>
        </div>
      </div>
    </div>
  `;
  
  // Tambahkan event listener untuk like button
  container.querySelector('.like-btn').addEventListener('click', () => {
    toggleAnnouncementLike(announcement.id);
  });
}




function renderDetailPengumuman(data) {
  const detailContainer = document.getElementById("page9Content");
  if (!detailContainer) return;

  detailContainer.innerHTML = `
    <h2>${data.title}</h2>
    <p>${data.content}</p>
    <small>Dibuat oleh: ${data.author || "Anonim"}</small>
  `;
}




// Fungsi untuk mengecek status admin
function isUserAdmin(user) {
  if (!user || !user.email) return false;
  const adminEmails = ['faridardiansyah061@gmail.com']; // Ganti dengan email admin yang valid
  return adminEmails.includes(user.email.toLowerCase());
}















// Function to handle admin UI for announcements
function setupAdminAnnouncementUI(user, announcementId, announcement) {
  const adminForm = document.getElementById('adminAnnouncementForm');
  const isAdmin = isUserAdmin(user); // Use the separate function
  
  if (isAdmin) {
    adminForm.style.display = 'block';
    document.getElementById('editAnnouncementTitle').value = announcement.title;
    document.getElementById('editAnnouncementContent').value = announcement.content;

    document.getElementById('editAnnouncementForm').onsubmit = (e) => {
      e.preventDefault();
      updateAnnouncement(announcementId);
    };

    document.getElementById('cancelEditAnnouncement').onclick = () => {
      adminForm.style.display = 'none';
    };

    document.getElementById('deleteAnnouncement').onclick = () => {
      if (confirm('Apakah Anda yakin ingin menghapus pengumuman ini?')) {
        deleteAnnouncement(announcementId);
      }
    };
  } else {
    adminForm.style.display = 'none';
  }
}













// Fungsi untuk mengecek status admin dan menampilkan form edit jika admin
function checkAdminStatus(user, announcementId, announcement) {
const isAdmin = checkAdminStatus(user); // Use the existing function
  const adminForm = document.getElementById('adminAnnouncementForm');
  
  if (isAdmin) {
    adminForm.style.display = 'block';

    // Isi form edit dengan data pengumuman
    document.getElementById('editAnnouncementTitle').value = announcement.title;
    document.getElementById('editAnnouncementContent').value = announcement.content;

    // Setup event listeners untuk form edit
    document.getElementById('editAnnouncementForm').onsubmit = (e) => {
      e.preventDefault();
      updateAnnouncement(announcementId);
    };

    document.getElementById('cancelEditAnnouncement').onclick = () => {
      adminForm.style.display = 'none';
    };

    document.getElementById('deleteAnnouncement').onclick = () => {
      if (confirm('Apakah Anda yakin ingin menghapus pengumuman ini?')) {
        deleteAnnouncement(announcementId);
      }
    };
  } else {
    adminForm.style.display = 'none';
  }
}







// Fungsi untuk setup form balasan
function setupReplyForm(announcementId) {
  const user = auth.currentUser;
  const replyForm = document.getElementById('announcementReplyForm');
  const loginToReply = document.getElementById('loginToReply');
  
  if (user) {
    replyForm.style.display = 'block';
    loginToReply.style.display = 'none';
    
    replyForm.onsubmit = async (e) => {
      e.preventDefault();
      const content = document.getElementById('announcementReplyContent').value.trim();
      
      if (!content) {
        alert('Isi balasan tidak boleh kosong');
        return;
      }
      
      const submitBtn = replyForm.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'Mengirim...';
      
      try {
      await addDoc(collection(db, "announcements", announcementId, "replies"), {
  content,
  userId: user.uid,
  userName: user.displayName || 'Anonymous',
  userEmail: user.email,
  userPhoto: user.photoURL || '',
  timestamp: serverTimestamp()
});
        
        // Update reply count
        await updateDoc(doc(db, "announcements", announcementId), {
          repliesCount: increment(1)
        });
        
        // Refresh replies
        await loadAnnouncementReplies(announcementId);
        
        // Reset form
        document.getElementById('announcementReplyContent').value = '';
        
      } catch (error) {
        console.error("Error submitting reply:", error);
        alert('Gagal mengirim balasan');
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    };
  } else {
    replyForm.style.display = 'none';
    loginToReply.style.display = 'block';
    
    document.getElementById('loginLink').onclick = (e) => {
      e.preventDefault();
      // Implement login logic here
      alert('Silakan login terlebih dahulu');
    };
  }
}







// Modifikasi fungsi updateAnnouncement untuk menyimpan history
async function updateAnnouncement(announcementId) {
  const title = document.getElementById('editAnnouncementTitle').value.trim();
  const content = document.getElementById('editAnnouncementContent').value.trim();
  
  if (!title || !content) {
    showNotification('Judul dan isi pengumuman tidak boleh kosong!', 'error');
    return;
  }

  const submitBtn = document.querySelector('#editAnnouncementForm button[type="submit"]');
  const originalText = submitBtn.innerHTML;
  submitBtn.disabled = true;
  submitBtn.innerHTML = 'Menyimpan...';

  try {
    // Dapatkan data sebelum diubah untuk membandingkan perubahan
    const docRef = doc(db, "announcements", announcementId);
    const docSnap = await getDoc(docRef);
    const oldData = docSnap.data();
    
    const changes = {};
    
    // Catat perubahan judul
    if (oldData.title !== title) {
      changes.title = title;
    }
    
    // Catat perubahan isi
    if (oldData.content !== content) {
      changes.content = content;
    }
    
    // Jika ada perubahan, simpan ke history
    if (Object.keys(changes).length > 0) {
      await addEditHistory(
        announcementId, 
        auth.currentUser.displayName || 'Admin',
        changes
      );
    }
    
    // Update dokumen utama
    await updateDoc(docRef, {
      title,
      content,
      lastUpdated: serverTimestamp()
    });

    showNotification('Pengumuman berhasil diperbarui!', 'success');
    
    // Refresh data pengumuman dan history
    await showAnnouncementDetailById(announcementId);
    await loadEditHistory(announcementId);
    
  } catch (error) {
    console.error("Error updating announcement:", error);
    showNotification('Gagal memperbarui pengumuman: ' + error.message, 'error');
  } finally {
    submitBtn.disabled = false;
    submitBtn.innerHTML = originalText;
  }
}















// Fungsi untuk mengirim balasan
async function submitAnnouncementReply(announcementId) {
  const content = document.getElementById('announcementReplyContent').value.trim();
  if (!content) {
    alert('Isi balasan tidak boleh kosong');
    return;
  }
  
  const user = auth.currentUser;
  if (!user) {
    alert('Silakan login untuk membalas');
    return;
  }
  
  const submitBtn = document.querySelector('#announcementReplyForm button[type="submit"]');
  const originalText = submitBtn.innerHTML;
  submitBtn.disabled = true;
  submitBtn.innerHTML = 'Mengirim...';
  
  try {
    await addDoc(collection(db, "announcements", announcementId, "replies"), {
  content,
  userId: user.uid,
  userName: user.displayName || 'Anonymous',
  userEmail: user.email,
  userPhoto: user.photoURL || '',
  timestamp: serverTimestamp()
});
    
    // Update reply count
    await updateDoc(doc(db, "announcements", announcementId), {
      repliesCount: increment(1)
    });
    
    // Reset form dan muat ulang balasan
    document.getElementById('announcementReplyContent').value = '';
    await loadAnnouncementReplies(announcementId);
    
  } catch (error) {
    console.error("Error submitting reply:", error);
    alert('Gagal mengirim balasan');
  } finally {
    submitBtn.disabled = false;
    submitBtn.innerHTML = originalText;
  }
}










// Fungsi untuk setup event listeners di halaman detail
function setupAnnouncementDetailEvents(announcementId) {
  // Tombol like
  document.querySelector('#announcementDetailContainer .like-btn')?.addEventListener('click', async () => {
    await toggleAnnouncementLike(announcementId);
    // Update like count
    const likesCount = await getAnnouncementLikesCount(announcementId);
    document.querySelector('#announcementDetailContainer .like-count').textContent = likesCount;
  });

  // Tombol kembali
  document.getElementById('backToAnnouncements')?.addEventListener('click', () => {
    document.getElementById('page9').style.display = 'none';
    document.getElementById('page7').style.display = 'block';
    history.pushState({ page: "masukan" }, "Halaman Masukan", "/halaman-masukan");
  });

  // Form balasan
  document.getElementById('announcementReplyForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    await submitAnnouncementReply(announcementId);
  });
}

// Fungsi untuk menampilkan halaman error
function showErrorPage(message) {
  const container = document.getElementById('announcementDetailContainer');
  if (container) {
    container.innerHTML = `
      <div style="color: #ff6b6b; text-align: center; padding: 30px;">
        <h3 style="margin-bottom: 15px;">Terjadi Kesalahan</h3>
        <p style="margin-bottom: 20px;">${message}</p>
        <button onclick="location.reload()" style="padding: 8px 16px; background: #ff6b6b; color: white; border: none; border-radius: 4px; cursor: pointer;">
          Muat Ulang Halaman
        </button>
      </div>
    `;
  }
}

// Fungsi untuk mengirim balasan pengumuman
async function submitAnnouncementReply(announcementId) {
  const user = auth.currentUser;
  if (!user) {
    alert('Silakan login untuk membalas pengumuman');
    return;
  }

  const content = document.getElementById('announcementReplyContent').value.trim();
  if (!content) {
    alert('Isi balasan tidak boleh kosong');
    return;
  }

  const submitBtn = document.querySelector('#announcementReplyForm button[type="submit"]');
  const originalText = submitBtn.innerHTML;
  submitBtn.disabled = true;
  submitBtn.innerHTML = 'Mengirim...';

  try {
    // Tambahkan balasan ke Firestore
    const repliesRef = collection(db, "announcements", announcementId, "replies");
    await addDoc(repliesRef, {
      content,
      userId: user.uid,
      userName: user.displayName || 'Anonymous',
      userEmail: user.email,
      timestamp: serverTimestamp()
    });

    // Update jumlah balasan
    const announcementRef = doc(db, "announcements", announcementId);
    await updateDoc(announcementRef, {
      repliesCount: increment(1)
    });

    // Perbarui tampilan
    const repliesCount = await getAnnouncementRepliesCount(announcementId);
    document.getElementById('repliesCount').textContent = repliesCount;
    await loadAnnouncementReplies(announcementId);

    // Reset form
    document.getElementById('announcementReplyContent').value = '';

  } catch (error) {
    console.error("Error submitting reply:", error);
    alert('Gagal mengirim balasan');
  } finally {
    submitBtn.disabled = false;
    submitBtn.innerHTML = originalText;
  }
}













// Variabel untuk menyimpan data history
let editHistoryData = [];
let currentComparisonIndex = 0;

// Fungsi untuk menampilkan modal perbandingan
async function showEditComparison(announcementId) {
  try {
    // Dapatkan data history dari Firestore
    const q = query(
      collection(db, "announcements", announcementId, "editHistory"),
      orderBy("timestamp", "desc")
    );
    const querySnapshot = await getDocs(q);
    
    if (querySnapshot.empty) {
      throw new Error("Tidak ada riwayat perubahan");
    }
    
    // Simpan data history
    editHistoryData = [];
    querySnapshot.forEach(doc => {
      const history = doc.data();
      editHistoryData.push({
        id: doc.id,
        ...history,
        timestamp: history.timestamp?.toDate ? history.timestamp.toDate() : new Date()
      });
    });
    
    // Reset index
    currentComparisonIndex = 0;
    
    // Tampilkan modal
    document.getElementById('editComparisonModal').style.display = 'flex';
    
    // Tampilkan perubahan pertama
    displayComparison(currentComparisonIndex);
    
  } catch (error) {
    console.error("Error showing edit comparison:", error);
    alert('Gagal memuat riwayat perubahan: ' + error.message);
  }
}

// Fungsi untuk menampilkan perbandingan tertentu
function displayComparison(index) {
  if (index < 0 || index >= editHistoryData.length) return;
  
  const history = editHistoryData[index];
  
  // Update info pengguna
  const userPhoto = document.getElementById('comparisonUserPhoto');
  const userInitial = document.getElementById('comparisonUserInitial');
  const userName = document.getElementById('comparisonUserName');
  const editDate = document.getElementById('comparisonEditDate');
  
  if (history.userPhoto) {
    userPhoto.src = history.userPhoto;
    userPhoto.style.display = 'block';
    userInitial.style.display = 'none';
  } else {
    userInitial.textContent = history.userName?.charAt(0).toUpperCase() || 'A';
    userInitial.style.display = 'flex';
    userPhoto.style.display = 'none';
  }
  
  userName.textContent = history.userName || 'Admin';
  editDate.textContent = formatFullDate(history.timestamp);
  
  // Update counter
  document.getElementById('comparisonCounter').textContent = 
    `Perubahan ${index + 1} dari ${editHistoryData.length}`;
  
  // Update tombol navigasi
  document.getElementById('prevComparison').disabled = index === 0;
  document.getElementById('nextComparison').disabled = index === editHistoryData.length - 1;
  
  // Dapatkan data sebelum perubahan (data sebelumnya dalam array)
  const beforeData = index < editHistoryData.length - 1 ? 
    editHistoryData[index + 1] : 
    { title: history.changes.oldTitle || '', content: history.changes.oldContent || '' };
  
  // Tampilkan perbandingan
  const beforeEdit = document.getElementById('beforeEditContent');
  const afterEdit = document.getElementById('afterEditContent');
  
  // Judul
  beforeEdit.innerHTML = `
    <div style="margin-bottom: 20px;">
      <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Judul:</div>
      <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">
        ${beforeData.title || history.changes.oldTitle || '(Tidak ada judul)'}
      </div>
    </div>
    <div>
      <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Isi:</div>
      <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px; white-space: pre-line;">
        ${beforeData.content || history.changes.oldContent || '(Tidak ada konten)'}
      </div>
    </div>
  `;
  
  // Highlight perubahan
  afterEdit.innerHTML = `
    <div style="margin-bottom: 20px;">
      <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Judul:</div>
      <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">
        ${highlightTextChanges(
          beforeData.title || history.changes.oldTitle || '', 
          history.changes.title || history.changes.newTitle || ''
        )}
      </div>
    </div>
    <div>
      <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Isi:</div>
      <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px; white-space: pre-line;">
        ${highlightTextChanges(
          beforeData.content || history.changes.oldContent || '', 
          history.changes.content || history.changes.newContent || ''
        )}
      </div>
    </div>
  `;
}

// Fungsi untuk memformat tanggal lengkap
function formatFullDate(date) {
  if (!date) return 'Tanggal tidak diketahui';
  
  const options = { 
    day: 'numeric', 
    month: 'long', 
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  };
  return date.toLocaleDateString('id-ID', options);
}

// Fungsi untuk highlight perubahan teks (versi sederhana)
function highlightTextChanges(oldText, newText) {
  if (oldText === newText) return newText || '(Tidak ada perubahan)';
  
  // Ini adalah implementasi sederhana, Anda bisa menggunakan library diff seperti diff-match-patch
  // untuk hasil yang lebih akurat
  
  // Jika teks baru lebih panjang, anggap ada penambahan
  if (newText.length > oldText.length) {
    const unchangedPart = oldText;
    const addedPart = newText.substring(oldText.length);
    
    return `${unchangedPart}<span style="background-color: rgba(78,161,255,0.3); border-left: 2px solid #4ea1ff; padding-left: 4px;">${addedPart}</span>`;
  } 
  // Jika teks baru lebih pendek, anggap ada penghapusan
  else if (newText.length < oldText.length) {
    const unchangedPart = newText;
    const removedPart = oldText.substring(newText.length);
    
    return `${unchangedPart}<span style="background-color: rgba(255,107,107,0.3); border-left: 2px solid #ff6b6b; padding-left: 4px; text-decoration: line-through;">${removedPart}</span>`;
  }
  // Jika panjang sama tapi berbeda konten
  else {
    return `<span style="background-color: rgba(255,255,0,0.3); border-left: 2px solid yellow; padding-left: 4px;">${newText}</span>`;
  }
}

// Event listeners untuk navigasi
document.getElementById('prevComparison')?.addEventListener('click', () => {
  if (currentComparisonIndex > 0) {
    currentComparisonIndex--;
    displayComparison(currentComparisonIndex);
  }
});

document.getElementById('nextComparison')?.addEventListener('click', () => {
  if (currentComparisonIndex < editHistoryData.length - 1) {
    currentComparisonIndex++;
    displayComparison(currentComparisonIndex);
  }
});

// Event listener untuk tombol close
document.getElementById('closeEditComparison')?.addEventListener('click', () => {
  document.getElementById('editComparisonModal').style.display = 'none';
});

// Event listener untuk klik di luar modal
document.getElementById('editComparisonModal')?.addEventListener('click', function(e) {
  if (e.target === this) {
    document.getElementById('editComparisonModal').style.display = 'none';
  }
});





// Fungsi untuk menutup popup perbandingan
function closeEditComparison() {
  document.getElementById('editComparisonModal').style.display = 'none';
}








































































// Global variables for forum
let allDiscussions = [];
let filteredDiscussions = [];
let currentPage = 1;
const discussionsPerPage = 10;





// Forum Diskusi Functions
function initializeForumPage() {
  // Load discussions from Firebase
  loadDiscussions();
  
  // Event listeners
  document.getElementById('searchForumBtn').addEventListener('click', searchDiscussions);
  document.getElementById('forumSearch').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') searchDiscussions();
  });
  
  // Category filter
  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.category-btn').forEach(b => {
        b.style.background = 'rgba(255,255,255,0.05)';
        b.style.border = '1px solid rgba(255,255,255,0.2)';
        b.style.color = 'white';
      });
      
      this.style.background = 'rgba(78, 161, 255, 0.2)';
      this.style.border = '1px solid rgba(78, 161, 255, 0.5)';
      this.style.color = '#4ea1ff';
      
      const category = this.getAttribute('data-category');
      filterDiscussionsByCategory(category);
    });
  });
  
  // Discussion filter
  document.getElementById('filterLatest').addEventListener('click', function() {
    document.getElementById('filterLatest').style.background = 'rgba(78, 161, 255, 0.2)';
    document.getElementById('filterLatest').style.border = '1px solid rgba(78, 161, 255, 0.5)';
    document.getElementById('filterLatest').style.color = '#4ea1ff';
    
    document.getElementById('filterHot').style.background = 'rgba(255,255,255,0.05)';
    document.getElementById('filterHot').style.border = '1px solid rgba(255,255,255,0.2)';
    document.getElementById('filterHot').style.color = 'white';
    
    filterDiscussions('latest');
  });
  
  document.getElementById('filterHot').addEventListener('click', function() {
    document.getElementById('filterHot').style.background = 'rgba(244, 67, 54, 0.2)';
    document.getElementById('filterHot').style.border = '1px solid rgba(244, 67, 54, 0.5)';
    document.getElementById('filterHot').style.color = '#F44336';
    
    document.getElementById('filterLatest').style.background = 'rgba(255,255,255,0.05)';
    document.getElementById('filterLatest').style.border = '1px solid rgba(255,255,255,0.2)';
    document.getElementById('filterLatest').style.color = 'white';
    
    filterDiscussions('hot');
  });
  
  // New discussion modal
  document.getElementById('newDiscussionBtn').addEventListener('click', function() {
    const user = auth.currentUser;
    if (!user) {
      alert('Silakan login terlebih dahulu untuk membuat diskusi baru');
      return;
    }
    document.getElementById('newDiscussionModal').style.display = 'flex';
  });
  
  document.getElementById('cancelDiscussion').addEventListener('click', function() {
    document.getElementById('newDiscussionModal').style.display = 'none';
    document.getElementById('newDiscussionForm').reset();
  });
  
  document.getElementById('newDiscussionForm').addEventListener('submit', function(e) {
    e.preventDefault();
    createNewDiscussion();
  });
  
  // Pagination
  document.getElementById('prevPageBtn').addEventListener('click', goToPrevPage);
  document.getElementById('nextPageBtn').addEventListener('click', goToNextPage);
}


// Load discussions from Firebase
async function loadDiscussions() {
  try {
    const q = query(collection(db, "discussions"), orderBy("createdAt", "desc"));
    const querySnapshot = await getDocs(q);
    
    allDiscussions = [];
    querySnapshot.forEach(doc => {
      const discussion = doc.data();
      discussion.id = doc.id;
      allDiscussions.push(discussion);
    });
    
    filteredDiscussions = [...allDiscussions];
    displayDiscussions();
  } catch (error) {
    console.error("Error loading discussions:", error);
    alert("Gagal memuat diskusi. Silakan coba lagi nanti.");
  }
}

// Display discussions with pagination
function displayDiscussions() {
  const startIndex = (currentPage - 1) * discussionsPerPage;
  const endIndex = startIndex + discussionsPerPage;
  const paginatedDiscussions = filteredDiscussions.slice(startIndex, endIndex);
  
  const discussionList = document.getElementById('discussionList');
  discussionList.innerHTML = '';
  
  if (paginatedDiscussions.length === 0) {
    discussionList.innerHTML = '<div style="color: #ccc; text-align: center; padding: 40px;">Tidak ada diskusi yang ditemukan</div>';
    return;
  }
  
  paginatedDiscussions.forEach(discussion => {
    const discussionItem = document.createElement('div');
    discussionItem.className = 'bab-card discussion-item';
    discussionItem.style.marginBottom = '20px';
    discussionItem.style.padding = '20px';
    discussionItem.style.transition = 'all 0.3s';
    discussionItem.style.cursor = 'pointer';
    discussionItem.dataset.id = discussion.id;
    discussionItem.dataset.category = discussion.category;
    discussionItem.dataset.views = discussion.views || 0;
    discussionItem.dataset.replies = discussion.replyCount || 0;
    discussionItem.dataset.createdAt = discussion.createdAt?.toDate().getTime() || new Date().getTime();
    
    // Get first letter of author name for avatar
    const authorInitial = discussion.authorName ? discussion.authorName.charAt(0).toUpperCase() : 'A';
    
    // Format time
    const createdAt = discussion.createdAt?.toDate() || new Date();
    const timeAgo = formatTimeAgo(createdAt);
    
    discussionItem.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #4ea1ff; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
            ${authorInitial}
          </div>
          <div>
            <div style="color: white; font-weight: bold;">${discussion.authorName || 'Anonymous'}</div>
            <div style="color: #aaa; font-size: 12px;">${timeAgo}</div>
          </div>
        </div>
        <span style="color: ${getCategoryColor(discussion.category)}; font-size: 14px; background: ${getCategoryBackground(discussion.category)}; padding: 5px 10px; border-radius: 10px;">
          ${getCategoryLabel(discussion.category)}
        </span>
      </div>
      
      <h3 style="color: white; font-size: 20px; margin-bottom: 10px;">
        ${discussion.title}
      </h3>
      
      <p style="color: #ccc; margin-bottom: 15px; line-height: 1.6;">
        ${discussion.content.substring(0, 150)}${discussion.content.length > 150 ? '...' : ''}
      </p>
      
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div style="display: flex; gap: 15px;">
          <div style="display: flex; align-items: center; gap: 5px; color: #ccc;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
            </svg>
            ${discussion.likes || 0}
          </div>
          <div style="display: flex; align-items: center; gap: 5px; color: #ccc;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            ${discussion.replyCount || 0}
          </div>
          <div style="display: flex; align-items: center; gap: 5px; color: #ccc;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            ${discussion.views || 0}
          </div>
        </div>
        
        <a href="#" class="view-discussion" style="color: #4ea1ff; text-decoration: none; display: flex; align-items: center; gap: 5px;">
          Lihat diskusi
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    `;
    
    discussionList.appendChild(discussionItem);
    
    // Add click event to view discussion
    discussionItem.querySelector('.view-discussion').addEventListener('click', function(e) {
      e.preventDefault();
      viewDiscussion(discussion.id);
    });
  });
  
  // Update pagination
  updatePagination();
}

// Filter discussions by category
function filterDiscussionsByCategory(category) {
  if (category === 'all') {
    filteredDiscussions = [...allDiscussions];
  } else {
    filteredDiscussions = allDiscussions.filter(discussion => discussion.category === category);
  }
  
  currentPage = 1;
  displayDiscussions();
}

// Filter discussions by type (latest/hot)
function filterDiscussions(type) {
  if (type === 'latest') {
    filteredDiscussions.sort((a, b) => {
      const dateA = a.createdAt?.toDate() || new Date(0);
      const dateB = b.createdAt?.toDate() || new Date(0);
      return dateB - dateA;
    });
  } else if (type === 'hot') {
    filteredDiscussions.sort((a, b) => {
      const popularityA = (a.replyCount || 0) + (a.likes || 0) + (a.views || 0);
      const popularityB = (b.replyCount || 0) + (b.likes || 0) + (b.views || 0);
      return popularityB - popularityA;
    });
  }
  
  currentPage = 1;
  displayDiscussions();
}

// Search discussions
function searchDiscussions() {
  const searchTerm = document.getElementById('forumSearch').value.toLowerCase();
  
  if (!searchTerm) {
    filteredDiscussions = [...allDiscussions];
  } else {
    filteredDiscussions = allDiscussions.filter(discussion => {
      return discussion.title.toLowerCase().includes(searchTerm) || 
             discussion.content.toLowerCase().includes(searchTerm);
    });
  }
  
  currentPage = 1;
  displayDiscussions();
}


// View discussion details
function viewDiscussion(discussionId) {
  // Increment view count
  const discussionRef = doc(db, "discussions", discussionId);
  updateDoc(discussionRef, {
    views: increment(1)
  });
  
  // TODO: Implement detailed view page or modal
  alert(`Membuka diskusi dengan ID: ${discussionId}`);
}

// Pagination functions
function updatePagination() {
  const totalPages = Math.ceil(filteredDiscussions.length / discussionsPerPage);
  const pageNumbers = document.getElementById('pageNumbers');
  pageNumbers.innerHTML = '';
  
  for (let i = 1; i <= totalPages; i++) {
    const pageBtn = document.createElement('button');
    pageBtn.textContent = i;
    pageBtn.style.padding = '8px 15px';
    pageBtn.style.borderRadius = '8px';
    pageBtn.style.cursor = 'pointer';
    
    if (i === currentPage) {
      pageBtn.style.background = 'rgba(78, 161, 255, 0.2)';
      pageBtn.style.border = '1px solid rgba(78, 161, 255, 0.5)';
      pageBtn.style.color = '#4ea1ff';
    } else {
      pageBtn.style.background = 'rgba(255,255,255,0.05)';
      pageBtn.style.border = '1px solid rgba(255,255,255,0.2)';
      pageBtn.style.color = 'white';
    }
    
    pageBtn.addEventListener('click', () => {
      currentPage = i;
      displayDiscussions();
    });
    
    pageNumbers.appendChild(pageBtn);
  }
  
  // Update prev/next buttons
  document.getElementById('prevPageBtn').disabled = currentPage === 1;
  document.getElementById('nextPageBtn').disabled = currentPage === totalPages;
}

function goToPrevPage() {
  if (currentPage > 1) {
    currentPage--;
    displayDiscussions();
  }
}

function goToNextPage() {
  const totalPages = Math.ceil(filteredDiscussions.length / discussionsPerPage);
  if (currentPage < totalPages) {
    currentPage++;
    displayDiscussions();
  }
}

// Helper functions
function getCategoryLabel(category) {
  const labels = {
    arduino: 'Arduino',
    iot: 'IoT',
    pemrograman: 'Pemrograman',
    elektronik: 'Elektronik',
    lainnya: 'Lainnya'
  };
  return labels[category] || labels.lainnya;
}

function getCategoryColor(category) {
  const colors = {
    arduino: '#4ea1ff',
    iot: '#FFC107',
    pemrograman: '#F44336',
    elektronik: '#4CAF50',
    lainnya: '#9C27B0'
  };
  return colors[category] || '#9C27B0';
}

function getCategoryBackground(category) {
  const colors = {
    arduino: 'rgba(78, 161, 255, 0.1)',
    iot: 'rgba(255, 193, 7, 0.1)',
    pemrograman: 'rgba(244, 67, 54, 0.1)',
    elektronik: 'rgba(76, 175, 80, 0.1)',
    lainnya: 'rgba(156, 39, 176, 0.1)'
  };
  return colors[category] || 'rgba(156, 39, 176, 0.1)';
}

function formatTimeAgo(date) {
  const now = new Date();
  const diffInSeconds = Math.floor((now - date) / 1000);
  
  if (diffInSeconds < 60) return 'baru saja';
  if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit yang lalu`;
  if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam yang lalu`;
  if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} hari yang lalu`;
  
  return date.toLocaleDateString('id-ID', { 
    day: 'numeric', 
    month: 'long', 
    year: 'numeric' 
  });
}

// Initialize forum when page is shown
document.addEventListener('DOMContentLoaded', function() {
  // Check if we're on the forum page
  if (window.location.pathname.includes('/halaman-forum') || 
      (window.history.state && window.history.state.page === 'forum')) {
    initializeForumPage();
  }
  
  // Also initialize when navigating to forum via popstate
  window.addEventListener('popstate', function(event) {
    if (event.state && event.state.page === 'forum') {
      initializeForumPage();
    }
  });
});



// Event listener untuk tombol Diskusi Baru
document.getElementById('newDiscussionBtn').addEventListener('click', function() {
  const user = auth.currentUser;
  if (!user) {
    alert('Silakan login terlebih dahulu untuk membuat diskusi baru');
    return;
  }
  document.getElementById('newDiscussionModal').style.display = 'flex';
});

// Event listener untuk tombol Batal
document.getElementById('cancelDiscussion').addEventListener('click', function() {
  document.getElementById('newDiscussionModal').style.display = 'none';
  document.getElementById('newDiscussionForm').reset();
});

// Event listener untuk submit form
document.getElementById('newDiscussionForm').addEventListener('submit', function(e) {
  e.preventDefault();
  createNewDiscussion();
});





async function createNewDiscussion() {
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login terlebih dahulu untuk membuat diskusi baru');
        return;
    }

    const title = document.getElementById('discussionTitle').value.trim();
    const category = document.getElementById('discussionCategory').value;
    const content = document.getElementById('discussionContent').value.trim();

    if (!title || !category || !content) {
        alert('Semua field harus diisi');
        return;
    }

    const submitBtn = document.getElementById('submitDiscussion');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Membuat...';

    try {
        const newDiscussion = {
            title,
            category,
            content,
            authorId: user.uid,
            authorName: user.displayName || 'Anonymous',
            authorEmail: user.email,
            createdAt: serverTimestamp(),
            views: 0,
            likes: 0,
            replyCount: 0
        };

        const docRef = await addDoc(collection(db, "discussions"), newDiscussion);
        newDiscussion.id = docRef.id;
        newDiscussion.createdAt = new Date();

        // Create notification for followers of this category
        await createNotification(
            'followers-of-' + category, // You'll need to implement getting followers
            'discussion',
            `Diskusi baru dalam ${category}: ${title}`,
            docRef.id,
            `/discussions/${docRef.id}`
        );

        // Update UI
        allDiscussions.unshift(newDiscussion);
        filteredDiscussions.unshift(newDiscussion);
        document.getElementById('newDiscussionForm').reset();
        document.getElementById('newDiscussionModal').style.display = 'none';
        currentPage = 1;
        displayDiscussions();
        
        alert('Diskusi berhasil dibuat!');
    } catch (error) {
        console.error("Error creating discussion:", error);
        alert('Gagal membuat diskusi. Silakan coba lagi nanti.');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
}























// Hapus event listener ganda untuk form diskusi
// Pastikan hanya ada satu event listener untuk form
document.getElementById('newDiscussionForm')?.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const user = auth.currentUser;
    if (!user) {
        alert('Silakan login terlebih dahulu untuk membuat diskusi baru');
        return;
    }

    const title = document.getElementById('discussionTitle').value.trim();
    const category = document.getElementById('discussionCategory').value;
    const content = document.getElementById('discussionContent').value.trim();

    if (!title || !category || !content) {
        alert('Semua field harus diisi');
        return;
    }

    const submitBtn = document.getElementById('submitDiscussion');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Membuat... <span class="loading-spinner"></span>';

    try {
        const newDiscussion = {
            title,
            category,
            content,
            authorId: user.uid,
            authorName: user.displayName || 'Anonymous',
            authorEmail: user.email,
            createdAt: serverTimestamp(),
            views: 0,
            likes: 0,
            replyCount: 0,
            status: 'active'
        };

        // Tambahkan diskusi ke Firestore
        const docRef = await addDoc(collection(db, "discussions"), newDiscussion);
        
        // Tambahkan ke array lokal untuk tampilan langsung
        newDiscussion.id = docRef.id;
        newDiscussion.createdAt = new Date();
        allDiscussions.unshift(newDiscussion);
        filteredDiscussions.unshift(newDiscussion);

        // Reset form dan tutup modal
        document.getElementById('newDiscussionForm').reset();
        document.getElementById('newDiscussionModal').style.display = 'none';

        // Tampilkan notifikasi sukses
        alert('Diskusi berhasil dibuat!');
        
        // Perbarui tampilan diskusi
        currentPage = 1;
        displayDiscussions();

    } catch (error) {
        console.error("Error creating discussion:", error);
        alert('Gagal membuat diskusi. Silakan coba lagi nanti.');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
});










	 
	 
	  
	  
	  
        // Blog search and pagination
        if (document.getElementById('searchBtn')) {
            document.getElementById('searchBtn').addEventListener('click', searchBlogs);
        }

        if (document.getElementById('blogSearch')) {
            document.getElementById('blogSearch').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchBlogs();
                }
            });
        }

        // Initialize blog pagination
        function initializeBlogPagination() {
            const blogItems = document.querySelectorAll('.blog-item');
            if (blogItems.length === 0) return;
            
            let currentPage = 1;
            const blogsPerPage = 6;
            const totalBlogs = blogItems.length;
            const totalPages = Math.ceil(totalBlogs / blogsPerPage);

            function showPage(page) {
                currentPage = page;
                const startIndex = (page - 1) * blogsPerPage;
                const endIndex = startIndex + blogsPerPage;
                
                blogItems.forEach((item, index) => {
                    if (index >= startIndex && index < endIndex) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                // Update active button
                document.querySelectorAll('.page-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (parseInt(btn.getAttribute('data-page')) === page) {
                        btn.classList.add('active');
                    }
                });
                
                // Update pagination text
                const blogCountDisplay = document.getElementById('blogCountDisplay');
                if (blogCountDisplay) {
                    blogCountDisplay.textContent = 
                        `Menampilkan ${Math.min(endIndex, totalBlogs)} dari ${totalBlogs} Blog (Halaman ${page} dari ${totalPages})`;
                }
            }

            // Set up pagination controls
            document.querySelectorAll('.page-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    showPage(parseInt(this.getAttribute('data-page')));
                });
            });

            if (document.getElementById('prevPage')) {
                document.getElementById('prevPage').addEventListener('click', function() {
                    if (currentPage > 1) {
                        showPage(currentPage - 1);
                    }
                });
            }

            if (document.getElementById('nextPage')) {
                document.getElementById('nextPage').addEventListener('click', function() {
                    if (currentPage < totalPages) {
                        showPage(currentPage + 1);
                    }
                });
            }

            // Show first page initially
            showPage(1);
            updateBlogCount();
        }
		
		
		
		
		
		
		
		
		
   // Add this to your event listeners setup
document.addEventListener('click', async (e) => {
    // Handle clicks on announcement titles
    const announcementTitle = e.target.closest('.announcement-title');
    if (announcementTitle) {
        e.preventDefault();
        const announcementId = announcementTitle.getAttribute('data-id');
        if (announcementId) {
            history.pushState({ page: "detail-pengumuman" }, "", `/halaman-masukan-${announcementId}`);
            await showAnnouncementDetailById(announcementId);
        }
    }
    
    // Handle clicks on "View Details" buttons
    const viewDetailsBtn = e.target.closest('.view-details-btn, .view-announcement-btn');
    if (viewDetailsBtn) {
        e.preventDefault();
        const feedbackItem = viewDetailsBtn.closest('.feedback-item, .pinned-item');
        if (feedbackItem) {
            const announcementId = feedbackItem.getAttribute('data-id');
            if (announcementId) {
                history.pushState({ page: "detail-pengumuman" }, "", `/halaman-masukan-${announcementId}`);
                await showAnnouncementDetailById(announcementId);
            }
        }
    }
});
   
   
   
   async function findAnnouncementById(id) {
    try {
        const docRef = doc(db, "announcements", id);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
            return { id: docSnap.id, ...docSnap.data() };
        }

        return null;
    } catch (error) {
        console.error("Error finding announcement by ID:", error);
        return null;
    }
}
   





window.onload = async function () {
    // Biarkan handlePageLoad menangani semua routing, termasuk detail pengumuman
	    console.log("DEBUG: window.onload dipanggil.");
    await handlePageLoad();
    initializeBlogPagination();
};


// Fungsi untuk menangani perubahan URL (back/forward browser)
window.addEventListener("popstate", function(event) {
    handlePageLoad(false); // false berarti bukan initial load
});

// Variabel untuk menyimpan state saat ini
let currentState = {
    page: "home",
    announcementId: null
};






async function handlePageLoad(isInitialLoad = true) {
  const path = window.location.pathname || "/";
  console.log('[Debug] Handling page load for path:', path);

  try {
    // Handle announcement detail from URL
    if (path.includes('halaman-masukan-')) {
      const id = path.split('halaman-masukan-')[1];
      if (id) {
        console.log('[Debug] Showing announcement detail for ID:', id);
        await showAnnouncementDetailById(id);
        return;
      }
    }

    // Handle other pages
    const pageMap = {
      "halaman-arduino": "page2",
      "halaman-iot": "page3",
      "halaman-blog": "page4",
      "halaman-kumpulan-blog": "page5",
      "halaman-tentang-kami": "page6",
      "halaman-masukan": "page7",
      "halaman-forum": "page8",
      "halaman-detail-pengumuman": "page9",
	  "halaman-sejarah": "page10" 
    };

    let pageToShow = "page1"; // default
    for (const [pathPart, pageId] of Object.entries(pageMap)) {
      if (path.includes(pathPart)) {
        pageToShow = pageId;
        break;
      }
    }

    const pageElement = document.getElementById(pageToShow);
    if (pageElement) {
      showPageContent(pageElement);
      
      // Load data khusus untuk halaman tertentu
      if (pageToShow === "page7") {
        await loadFeedback().catch(console.error);
      }
    } else {
      console.error(`Halaman ${pageToShow} tidak ditemukan`);
      showPageContent(document.getElementById("page1"));
    }

  } catch (error) {
    console.error('[Error] handlePageLoad failed:', error);
    showPageContent(document.getElementById("page1"));
  }
}




function handleInitialNavigation() {
  const hash = window.location.hash;
  const path = window.location.pathname;
  const urlParams = new URLSearchParams(window.location.search);
  const announcementId = urlParams.get("id");

  if (announcementId && path.includes("halaman-masukan-halo")) {
    // Jika URL mengandung ?id= dan sedang di halaman masukan
    showAnnouncementDetail(announcementId);
  } else if (path.includes("halaman-masukan-halo")) {
    // Jika hanya buka halaman masukan tanpa ?id
    showPageContent(document.getElementById("page7"));
  } else if (hash) {
    // Navigasi via hash seperti #page3
    showPageByHash(hash);
  } else {
    // Default: tampilkan halaman utama
    showPageContent(document.getElementById("page1"));
  }
}





// Setup event listeners for announcements
function setupAnnouncementEventListeners() {
    // Back button handlers
    document.getElementById('backToAnnouncements')?.addEventListener('click', backToFeedbackPage);
    document.getElementById('backToFeedbackPage')?.addEventListener('click', backToFeedbackPage);

    // Delegated click listener for dynamic announcement items
    document.addEventListener("click", async function (e) {
        const announcementItem = e.target.closest(".announcement-title, .pinned-item, .view-announcement-btn");

        if (announcementItem) {
            e.preventDefault();
            const id = announcementItem.getAttribute("data-id");

            if (id) {
                history.pushState({ page: "detail-pengumuman", id }, "", `/halaman-masukan-${id}`);
                showPageContent(document.getElementById("page9")); // pastikan ditampilkan
                await showAnnouncementDetailById(id);
            }
        }
    });
}





document.addEventListener("DOMContentLoaded", () => {
  const backToMasukan = document.getElementById("backToFeedbackPage");
  const backToPengumuman = document.getElementById("backToAnnouncements");

  if (backToMasukan) {
    backToMasukan.addEventListener("click", () => {
      history.pushState({ page: "masukan" }, "Masukan", "/halaman-masukan");
      handlePageLoad(false);
    });
  }

  if (backToPengumuman) {
    backToPengumuman.addEventListener("click", () => {
      history.pushState({ page: "masukan" }, "Masukan", "/halaman-masukan");
      handlePageLoad(false);
    });
  }
});





async function showDetailPengumumanById(id) {
  if (!id) {
    console.error("ID pengumuman tidak valid");
    return;
  }

  const db = getFirestore();

  try {
    const docRef = doc(db, "announcements", id); // Pastikan koleksi ini benar: "announcements"
    const docSnap = await getDoc(docRef);

    if (!docSnap.exists()) {
      // Jika pengumuman tidak ditemukan
      const container = document.getElementById("announcementDetailContainer");
      container.innerHTML = `
        <h2 style="color: white;">Pengumuman tidak ditemukan</h2>
        <p style="color: #ccc;">ID: ${id}</p>
      `;
      showPage(page9);
      return;
    }

    const data = docSnap.data();

    // Tampilkan konten ke dalam kontainer detail
    const container = document.getElementById("announcementDetailContainer");
    container.innerHTML = `
      <h2 style="color: white; font-size: 28px; margin-bottom: 10px;">${data.title}</h2>
      <p style="color: #ccc; font-size: 14px; margin-bottom: 20px;">Diposting: ${formatTimestamp(data.timestamp)}</p>
      <div style="color: white; font-size: 16px; line-height: 1.6;">${data.content}</div>
    `;

    showPage(page9); // Tampilkan halaman 9

  } catch (err) {
    console.error("Gagal mengambil pengumuman berdasarkan ID:", err);
    alert("Gagal memuat detail pengumuman.");
  }
}





async function renderMasukanDetailById(id) {
    if (!id) {
        showNotification("ID masukan tidak valid.", "error");
        return;
    }

    try {
        const docRef = doc(db, "masukan", id);
        const docSnap = await getDoc(docRef);

        if (!docSnap.exists()) {
            showNotification("Masukan tidak ditemukan.", "error");
            return;
        }

        const data = docSnap.data();

        // Tampilkan halaman 9
        showPage(page9);

        // Render konten ke elemen yang sesuai
        const titleElement = document.getElementById("masukanDetailTitle");
        const contentElement = document.getElementById("masukanDetailContent");

        if (titleElement) {
            titleElement.textContent = data.title || "(Tanpa Judul)";
        }

        if (contentElement) {
            contentElement.innerHTML = data.content || "<p>Tidak ada konten tersedia.</p>";
        }

        // Update judul halaman
        document.title = `${data.title || "Masukan"} - Life Is What It Is Learn`;

    } catch (error) {
        console.error("Gagal memuat detail masukan:", error);
        showNotification("Gagal memuat detail masukan: " + error.message, "error");
    }
}







// Variabel untuk menyimpan data balasan sementara
let currentAnnouncementReplies = [];





// Fungsi untuk setup form edit pengumuman (show edit icon for all users)
function setupAdminAnnouncementForm(announcementId, announcementData) {
  const adminForm = document.getElementById('adminAnnouncementForm');
  const user = auth.currentUser;
  
  // Show edit icon for all logged in users
  if (user) {
    // Create edit icon
    const editIcon = document.createElement('span');
    editIcon.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-left: 10px; cursor: pointer;" title="Lihat perbandingan">
        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
      </svg>
    `;
    editIcon.style.cursor = 'pointer';
    editIcon.addEventListener('click', () => showEditComparison(announcementId));
    
    // Find announcement title and insert edit icon
    const announcementTitle = document.querySelector('#announcementDetailContainer h2');
    if (announcementTitle) {
      announcementTitle.appendChild(editIcon);
    }
  }

  // Only show admin form for admin users
  if (isUserAdmin(user)) {
    adminForm.style.display = 'block';
    document.getElementById('editAnnouncementTitle').value = announcementData.title || '';
    document.getElementById('editAnnouncementContent').value = announcementData.content || '';
    
    // Setup event listeners
    document.getElementById('editAnnouncementForm').onsubmit = async (e) => {
      e.preventDefault();
      await updateAnnouncement(announcementId);
    };

    document.getElementById('cancelEditAnnouncement').onclick = () => {
      adminForm.style.display = 'none';
    };

    document.getElementById('deleteAnnouncement').onclick = async () => {
      if (confirm('Apakah Anda yakin ingin menghapus pengumuman ini?')) {
        await deleteAnnouncement(announcementId);
      }
    };
  } else {
    adminForm.style.display = 'none';
  }
}

// Fungsi untuk menampilkan detail pengumuman
async function showAnnouncementDetailById(announcementId) {
  try {
    // Pastikan halaman 9 ada sebelum melanjutkan
    const page9 = document.getElementById("page9");
    if (!page9) {
      console.error('Halaman detail pengumuman tidak ditemukan');
      return;
    }

    // Sembunyikan semua halaman lain dan tampilkan halaman 9
    const pages = ["page1", "page2", "page3", "page4", "page5", "page6", "page7", "page8"];
    pages.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = "none";
    });
    page9.style.display = "block";

    const container = document.getElementById('announcementDetailContainer');
    if (!container) {
      console.error('Container detail tidak ditemukan');
      return;
    }

    // Tampilkan loading state
    container.innerHTML = '<div style="color:#ccc; text-align:center; padding:30px;">Memuat pengumuman...</div>';

    // Muat data pengumuman dan balasan secara paralel
    const [announcementSnap, repliesSnap] = await Promise.all([
      getDoc(doc(db, "announcements", announcementId)),
      getDocs(collection(db, "announcements", announcementId, "replies"))
    ]);

    if (!announcementSnap.exists()) {
      throw new Error("Pengumuman tidak ditemukan");
    }

    const announcement = announcementSnap.data();
    const waktu = announcement.timestamp?.toDate ? announcement.timestamp.toDate() : new Date();

    // Simpan balasan ke variabel sementara
    currentAnnouncementReplies = repliesSnap.docs.map(doc => ({
      id: doc.id,
      ...doc.data(),
      timestamp: doc.data().timestamp?.toDate ? doc.data().timestamp.toDate() : new Date()
    }));

    // Render konten pengumuman
    container.innerHTML = `
     <div style="margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
          <h2 style="color: #ff6b6b; font-size: 28px; margin: 0; line-height: 1.3;">
            ${announcement.title || 'Tanpa Judul'}
            ${announcement.lastUpdated ? '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#4ea1ff" stroke="#4ea1ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-left: 8px;" title="Telah diedit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>' : ''}
          </h2>
          <div style="color: #aaa; font-size: 14px; white-space: nowrap;">${formatTimeAgo(waktu)}</div>
        </div>
        
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
          <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; color: white;">
            ${announcement.userName?.charAt(0).toUpperCase() || 'A'}
          </div>
          <div>
            <div style="color: white; font-weight: 500;">${announcement.userName || 'Admin'}</div>
            <div style="color: #aaa; font-size: 12px;">${announcement.userEmail || ''}</div>
          </div>
        </div>
        
        <div style="color: #ddd; font-size: 16px; line-height: 1.6; white-space: pre-line; margin-bottom: 20px;">
          ${announcement.content || 'Tidak ada konten'}
        </div>
        
        <div style="display: flex; gap: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
          <button class="like-btn" style="display: flex; align-items: center; background: none; border: none; color: #ccc; cursor: pointer;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
            </svg>
            <span class="like-count" style="margin-left: 5px;">${announcement.likesCount || 0}</span>
          </button>
          
          <div style="display: flex; align-items: center; color: #ccc;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            <span class="view-count" style="margin-left: 5px;">${announcement.views || 0}</span>
          </div>
        </div>
      </div>
    `;

    // Setup admin controls and edit icon for all users
    setupAdminAnnouncementForm(announcementSnap.id, announcement);
	
	  // Muat history edit
    await loadEditHistory(announcementId);
    
    // Render balasan yang sudah disimpan
    renderAnnouncementReplies(currentAnnouncementReplies);

    // Muat pengumuman terkait
    await loadRelatedAnnouncements(announcementId);

    // Setup form balasan
    setupReplyForm(announcementId);

  } catch (error) {
    console.error("Error loading announcement:", error);
    const container = document.getElementById('announcementDetailContainer');
    if (container) {
      container.innerHTML = `
        <div style="color:#ff6b6b; text-align:center; padding:30px;">
          <h3 style="margin-bottom: 15px;">Gagal Memuat Pengumuman</h3>
          <p style="margin-bottom: 20px;">${error.message}</p>
          <button onclick="backToFeedbackPage()" style="padding: 8px 16px; background: none; border: 1px solid #ff6b6b; color: #ff6b6b; cursor: pointer;">
            Kembali ke Daftar Pengumuman
          </button>
        </div>
      `;
    }
  }
}



























async function loadAnnouncementDetailById(id) {
    if (!id) {
        throw new Error("ID pengumuman tidak valid");
    }

    try {
        const docRef = doc(db, "announcements", id);
        const docSnap = await getDoc(docRef);

        if (!docSnap.exists()) {
            throw new Error("Pengumuman tidak ditemukan");
        }

        const data = docSnap.data();
        const waktu = data.timestamp?.toDate ? data.timestamp.toDate() : new Date();

        // Kembalikan data lengkap pengumuman
        return {
            id: doc.id,
            ...data,
            formattedDate: formatTimeAgo(waktu)
        };

    } catch (error) {
        console.error("Error loading announcement:", error);
        throw error;
    }
}





// Fungsi untuk kembali ke halaman masukan
function backToFeedbackPage() {
  const page7 = document.getElementById("page7");
  if (page7) {
    // Sembunyikan semua halaman lain
    const pages = ["page1", "page2", "page3", "page4", "page5", "page6", "page8", "page9, page10"];
    pages.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = "none";
    });
    
    // Tampilkan halaman 7
    page7.style.display = "block";
    
    // Muat ulang data jika diperlukan
    loadPinnedAnnouncements();
    loadFeedback().catch(console.error);
  }
  
  history.pushState({ page: "masukan" }, "Halaman Masukan", "/halaman-masukan");
  document.title = "Masukan - Life Is What It Is Learn";
}








// Improved formatTimeAgo function
function formatTimeAgo(timestamp) {
    if (!timestamp) return 'baru saja';
    
    const now = new Date();
    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
    const diffInSeconds = Math.floor((now - date) / 1000);
    
    if (diffInSeconds < 60) return 'baru saja';
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} menit yang lalu`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} jam yang lalu`;
    if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} hari yang lalu`;
    
    return date.toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
    });
}








// Event listener untuk tombol kembali
document.getElementById('backToAnnouncements')?.addEventListener('click', backToFeedbackPage);

// Event listener untuk klik pada item pengumuman
document.addEventListener('click', (e) => {
  if (e.target.closest('.view-details-btn, .announcement-title, .pinned-item')) {
    e.preventDefault();
    const item = e.target.closest('[data-id]');
    if (item) {
      const announcementId = item.getAttribute('data-id');
      if (announcementId) {
        showAnnouncementDetailById(announcementId);
      }
    }
  }
});













window.addEventListener('popstate', async function(event) {
    console.log('[Debug] popstate event triggered', event.state);

    try {
        const path = window.location.pathname || "/";
        
        // Cek apakah URL mengandung detail pengumuman berbasis path (tanpa state)
        if (!event.state && path.includes('halaman-masukan-')) {
            const id = path.split('halaman-masukan-')[1];
            console.log('[Debug] Found announcement ID in URL:', id);
            if (id) {
                showPageContent(document.getElementById("page9"));
                await showAnnouncementDetailById(id);
                return;
            }
        }

        if (event.state) {
            const currentState = event.state;
            console.log('[Debug] Current state:', currentState);

            switch (currentState.page) {
                case "detail-pengumuman":
                    const idFromState = currentState.announcementId || currentState.id;
                    console.log('[Debug] Showing announcement detail for ID:', idFromState);
                    if (idFromState) {
                        showPageContent(document.getElementById("page9"));
                        await showAnnouncementDetailById(idFromState);
                    }
                    break;

                case "arduino":
                    showPageContent(document.getElementById("page2"));
                    break;

                case "iot":
                    showPageContent(document.getElementById("page3"));
                    break;

                case "blog":
                    showPageContent(document.getElementById("page4"));
                    break;

                case "kumpulan-blog":
                    showPageContent(document.getElementById("page5"));
                    break;

                case "tentang-kami":
                    showPageContent(document.getElementById("page6"));
                    break;

                case "masukan":
                    showPageContent(document.getElementById("page7"));
                    await loadFeedback().catch(console.error);
                    break;

                case "forum":
                    showPageContent(document.getElementById("page8"));
                    break;
					
				case "sejarah":
                showPageContent(document.getElementById("page10"));
                break;	

                default:
                    showPageContent(document.getElementById("page1"));
            }
        } else {
            // Jika tidak ada state dan tidak mengandung halaman detail
            await handlePageLoad(false);
        }

    } catch (error) {
        console.error('[Error] popstate handler failed:', error);
        showPageContent(document.getElementById("page1"));
    }
});



async function getRepliersInfo(announcementId) {
  const q = query(
    collection(db, "announcements", announcementId, "replies"),
    orderBy("timestamp", "desc"),
    limit(5)
  );
  const snapshot = await getDocs(q);
  const usersMap = new Map();

  snapshot.forEach(doc => {
    const { userName, userPhoto, userEmail } = doc.data();
    if (!usersMap.has(userEmail)) {
      usersMap.set(userEmail, { userName, userPhoto });
    }
  });

  return Array.from(usersMap.values());
}





function renderAnnouncementDetail(data) {
  const container = document.getElementById("page9");
  container.innerHTML = `
    <div class="line-box">
      <div style="max-width: 800px;">
        <h1 style="color: white;">${data.title}</h1>
        <p style="color: #ccc; line-height: 1.6;">${data.content}</p>
      </div>
    </div>
  `;
}



async function loadAnnouncementById(id) {
    if (!id) {
        console.error("ID pengumuman tidak valid");
        return;
    }

    try {
        const docRef = doc(db, "announcements", id);
        const docSnap = await getDoc(docRef);

        if (!docSnap.exists()) {
            // Tampilkan pesan pengumuman tidak ditemukan
            const container = document.getElementById("page9");
            if (container) {
                container.innerHTML = "<h2 style='color:white'>Pengumuman tidak ditemukan.</h2>";
            }
            return;
        }

        // Ambil data dan tampilkan
        const data = docSnap.data();
        renderAnnouncementDetail({ ...data, id: docSnap.id });

    } catch (error) {
        console.error("Gagal memuat pengumuman:", error);
        const container = document.getElementById("page9");
        if (container) {
            container.innerHTML = "<h2 style='color:white'>Gagal memuat pengumuman.</h2>";
        }
    }
}
}
 
 

  
</script>
</body>
</html>







